Args in experiment:
Namespace(model='lstm', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=90, seg_lens='9', dim_factor=10, patch_factor=10, data_dim=5, d_model=512, d_ff=1024, n_heads=4, a_layers=4, dropout=0.2, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:0
>>>>>>>start training : lstm_m1999m_il360_ol90_sl9_dm512_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7614
val 1064
test 2215
	iters: 100, epoch: 1 | loss: 0.4473192
	speed: 0.1518s/iter; left time: 707.5443s
	iters: 200, epoch: 1 | loss: 0.3105169
	speed: 0.1314s/iter; left time: 599.4351s
Epoch: 1 cost time: 33.820202112197876
Epoch: 1, Steps: 238 | Train Loss: 0.4805742 Vali Loss: 0.4027428 Test Loss: 1.4871507
Validation loss decreased (inf --> 0.402743).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3572780
	speed: 0.1352s/iter; left time: 598.1815s
	iters: 200, epoch: 2 | loss: 0.4429714
	speed: 0.1502s/iter; left time: 649.4786s
Epoch: 2 cost time: 33.72682499885559
Epoch: 2, Steps: 238 | Train Loss: 0.3896172 Vali Loss: 0.3723304 Test Loss: 1.3303155
Validation loss decreased (0.402743 --> 0.372330).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3412945
	speed: 0.1345s/iter; left time: 562.7831s
	iters: 200, epoch: 3 | loss: 0.2754320
	speed: 0.1346s/iter; left time: 549.7747s
Epoch: 3 cost time: 32.074617862701416
Epoch: 3, Steps: 238 | Train Loss: 0.3488957 Vali Loss: 0.4105805 Test Loss: 1.4471483
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2524818
	speed: 0.1502s/iter; left time: 592.7522s
	iters: 200, epoch: 4 | loss: 0.3359761
	speed: 0.1304s/iter; left time: 501.5048s
Epoch: 4 cost time: 33.84887146949768
Epoch: 4, Steps: 238 | Train Loss: 0.3183110 Vali Loss: 0.4460300 Test Loss: 1.4842265
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 5 | loss: 0.3557017
	speed: 0.1429s/iter; left time: 530.2013s
	iters: 200, epoch: 5 | loss: 0.2822352
	speed: 0.1478s/iter; left time: 533.2667s
Epoch: 5 cost time: 34.44982194900513
Epoch: 5, Steps: 238 | Train Loss: 0.2878105 Vali Loss: 0.4501382 Test Loss: 1.5028477
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : lstm_m1999m_il360_ol90_sl9_dm512_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2215
mse:1.3056681156158447, mae:0.9296685457229614
