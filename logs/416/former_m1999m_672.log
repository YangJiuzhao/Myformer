Args in experiment:
Namespace(model='former', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=672, out_len=672, seg_lens='12,24,36,48,72', dim_factor=10, patch_factor=10, data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : former_m1999m_il672_ol672_sl12,24,36,48,72_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 6720
val 482
test 1633
	iters: 100, epoch: 1 | loss: 1.0747824
	speed: 0.4404s/iter; left time: 1805.9970s
	iters: 200, epoch: 1 | loss: 0.9341957
	speed: 0.4367s/iter; left time: 1747.0536s
Epoch: 1 cost time: 91.67663335800171
Epoch: 1, Steps: 210 | Train Loss: 1.5798639 Vali Loss: 0.6197693 Test Loss: 1.7722558
Validation loss decreased (inf --> 0.619769).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8241636
	speed: 0.4426s/iter; left time: 1722.0015s
	iters: 200, epoch: 2 | loss: 0.7640120
	speed: 0.4204s/iter; left time: 1593.6421s
Epoch: 2 cost time: 90.4073417186737
Epoch: 2, Steps: 210 | Train Loss: 0.8519443 Vali Loss: 0.4679631 Test Loss: 1.2761384
Validation loss decreased (0.619769 --> 0.467963).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.7711226
	speed: 0.4269s/iter; left time: 1571.5942s
	iters: 200, epoch: 3 | loss: 0.7728769
	speed: 0.4293s/iter; left time: 1537.2809s
Epoch: 3 cost time: 90.29541754722595
Epoch: 3, Steps: 210 | Train Loss: 0.7335066 Vali Loss: 0.4495657 Test Loss: 1.1172889
Validation loss decreased (0.467963 --> 0.449566).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6141673
	speed: 0.4579s/iter; left time: 1589.4466s
	iters: 200, epoch: 4 | loss: 0.6332944
	speed: 0.4453s/iter; left time: 1501.0093s
Epoch: 4 cost time: 94.52245283126831
Epoch: 4, Steps: 210 | Train Loss: 0.6970909 Vali Loss: 0.4459247 Test Loss: 1.0273383
Validation loss decreased (0.449566 --> 0.445925).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.5503646
	speed: 0.4216s/iter; left time: 1374.9444s
	iters: 200, epoch: 5 | loss: 0.6645089
	speed: 0.4093s/iter; left time: 1293.8849s
Epoch: 5 cost time: 86.6468276977539
Epoch: 5, Steps: 210 | Train Loss: 0.6462386 Vali Loss: 0.4669436 Test Loss: 0.9705121
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.6396457
	speed: 0.4270s/iter; left time: 1302.8336s
	iters: 200, epoch: 6 | loss: 0.6583552
	speed: 0.4216s/iter; left time: 1244.0106s
Epoch: 6 cost time: 89.27791857719421
Epoch: 6, Steps: 210 | Train Loss: 0.6199570 Vali Loss: 0.5219495 Test Loss: 1.0537469
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.6273983
	speed: 0.4564s/iter; left time: 1296.6516s
	iters: 200, epoch: 7 | loss: 0.6051734
	speed: 0.4407s/iter; left time: 1207.9312s
Epoch: 7 cost time: 94.85035037994385
Epoch: 7, Steps: 210 | Train Loss: 0.5862472 Vali Loss: 0.4989466 Test Loss: 0.9902655
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : former_m1999m_il672_ol672_sl12,24,36,48,72_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1633
mse:1.0176039934158325, mae:0.8410285711288452
