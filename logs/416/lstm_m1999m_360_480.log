Args in experiment:
Namespace(model='lstm', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=480, seg_lens='30', dim_factor=10, patch_factor=10, data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.2, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : lstm_m1999m_il360_ol480_sl30_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7224
val 674
test 1825
	iters: 100, epoch: 1 | loss: 0.5997192
	speed: 0.3164s/iter; left time: 1398.8375s
	iters: 200, epoch: 1 | loss: 0.5789148
	speed: 0.2829s/iter; left time: 1222.2834s
Epoch: 1 cost time: 67.4225447177887
Epoch: 1, Steps: 226 | Train Loss: 0.5909866 Vali Loss: 0.7119837 Test Loss: 2.4647892
Validation loss decreased (inf --> 0.711984).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4566244
	speed: 0.2911s/iter; left time: 1220.9899s
	iters: 200, epoch: 2 | loss: 0.4792187
	speed: 0.2732s/iter; left time: 1118.6215s
Epoch: 2 cost time: 63.76749014854431
Epoch: 2, Steps: 226 | Train Loss: 0.5044354 Vali Loss: 0.5154691 Test Loss: 1.6991519
Validation loss decreased (0.711984 --> 0.515469).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4075638
	speed: 0.2257s/iter; left time: 895.8453s
	iters: 200, epoch: 3 | loss: 0.3751145
	speed: 0.2251s/iter; left time: 871.1014s
Epoch: 3 cost time: 50.51333451271057
Epoch: 3, Steps: 226 | Train Loss: 0.4175226 Vali Loss: 0.5197403 Test Loss: 1.7216040
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3648599
	speed: 0.1824s/iter; left time: 682.8474s
	iters: 200, epoch: 4 | loss: 0.3742136
	speed: 0.1843s/iter; left time: 671.4911s
Epoch: 4 cost time: 41.69313883781433
Epoch: 4, Steps: 226 | Train Loss: 0.3682660 Vali Loss: 0.5571000 Test Loss: 1.6048443
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 5 | loss: 0.3068667
	speed: 0.1848s/iter; left time: 649.9540s
	iters: 200, epoch: 5 | loss: 0.2611705
	speed: 0.1945s/iter; left time: 664.5828s
Epoch: 5 cost time: 42.67253232002258
Epoch: 5, Steps: 226 | Train Loss: 0.3266043 Vali Loss: 0.5667657 Test Loss: 1.6423032
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : lstm_m1999m_il360_ol480_sl30_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1825
mse:1.6864283084869385, mae:1.095178484916687
