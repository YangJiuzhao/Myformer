Args in experiment:
Namespace(model='iformer', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=480, seg_lens='12,8,6,4,3', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, fc_dropout=0.05, head_dropout=0.0, patch_len=12, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=5, learning_rate=1e-05, lradj='type2', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : iformer_m1999m_il360_ol480_sl12,8,6,4,3_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7224
val 674
test 1825
	iters: 100, epoch: 1 | loss: 0.7141744
	speed: 0.2149s/iter; left time: 4835.3290s
	iters: 200, epoch: 1 | loss: 0.8392007
	speed: 0.2034s/iter; left time: 4557.1706s
Epoch: 1 cost time: 47.0443971157074
Epoch: 1, Steps: 226 | Train Loss: 0.8149397 Vali Loss: 1.1896649 Test Loss: 3.4995953
Validation loss decreased (inf --> 1.189665).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7112453
	speed: 0.1986s/iter; left time: 4424.0439s
	iters: 200, epoch: 2 | loss: 0.5903950
	speed: 0.1732s/iter; left time: 3839.7947s
Epoch: 2 cost time: 40.87679409980774
Epoch: 2, Steps: 226 | Train Loss: 0.6784304 Vali Loss: 0.9207381 Test Loss: 2.8671182
Validation loss decreased (1.189665 --> 0.920738).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6344573
	speed: 0.1820s/iter; left time: 4013.4482s
	iters: 200, epoch: 3 | loss: 0.4881493
	speed: 0.1805s/iter; left time: 3961.5965s
Epoch: 3 cost time: 41.42357587814331
Epoch: 3, Steps: 226 | Train Loss: 0.5928695 Vali Loss: 0.7474959 Test Loss: 2.4049678
Validation loss decreased (0.920738 --> 0.747496).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5119678
	speed: 0.1772s/iter; left time: 3866.4902s
	iters: 200, epoch: 4 | loss: 0.4358594
	speed: 0.1807s/iter; left time: 3924.9631s
Epoch: 4 cost time: 40.70712995529175
Epoch: 4, Steps: 226 | Train Loss: 0.5373772 Vali Loss: 0.6972176 Test Loss: 2.2099594
Validation loss decreased (0.747496 --> 0.697218).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5702190
	speed: 0.2016s/iter; left time: 4354.1603s
	iters: 200, epoch: 5 | loss: 0.5104257
	speed: 0.1931s/iter; left time: 4151.9418s
Epoch: 5 cost time: 43.72142243385315
Epoch: 5, Steps: 226 | Train Loss: 0.5067747 Vali Loss: 0.6307185 Test Loss: 2.0803052
Validation loss decreased (0.697218 --> 0.630719).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 6 | loss: 0.4995769
	speed: 0.1754s/iter; left time: 3747.7205s
	iters: 200, epoch: 6 | loss: 0.4808612
	speed: 0.1698s/iter; left time: 3612.4524s
Epoch: 6 cost time: 38.62050127983093
Epoch: 6, Steps: 226 | Train Loss: 0.4871432 Vali Loss: 0.6158312 Test Loss: 2.0460871
Validation loss decreased (0.630719 --> 0.615831).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.4677164
	speed: 0.1643s/iter; left time: 3473.4651s
	iters: 200, epoch: 7 | loss: 0.4503312
	speed: 0.1550s/iter; left time: 3262.9825s
Epoch: 7 cost time: 36.547088623046875
Epoch: 7, Steps: 226 | Train Loss: 0.4775987 Vali Loss: 0.6083422 Test Loss: 2.0190465
Validation loss decreased (0.615831 --> 0.608342).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4770133
	speed: 0.1585s/iter; left time: 3316.3548s
	iters: 200, epoch: 8 | loss: 0.5035731
	speed: 0.1646s/iter; left time: 3427.7271s
Epoch: 8 cost time: 36.63396906852722
Epoch: 8, Steps: 226 | Train Loss: 0.4695129 Vali Loss: 0.6004176 Test Loss: 1.9946563
Validation loss decreased (0.608342 --> 0.600418).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4846360
	speed: 0.1607s/iter; left time: 3324.8748s
	iters: 200, epoch: 9 | loss: 0.4231336
	speed: 0.1502s/iter; left time: 3094.0769s
Epoch: 9 cost time: 35.30209469795227
Epoch: 9, Steps: 226 | Train Loss: 0.4632254 Vali Loss: 0.6259492 Test Loss: 1.9843663
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.5010918
	speed: 0.1596s/iter; left time: 3266.5425s
	iters: 200, epoch: 10 | loss: 0.5010170
	speed: 0.1672s/iter; left time: 3405.3832s
Epoch: 10 cost time: 36.45855164527893
Epoch: 10, Steps: 226 | Train Loss: 0.4575818 Vali Loss: 0.6252312 Test Loss: 1.9691927
EarlyStopping counter: 2 out of 5
Updating learning rate to 2.5e-06
	iters: 100, epoch: 11 | loss: 0.4135695
	speed: 0.1535s/iter; left time: 3107.7081s
	iters: 200, epoch: 11 | loss: 0.3629440
	speed: 0.1649s/iter; left time: 3320.6596s
Epoch: 11 cost time: 36.030460596084595
Epoch: 11, Steps: 226 | Train Loss: 0.4536196 Vali Loss: 0.6388096 Test Loss: 1.9655370
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 0.4990927
	speed: 0.1735s/iter; left time: 3472.1572s
	iters: 200, epoch: 12 | loss: 0.4643877
	speed: 0.1488s/iter; left time: 2962.3755s
Epoch: 12 cost time: 35.899245738983154
Epoch: 12, Steps: 226 | Train Loss: 0.4508843 Vali Loss: 0.6375033 Test Loss: 1.9584568
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 13 | loss: 0.4261636
	speed: 0.1642s/iter; left time: 3248.6792s
	iters: 200, epoch: 13 | loss: 0.5479562
	speed: 0.1786s/iter; left time: 3516.3773s
Epoch: 13 cost time: 38.751222372055054
Epoch: 13, Steps: 226 | Train Loss: 0.4486850 Vali Loss: 0.6185200 Test Loss: 1.9547555
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : iformer_m1999m_il360_ol480_sl12,8,6,4,3_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1825
mse:1.9821631908416748, mae:1.1787595748901367
