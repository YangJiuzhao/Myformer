Args in experiment:
Namespace(model='iformer', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=60, seg_lens='60,36,24,18,12,6', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, fc_dropout=0.05, head_dropout=0.0, patch_len=12, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=3, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : iformer_m1999m_il360_ol60_sl60,36,24,18,12,6_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7644
val 1094
test 2245
	iters: 100, epoch: 1 | loss: 21.4191666
	speed: 0.2526s/iter; left time: 6012.7146s
	iters: 200, epoch: 1 | loss: 17.1128502
	speed: 0.2496s/iter; left time: 5914.7877s
Epoch: 1 cost time: 58.905712366104126
Epoch: 1, Steps: 239 | Train Loss: 34.2349392 Vali Loss: 5.0001775 Test Loss: 6.5314400
Validation loss decreased (inf --> 5.000178).  Saving model ...
	iters: 100, epoch: 2 | loss: 13.6758032
	speed: 0.2309s/iter; left time: 5440.4019s
	iters: 200, epoch: 2 | loss: 11.3245449
	speed: 0.2241s/iter; left time: 5257.6898s
Epoch: 2 cost time: 53.946054220199585
Epoch: 2, Steps: 239 | Train Loss: 13.4427593 Vali Loss: 2.7605422 Test Loss: 4.0823479
Validation loss decreased (5.000178 --> 2.760542).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 10.0477228
	speed: 0.2269s/iter; left time: 5293.1496s
	iters: 200, epoch: 3 | loss: 8.8933477
	speed: 0.2360s/iter; left time: 5481.0721s
Epoch: 3 cost time: 55.896018743515015
Epoch: 3, Steps: 239 | Train Loss: 9.6868897 Vali Loss: 2.1483817 Test Loss: 3.0348503
Validation loss decreased (2.760542 --> 2.148382).  Saving model ...
	iters: 100, epoch: 4 | loss: 7.6860070
	speed: 0.2420s/iter; left time: 5587.4500s
	iters: 200, epoch: 4 | loss: 6.7895703
	speed: 0.2670s/iter; left time: 6137.3824s
Epoch: 4 cost time: 62.03123593330383
Epoch: 4, Steps: 239 | Train Loss: 7.4563967 Vali Loss: 1.7765594 Test Loss: 2.5580793
Validation loss decreased (2.148382 --> 1.776559).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 5.9394240
	speed: 0.2640s/iter; left time: 6031.3115s
	iters: 200, epoch: 5 | loss: 5.6188822
	speed: 0.2649s/iter; left time: 6024.4615s
Epoch: 5 cost time: 63.32119941711426
Epoch: 5, Steps: 239 | Train Loss: 5.8561220 Vali Loss: 0.9089385 Test Loss: 1.5956306
Validation loss decreased (1.776559 --> 0.908938).  Saving model ...
	iters: 100, epoch: 6 | loss: 5.2707043
	speed: 0.2590s/iter; left time: 5854.7697s
	iters: 200, epoch: 6 | loss: 5.1396646
	speed: 0.2721s/iter; left time: 6124.2252s
Epoch: 6 cost time: 64.22915482521057
Epoch: 6, Steps: 239 | Train Loss: 5.1964653 Vali Loss: 1.1358551 Test Loss: 1.8621574
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 4.6641359
	speed: 0.2780s/iter; left time: 6217.8423s
	iters: 200, epoch: 7 | loss: 4.5474300
	speed: 0.2771s/iter; left time: 6169.8606s
Epoch: 7 cost time: 66.02011513710022
Epoch: 7, Steps: 239 | Train Loss: 4.7361116 Vali Loss: 0.9704145 Test Loss: 1.6753487
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 4.4707446
	speed: 0.2548s/iter; left time: 5638.9563s
	iters: 200, epoch: 8 | loss: 4.4334774
	speed: 0.2791s/iter; left time: 6147.5834s
Epoch: 8 cost time: 63.075998067855835
Epoch: 8, Steps: 239 | Train Loss: 4.5145908 Vali Loss: 0.9147260 Test Loss: 1.6377897
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : iformer_m1999m_il360_ol60_sl60,36,24,18,12,6_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2245
mse:1.5530732870101929, mae:0.9830060601234436
