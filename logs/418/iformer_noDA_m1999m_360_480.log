Args in experiment:
Namespace(model='iformer', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=480, seg_lens='12,8,6,4,3', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, fc_dropout=0.05, head_dropout=0.0, patch_len=12, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=3, learning_rate=1e-05, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : iformer_m1999m_il360_ol480_sl12,8,6,4,3_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7224
val 674
test 1825
	iters: 100, epoch: 1 | loss: 0.7374571
	speed: 0.1953s/iter; left time: 4395.3428s
	iters: 200, epoch: 1 | loss: 0.6296372
	speed: 0.1642s/iter; left time: 3678.9071s
Epoch: 1 cost time: 39.805158853530884
Epoch: 1, Steps: 226 | Train Loss: 0.7364243 Vali Loss: 0.4955428 Test Loss: 1.7565494
Validation loss decreased (inf --> 0.495543).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5929949
	speed: 0.1675s/iter; left time: 3731.3122s
	iters: 200, epoch: 2 | loss: 0.6270891
	speed: 0.1596s/iter; left time: 3540.1039s
Epoch: 2 cost time: 37.30408239364624
Epoch: 2, Steps: 226 | Train Loss: 0.6323916 Vali Loss: 0.3998951 Test Loss: 1.3629007
Validation loss decreased (0.495543 --> 0.399895).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.5410561
	speed: 0.1743s/iter; left time: 3843.2060s
	iters: 200, epoch: 3 | loss: 0.5434026
	speed: 0.1608s/iter; left time: 3529.4734s
Epoch: 3 cost time: 37.828086853027344
Epoch: 3, Steps: 226 | Train Loss: 0.5965902 Vali Loss: 0.3700351 Test Loss: 1.1322334
Validation loss decreased (0.399895 --> 0.370035).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6400354
	speed: 0.1627s/iter; left time: 3551.0573s
	iters: 200, epoch: 4 | loss: 0.5609117
	speed: 0.1712s/iter; left time: 3719.3420s
Epoch: 4 cost time: 37.46708106994629
Epoch: 4, Steps: 226 | Train Loss: 0.5835297 Vali Loss: 0.3770807 Test Loss: 1.0223063
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.5274527
	speed: 0.1583s/iter; left time: 3418.5671s
	iters: 200, epoch: 5 | loss: 0.6590009
	speed: 0.1610s/iter; left time: 3460.1731s
Epoch: 5 cost time: 36.79626107215881
Epoch: 5, Steps: 226 | Train Loss: 0.5758431 Vali Loss: 0.3704892 Test Loss: 0.9930423
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.6008369
	speed: 0.1676s/iter; left time: 3582.2555s
	iters: 200, epoch: 6 | loss: 0.5912778
	speed: 0.1733s/iter; left time: 3686.7180s
Epoch: 6 cost time: 38.4315869808197
Epoch: 6, Steps: 226 | Train Loss: 0.5722683 Vali Loss: 0.3730342 Test Loss: 0.9977669
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : iformer_m1999m_il360_ol480_sl12,8,6,4,3_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1825
mse:1.1215295791625977, mae:0.886408269405365
