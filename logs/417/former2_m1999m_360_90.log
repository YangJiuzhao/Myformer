Args in experiment:
Namespace(model='former', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=90, seg_lens='6,10,15,30,45,90', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:0
>>>>>>>start training : former_m1999m_il360_ol90_sl6,10,15,30,45,90_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7614
val 1064
test 2215
	iters: 100, epoch: 1 | loss: 0.4499696
	speed: 0.8177s/iter; left time: 3811.0960s
	iters: 200, epoch: 1 | loss: 0.6106708
	speed: 0.7520s/iter; left time: 3429.8063s
Epoch: 1 cost time: 183.67768001556396
Epoch: 1, Steps: 238 | Train Loss: 0.5461313 Vali Loss: 0.4297699 Test Loss: 0.5188121
Validation loss decreased (inf --> 0.429770).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3879760
	speed: 0.7563s/iter; left time: 3345.1747s
	iters: 200, epoch: 2 | loss: 0.4478466
	speed: 0.7637s/iter; left time: 3301.5007s
Epoch: 2 cost time: 178.55738377571106
Epoch: 2, Steps: 238 | Train Loss: 0.4282189 Vali Loss: 0.3664764 Test Loss: 0.6792371
Validation loss decreased (0.429770 --> 0.366476).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4935067
	speed: 0.7172s/iter; left time: 3001.6879s
	iters: 200, epoch: 3 | loss: 0.3066536
	speed: 0.7203s/iter; left time: 2942.5033s
Epoch: 3 cost time: 171.30153799057007
Epoch: 3, Steps: 238 | Train Loss: 0.3890703 Vali Loss: 0.4026657 Test Loss: 0.8887336
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2917483
	speed: 0.7008s/iter; left time: 2766.1105s
	iters: 200, epoch: 4 | loss: 0.4439290
	speed: 0.6900s/iter; left time: 2654.3265s
Epoch: 4 cost time: 164.5343234539032
Epoch: 4, Steps: 238 | Train Loss: 0.3643391 Vali Loss: 0.5833542 Test Loss: 1.2233411
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2890880
	speed: 0.5980s/iter; left time: 2217.8796s
	iters: 200, epoch: 5 | loss: 0.3203232
	speed: 0.7000s/iter; left time: 2526.3415s
Epoch: 5 cost time: 157.2212507724762
Epoch: 5, Steps: 238 | Train Loss: 0.3370857 Vali Loss: 0.6415131 Test Loss: 1.2262655
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : former_m1999m_il360_ol90_sl6,10,15,30,45,90_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2215
mse:0.6545726656913757, mae:0.6156749129295349
