Args in experiment:
Namespace(model='former', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=60, seg_lens='6,10,15,20,30,60', dim_factor=10, patch_factor=10, data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:0
>>>>>>>start training : former_m1999m_il360_ol60_sl6,10,15,20,30,60_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7644
val 1094
test 2245
	iters: 100, epoch: 1 | loss: 0.4870844
	speed: 0.4161s/iter; left time: 1947.6458s
	iters: 200, epoch: 1 | loss: 0.3841070
	speed: 0.3482s/iter; left time: 1594.9880s
Epoch: 1 cost time: 89.74902963638306
Epoch: 1, Steps: 239 | Train Loss: 0.5310278 Vali Loss: 0.3031187 Test Loss: 0.7671596
Validation loss decreased (inf --> 0.303119).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4301130
	speed: 0.3519s/iter; left time: 1563.2597s
	iters: 200, epoch: 2 | loss: 0.4085231
	speed: 0.3695s/iter; left time: 1604.4774s
Epoch: 2 cost time: 87.54744958877563
Epoch: 2, Steps: 239 | Train Loss: 0.4097625 Vali Loss: 0.3357486 Test Loss: 0.4454203
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4305178
	speed: 0.3905s/iter; left time: 1641.1685s
	iters: 200, epoch: 3 | loss: 0.4502050
	speed: 0.3878s/iter; left time: 1591.3301s
Epoch: 3 cost time: 91.98583483695984
Epoch: 3, Steps: 239 | Train Loss: 0.3791360 Vali Loss: 0.2955147 Test Loss: 0.4852754
Validation loss decreased (0.303119 --> 0.295515).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3194279
	speed: 0.3787s/iter; left time: 1501.3565s
	iters: 200, epoch: 4 | loss: 0.3311963
	speed: 0.3700s/iter; left time: 1429.6477s
Epoch: 4 cost time: 89.97020268440247
Epoch: 4, Steps: 239 | Train Loss: 0.3599633 Vali Loss: 0.3946776 Test Loss: 0.4800032
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2575090
	speed: 0.4015s/iter; left time: 1495.7211s
	iters: 200, epoch: 5 | loss: 0.3825617
	speed: 0.3849s/iter; left time: 1395.2134s
Epoch: 5 cost time: 93.16200852394104
Epoch: 5, Steps: 239 | Train Loss: 0.3403346 Vali Loss: 0.3502924 Test Loss: 0.5194983
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.3720272
	speed: 0.3543s/iter; left time: 1234.9764s
	iters: 200, epoch: 6 | loss: 0.3104858
	speed: 0.4072s/iter; left time: 1378.8511s
Epoch: 6 cost time: 91.26163220405579
Epoch: 6, Steps: 239 | Train Loss: 0.3293697 Vali Loss: 0.3711647 Test Loss: 0.5730528
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : former_m1999m_il360_ol60_sl6,10,15,20,30,60_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2245
mse:0.44599488377571106, mae:0.4594481289386749
