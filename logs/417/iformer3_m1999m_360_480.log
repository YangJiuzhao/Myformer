Args in experiment:
Namespace(model='iformer', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=480, seg_lens='12,8,6,4,3', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, fc_dropout=0.05, head_dropout=0.0, patch_len=12, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=1e-05, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : iformer_m1999m_il360_ol480_sl12,8,6,4,3_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7224
val 674
test 1825
	iters: 100, epoch: 1 | loss: 0.7301632
	speed: 0.3311s/iter; left time: 1463.8301s
	iters: 200, epoch: 1 | loss: 0.6002480
	speed: 0.3032s/iter; left time: 1310.2691s
Epoch: 1 cost time: 71.99295854568481
Epoch: 1, Steps: 226 | Train Loss: 0.7704010 Vali Loss: 0.3849311 Test Loss: 1.1493503
Validation loss decreased (inf --> 0.384931).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6450808
	speed: 0.3083s/iter; left time: 1293.5237s
	iters: 200, epoch: 2 | loss: 0.6494063
	speed: 0.3160s/iter; left time: 1294.1275s
Epoch: 2 cost time: 71.20762586593628
Epoch: 2, Steps: 226 | Train Loss: 0.6238550 Vali Loss: 0.4018788 Test Loss: 0.9023660
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.5548829
	speed: 0.3320s/iter; left time: 1317.8664s
	iters: 200, epoch: 3 | loss: 0.6845447
	speed: 0.3453s/iter; left time: 1335.9785s
Epoch: 3 cost time: 79.07749462127686
Epoch: 3, Steps: 226 | Train Loss: 0.6003028 Vali Loss: 0.3819617 Test Loss: 0.9660864
Validation loss decreased (0.384931 --> 0.381962).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5045436
	speed: 0.3784s/iter; left time: 1416.3202s
	iters: 200, epoch: 4 | loss: 0.6067330
	speed: 0.3836s/iter; left time: 1397.5520s
Epoch: 4 cost time: 85.9746744632721
Epoch: 4, Steps: 226 | Train Loss: 0.5888964 Vali Loss: 0.3514574 Test Loss: 0.9690607
Validation loss decreased (0.381962 --> 0.351457).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.6048794
	speed: 0.3702s/iter; left time: 1301.9994s
	iters: 200, epoch: 5 | loss: 0.6319604
	speed: 0.3767s/iter; left time: 1287.2638s
Epoch: 5 cost time: 84.41064095497131
Epoch: 5, Steps: 226 | Train Loss: 0.5792329 Vali Loss: 0.3575912 Test Loss: 1.0313780
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.5103355
	speed: 0.3652s/iter; left time: 1201.7640s
	iters: 200, epoch: 6 | loss: 0.6423339
	speed: 0.3710s/iter; left time: 1183.9875s
Epoch: 6 cost time: 82.67865586280823
Epoch: 6, Steps: 226 | Train Loss: 0.5725902 Vali Loss: 0.3497682 Test Loss: 1.0566778
Validation loss decreased (0.351457 --> 0.349768).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.6090444
	speed: 0.3716s/iter; left time: 1138.8402s
	iters: 200, epoch: 7 | loss: 0.5784101
	speed: 0.3962s/iter; left time: 1174.7882s
Epoch: 7 cost time: 85.87731432914734
Epoch: 7, Steps: 226 | Train Loss: 0.5668857 Vali Loss: 0.3484209 Test Loss: 1.0642073
Validation loss decreased (0.349768 --> 0.348421).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5592307
	speed: 0.3772s/iter; left time: 1070.7562s
	iters: 200, epoch: 8 | loss: 0.6223827
	speed: 0.3867s/iter; left time: 1059.2686s
Epoch: 8 cost time: 86.7072126865387
Epoch: 8, Steps: 226 | Train Loss: 0.5625588 Vali Loss: 0.3464567 Test Loss: 1.0930453
Validation loss decreased (0.348421 --> 0.346457).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.5491222
	speed: 0.3697s/iter; left time: 966.1001s
	iters: 200, epoch: 9 | loss: 0.4898235
	speed: 0.3845s/iter; left time: 966.1473s
Epoch: 9 cost time: 85.41998291015625
Epoch: 9, Steps: 226 | Train Loss: 0.5593169 Vali Loss: 0.3466347 Test Loss: 1.1046229
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.5731783
	speed: 0.3873s/iter; left time: 924.3980s
	iters: 200, epoch: 10 | loss: 0.5205837
	speed: 0.3739s/iter; left time: 855.0655s
Epoch: 10 cost time: 86.66149616241455
Epoch: 10, Steps: 226 | Train Loss: 0.5569046 Vali Loss: 0.3455056 Test Loss: 1.1266625
Validation loss decreased (0.346457 --> 0.345506).  Saving model ...
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.4728225
	speed: 0.3533s/iter; left time: 763.5314s
	iters: 200, epoch: 11 | loss: 0.5284238
	speed: 0.3454s/iter; left time: 711.9200s
Epoch: 11 cost time: 80.68385171890259
Epoch: 11, Steps: 226 | Train Loss: 0.5554467 Vali Loss: 0.3446447 Test Loss: 1.1368945
Validation loss decreased (0.345506 --> 0.344645).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6560997
	speed: 0.3812s/iter; left time: 737.7125s
	iters: 200, epoch: 12 | loss: 0.6407499
	speed: 0.3902s/iter; left time: 716.0723s
Epoch: 12 cost time: 87.37175703048706
Epoch: 12, Steps: 226 | Train Loss: 0.5544812 Vali Loss: 0.3444137 Test Loss: 1.1536998
Validation loss decreased (0.344645 --> 0.344414).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4499826
	speed: 0.3960s/iter; left time: 676.7187s
	iters: 200, epoch: 13 | loss: 0.5997020
	speed: 0.3926s/iter; left time: 631.6223s
Epoch: 13 cost time: 89.54503774642944
Epoch: 13, Steps: 226 | Train Loss: 0.5527906 Vali Loss: 0.3426099 Test Loss: 1.1489513
Validation loss decreased (0.344414 --> 0.342610).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5685490
	speed: 0.3850s/iter; left time: 570.9734s
	iters: 200, epoch: 14 | loss: 0.4320002
	speed: 0.3767s/iter; left time: 520.9871s
Epoch: 14 cost time: 87.25030946731567
Epoch: 14, Steps: 226 | Train Loss: 0.5518530 Vali Loss: 0.3442532 Test Loss: 1.1666900
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 15 | loss: 0.6419770
	speed: 0.3907s/iter; left time: 491.1076s
	iters: 200, epoch: 15 | loss: 0.5727708
	speed: 0.4169s/iter; left time: 482.2969s
Epoch: 15 cost time: 91.93487024307251
Epoch: 15, Steps: 226 | Train Loss: 0.5505717 Vali Loss: 0.3403865 Test Loss: 1.1851062
Validation loss decreased (0.342610 --> 0.340387).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6292838
	speed: 0.4196s/iter; left time: 432.6378s
	iters: 200, epoch: 16 | loss: 0.5423982
	speed: 0.3889s/iter; left time: 362.0533s
Epoch: 16 cost time: 91.34131693840027
Epoch: 16, Steps: 226 | Train Loss: 0.5496670 Vali Loss: 0.3475277 Test Loss: 1.1800884
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 17 | loss: 0.5644481
	speed: 0.3934s/iter; left time: 316.6807s
	iters: 200, epoch: 17 | loss: 0.5763355
	speed: 0.3842s/iter; left time: 270.8471s
Epoch: 17 cost time: 88.1830005645752
Epoch: 17, Steps: 226 | Train Loss: 0.5489326 Vali Loss: 0.3465378 Test Loss: 1.2064499
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 18 | loss: 0.6155694
	speed: 0.4133s/iter; left time: 239.2766s
	iters: 200, epoch: 18 | loss: 0.4987344
	speed: 0.4351s/iter; left time: 208.4364s
Epoch: 18 cost time: 95.75019383430481
Epoch: 18, Steps: 226 | Train Loss: 0.5471612 Vali Loss: 0.3453306 Test Loss: 1.2178012
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : iformer_m1999m_il360_ol480_sl12,8,6,4,3_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1825
mse:1.173107385635376, mae:0.8908460140228271
