Args in experiment:
Namespace(model='iformer', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=480, seg_lens='12,8,6,4,3', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=1e-05, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : iformer_m1999m_il360_ol480_sl12,8,6,4,3_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7224
val 674
test 1825
	iters: 100, epoch: 1 | loss: 0.7391851
	speed: 0.2080s/iter; left time: 919.4510s
	iters: 200, epoch: 1 | loss: 0.6064518
	speed: 0.1609s/iter; left time: 695.0508s
Epoch: 1 cost time: 40.908374547958374
Epoch: 1, Steps: 226 | Train Loss: 0.7760412 Vali Loss: 0.3812755 Test Loss: 1.1357647
Validation loss decreased (inf --> 0.381275).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6454508
	speed: 0.1586s/iter; left time: 665.4048s
	iters: 200, epoch: 2 | loss: 0.6444435
	speed: 0.2087s/iter; left time: 854.4648s
Epoch: 2 cost time: 41.15796375274658
Epoch: 2, Steps: 226 | Train Loss: 0.6225259 Vali Loss: 0.4373601 Test Loss: 0.7543395
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.5580545
	speed: 0.2552s/iter; left time: 1012.7442s
	iters: 200, epoch: 3 | loss: 0.6847302
	speed: 0.1757s/iter; left time: 679.6754s
Epoch: 3 cost time: 46.999311447143555
Epoch: 3, Steps: 226 | Train Loss: 0.5991828 Vali Loss: 0.4084258 Test Loss: 0.7919672
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.5105907
	speed: 0.1667s/iter; left time: 623.9063s
	iters: 200, epoch: 4 | loss: 0.5960335
	speed: 0.1762s/iter; left time: 641.9672s
Epoch: 4 cost time: 43.49109888076782
Epoch: 4, Steps: 226 | Train Loss: 0.5874815 Vali Loss: 0.3595016 Test Loss: 0.8374644
Validation loss decreased (0.381275 --> 0.359502).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.6117343
	speed: 0.1910s/iter; left time: 671.7386s
	iters: 200, epoch: 5 | loss: 0.6304714
	speed: 0.1826s/iter; left time: 623.8446s
Epoch: 5 cost time: 41.89912033081055
Epoch: 5, Steps: 226 | Train Loss: 0.5783332 Vali Loss: 0.3506048 Test Loss: 0.9277962
Validation loss decreased (0.359502 --> 0.350605).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5103994
	speed: 0.1617s/iter; left time: 532.1517s
	iters: 200, epoch: 6 | loss: 0.6336953
	speed: 0.1897s/iter; left time: 605.2188s
Epoch: 6 cost time: 42.58187484741211
Epoch: 6, Steps: 226 | Train Loss: 0.5714551 Vali Loss: 0.3474275 Test Loss: 0.9612007
Validation loss decreased (0.350605 --> 0.347427).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.6037390
	speed: 0.2605s/iter; left time: 798.3928s
	iters: 200, epoch: 7 | loss: 0.5756481
	speed: 0.3340s/iter; left time: 990.2223s
Epoch: 7 cost time: 69.13050413131714
Epoch: 7, Steps: 226 | Train Loss: 0.5652339 Vali Loss: 0.3433268 Test Loss: 1.0007105
Validation loss decreased (0.347427 --> 0.343327).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5605300
	speed: 0.2440s/iter; left time: 692.6176s
	iters: 200, epoch: 8 | loss: 0.6119191
	speed: 0.1498s/iter; left time: 410.3165s
Epoch: 8 cost time: 43.053300857543945
Epoch: 8, Steps: 226 | Train Loss: 0.5611464 Vali Loss: 0.3421669 Test Loss: 1.0424012
Validation loss decreased (0.343327 --> 0.342167).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.5374277
	speed: 0.2174s/iter; left time: 567.9692s
	iters: 200, epoch: 9 | loss: 0.4852300
	speed: 0.2720s/iter; left time: 683.5631s
Epoch: 9 cost time: 55.404948472976685
Epoch: 9, Steps: 226 | Train Loss: 0.5575712 Vali Loss: 0.3458508 Test Loss: 1.0736262
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.5743625
	speed: 0.3129s/iter; left time: 746.8138s
	iters: 200, epoch: 10 | loss: 0.5240381
	speed: 0.3549s/iter; left time: 811.7088s
Epoch: 10 cost time: 73.02960848808289
Epoch: 10, Steps: 226 | Train Loss: 0.5550823 Vali Loss: 0.3486570 Test Loss: 1.1116074
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.4782593
	speed: 0.3114s/iter; left time: 673.0138s
	iters: 200, epoch: 11 | loss: 0.5255030
	speed: 0.2301s/iter; left time: 474.1752s
Epoch: 11 cost time: 58.59118938446045
Epoch: 11, Steps: 226 | Train Loss: 0.5535007 Vali Loss: 0.3457373 Test Loss: 1.1314108
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : iformer_m1999m_il360_ol480_sl12,8,6,4,3_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1825
mse:1.033371090888977, mae:0.840621292591095
