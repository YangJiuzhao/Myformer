Args in experiment:
Namespace(model='iformer', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=60, seg_lens='60,36,24,18,12,6', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.4, baseline=False, fc_dropout=0.05, head_dropout=0.0, patch_len=64, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=3, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:0
>>>>>>>start training : iformer_m1999m_il360_ol60_sl60,36,24,18,12,6_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7644
val 1094
test 2245
	iters: 100, epoch: 1 | loss: 0.5473289
	speed: 0.4441s/iter; left time: 10569.5606s
	iters: 200, epoch: 1 | loss: 0.5157282
	speed: 0.3891s/iter; left time: 9220.9361s
Epoch: 1 cost time: 99.24866986274719
Epoch: 1, Steps: 239 | Train Loss: 0.7836426 Vali Loss: 0.3657569 Test Loss: 0.4985592
Validation loss decreased (inf --> 0.365757).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4779339
	speed: 0.4003s/iter; left time: 9431.7879s
	iters: 200, epoch: 2 | loss: 0.5946863
	speed: 0.4693s/iter; left time: 11010.8900s
Epoch: 2 cost time: 105.27855396270752
Epoch: 2, Steps: 239 | Train Loss: 0.5453333 Vali Loss: 0.3222214 Test Loss: 0.4399534
Validation loss decreased (0.365757 --> 0.322221).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4133597
	speed: 0.5119s/iter; left time: 11940.1751s
	iters: 200, epoch: 3 | loss: 0.3681667
	speed: 0.5098s/iter; left time: 11838.5525s
Epoch: 3 cost time: 122.84100723266602
Epoch: 3, Steps: 239 | Train Loss: 0.4345180 Vali Loss: 0.2939446 Test Loss: 0.4095981
Validation loss decreased (0.322221 --> 0.293945).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2617925
	speed: 0.5365s/iter; left time: 12383.8170s
	iters: 200, epoch: 4 | loss: 0.3544978
	speed: 0.5278s/iter; left time: 12130.6213s
Epoch: 4 cost time: 127.50233626365662
Epoch: 4, Steps: 239 | Train Loss: 0.4215544 Vali Loss: 0.2881175 Test Loss: 0.4102508
Validation loss decreased (0.293945 --> 0.288118).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3945126
	speed: 0.5050s/iter; left time: 11537.0154s
	iters: 200, epoch: 5 | loss: 0.3450055
	speed: 0.5664s/iter; left time: 12883.4115s
Epoch: 5 cost time: 128.8173222541809
Epoch: 5, Steps: 239 | Train Loss: 0.3949110 Vali Loss: 0.2903224 Test Loss: 0.3951111
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.4128981
	speed: 0.5668s/iter; left time: 12813.8266s
	iters: 200, epoch: 6 | loss: 0.4266316
	speed: 0.5511s/iter; left time: 12403.3471s
Epoch: 6 cost time: 134.83024907112122
Epoch: 6, Steps: 239 | Train Loss: 0.3911378 Vali Loss: 0.2829167 Test Loss: 0.3960908
Validation loss decreased (0.288118 --> 0.282917).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.3426981
	speed: 0.7006s/iter; left time: 15670.0847s
	iters: 200, epoch: 7 | loss: 0.4012092
	speed: 0.7132s/iter; left time: 15880.1779s
Epoch: 7 cost time: 169.44700956344604
Epoch: 7, Steps: 239 | Train Loss: 0.3803810 Vali Loss: 0.2831614 Test Loss: 0.3916532
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.3766645
	speed: 0.6976s/iter; left time: 15436.0136s
	iters: 200, epoch: 8 | loss: 0.4121936
	speed: 0.7263s/iter; left time: 15998.2324s
Epoch: 8 cost time: 171.34745240211487
Epoch: 8, Steps: 239 | Train Loss: 0.3795157 Vali Loss: 0.2798381 Test Loss: 0.3909081
Validation loss decreased (0.282917 --> 0.279838).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 9 | loss: 0.4630644
	speed: 0.6872s/iter; left time: 15041.5245s
	iters: 200, epoch: 9 | loss: 0.3169456
	speed: 0.7112s/iter; left time: 15496.5016s
Epoch: 9 cost time: 167.66938471794128
Epoch: 9, Steps: 239 | Train Loss: 0.3749074 Vali Loss: 0.2817548 Test Loss: 0.3897226
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.3997801
	speed: 0.7183s/iter; left time: 15550.4562s
	iters: 200, epoch: 10 | loss: 0.3529590
	speed: 0.7087s/iter; left time: 15272.0434s
Epoch: 10 cost time: 170.09017372131348
Epoch: 10, Steps: 239 | Train Loss: 0.3723797 Vali Loss: 0.2784268 Test Loss: 0.3890110
Validation loss decreased (0.279838 --> 0.278427).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 11 | loss: 0.3800045
	speed: 0.7062s/iter; left time: 15121.2125s
	iters: 200, epoch: 11 | loss: 0.3518597
	speed: 0.6938s/iter; left time: 14785.8549s
Epoch: 11 cost time: 167.6197772026062
Epoch: 11, Steps: 239 | Train Loss: 0.3688292 Vali Loss: 0.2798310 Test Loss: 0.3893461
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.3999155
	speed: 0.6927s/iter; left time: 14665.1691s
	iters: 200, epoch: 12 | loss: 0.3166783
	speed: 0.6905s/iter; left time: 14550.5458s
Epoch: 12 cost time: 166.89372539520264
Epoch: 12, Steps: 239 | Train Loss: 0.3690796 Vali Loss: 0.2795793 Test Loss: 0.3892594
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 13 | loss: 0.3735432
	speed: 0.6966s/iter; left time: 14582.4703s
	iters: 200, epoch: 13 | loss: 0.3816963
	speed: 0.5997s/iter; left time: 12493.3241s
Epoch: 13 cost time: 151.29148697853088
Epoch: 13, Steps: 239 | Train Loss: 0.3681008 Vali Loss: 0.2760662 Test Loss: 0.3889118
Validation loss decreased (0.278427 --> 0.276066).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6227008
	speed: 0.5344s/iter; left time: 11058.2126s
	iters: 200, epoch: 14 | loss: 0.3780965
	speed: 0.5744s/iter; left time: 11828.2503s
Epoch: 14 cost time: 132.7646460533142
Epoch: 14, Steps: 239 | Train Loss: 0.3676957 Vali Loss: 0.2761470 Test Loss: 0.3903550
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 15 | loss: 0.3999283
	speed: 0.5617s/iter; left time: 11489.4746s
	iters: 200, epoch: 15 | loss: 0.2971232
	speed: 0.5347s/iter; left time: 10883.2888s
Epoch: 15 cost time: 129.8514323234558
Epoch: 15, Steps: 239 | Train Loss: 0.3669643 Vali Loss: 0.2810422 Test Loss: 0.3881300
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 16 | loss: 0.3810445
	speed: 0.4058s/iter; left time: 8203.7318s
	iters: 200, epoch: 16 | loss: 0.3981155
	speed: 0.4044s/iter; left time: 8134.1991s
Epoch: 16 cost time: 96.79640173912048
Epoch: 16, Steps: 239 | Train Loss: 0.3663973 Vali Loss: 0.2823714 Test Loss: 0.3878639
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : iformer_m1999m_il360_ol60_sl60,36,24,18,12,6_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2245
mse:0.3556281626224518, mae:0.3073013424873352
