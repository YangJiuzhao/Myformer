Args in experiment:
Namespace(model='patchtst', data='ETTh1', root_path='./datasets/', data_path='ETTh1.csv', data_split=[8640, 2880, 2880], checkpoints='./checkpoints/', in_len=336, out_len=720, seg_lens='64,32,16,8', data_dim=7, d_model=16, d_ff=128, n_heads=4, a_layers=3, dropout=0.3, baseline='True', fc_dropout=0.05, head_dropout=0.0, patch_len=12, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=3, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : patchtst_ETTh1_il336_ol720_sl64,32,16,8_dm16_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2161
test 2161
	iters: 100, epoch: 1 | loss: 0.6633748
	speed: 0.0364s/iter; left time: 862.7055s
	iters: 200, epoch: 1 | loss: 0.5633090
	speed: 0.0386s/iter; left time: 910.0747s
Epoch: 1 cost time: 7.944669961929321
Epoch: 1, Steps: 238 | Train Loss: 0.6917607 Vali Loss: 1.4557193 Test Loss: 0.4632683
Validation loss decreased (inf --> 1.455719).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5775971
	speed: 0.0404s/iter; left time: 947.0020s
	iters: 200, epoch: 2 | loss: 0.6337844
	speed: 0.0123s/iter; left time: 286.9004s
Epoch: 2 cost time: 8.635662078857422
Epoch: 2, Steps: 238 | Train Loss: 0.6128296 Vali Loss: 1.4252733 Test Loss: 0.4507377
Validation loss decreased (1.455719 --> 1.425273).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5674373
	speed: 0.0357s/iter; left time: 828.4546s
	iters: 200, epoch: 3 | loss: 0.6222237
	speed: 0.0188s/iter; left time: 435.7155s
Epoch: 3 cost time: 6.603906631469727
Epoch: 3, Steps: 238 | Train Loss: 0.5967326 Vali Loss: 1.4262216 Test Loss: 0.4491434
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.6776205
	speed: 0.0122s/iter; left time: 280.5589s
	iters: 200, epoch: 4 | loss: 0.6436516
	speed: 0.0396s/iter; left time: 905.6943s
Epoch: 4 cost time: 5.657070636749268
Epoch: 4, Steps: 238 | Train Loss: 0.5942142 Vali Loss: 1.4291647 Test Loss: 0.4487422
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.6691236
	speed: 0.0421s/iter; left time: 958.3164s
	iters: 200, epoch: 5 | loss: 0.5594119
	speed: 0.0240s/iter; left time: 544.4104s
Epoch: 5 cost time: 8.568361520767212
Epoch: 5, Steps: 238 | Train Loss: 0.5913891 Vali Loss: 1.4241383 Test Loss: 0.4490925
Validation loss decreased (1.425273 --> 1.424138).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6425918
	speed: 0.0127s/iter; left time: 285.0192s
	iters: 200, epoch: 6 | loss: 0.5703127
	speed: 0.0404s/iter; left time: 905.0049s
Epoch: 6 cost time: 8.60586166381836
Epoch: 6, Steps: 238 | Train Loss: 0.5882272 Vali Loss: 1.4244838 Test Loss: 0.4503373
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.6806865
	speed: 0.0401s/iter; left time: 893.6751s
	iters: 200, epoch: 7 | loss: 0.6252073
	speed: 0.0519s/iter; left time: 1151.8780s
Epoch: 7 cost time: 10.002422332763672
Epoch: 7, Steps: 238 | Train Loss: 0.5864645 Vali Loss: 1.4267006 Test Loss: 0.4507550
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.5957772
	speed: 0.0264s/iter; left time: 581.2686s
	iters: 200, epoch: 8 | loss: 0.5514396
	speed: 0.0320s/iter; left time: 702.4037s
Epoch: 8 cost time: 9.171990633010864
Epoch: 8, Steps: 238 | Train Loss: 0.5852768 Vali Loss: 1.4295750 Test Loss: 0.4516105
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : patchtst_ETTh1_il336_ol720_sl64,32,16,8_dm16_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2161
mse:0.4480806887149811, mae:0.46337807178497314
