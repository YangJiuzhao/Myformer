Args in experiment:
Namespace(model='patchtst', data='ETTm1', root_path='./datasets/', data_path='ETTm1.csv', data_split=[34560, 11520, 11520], checkpoints='./checkpoints/', in_len=336, out_len=96, seg_lens='64,32,16,8', data_dim=7, d_model=64, d_ff=128, n_heads=4, a_layers=3, dropout=0.3, baseline='True', fc_dropout=0.05, head_dropout=0.0, patch_len=64, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=3, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : patchtst_ETTm1_il336_ol96_sl64,32,16,8_dm64_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34129
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.3799934
	speed: 0.0499s/iter; left time: 5315.3074s
	iters: 200, epoch: 1 | loss: 0.3683762
	speed: 0.0262s/iter; left time: 2793.6136s
	iters: 300, epoch: 1 | loss: 0.3612446
	speed: 0.0639s/iter; left time: 6800.4045s
	iters: 400, epoch: 1 | loss: 0.3669209
	speed: 0.0293s/iter; left time: 3112.9477s
	iters: 500, epoch: 1 | loss: 0.2553430
	speed: 0.0407s/iter; left time: 4319.5040s
	iters: 600, epoch: 1 | loss: 0.2581706
	speed: 0.0264s/iter; left time: 2798.5804s
	iters: 700, epoch: 1 | loss: 0.2288740
	speed: 0.0615s/iter; left time: 6514.1107s
	iters: 800, epoch: 1 | loss: 0.2470502
	speed: 0.0236s/iter; left time: 2501.9363s
	iters: 900, epoch: 1 | loss: 0.2446927
	speed: 0.0582s/iter; left time: 6162.0401s
	iters: 1000, epoch: 1 | loss: 0.2907333
	speed: 0.0507s/iter; left time: 5360.7798s
Epoch: 1 cost time: 43.888503074645996
Epoch: 1, Steps: 1067 | Train Loss: 0.2935004 Vali Loss: 0.3849086 Test Loss: 0.2928928
Validation loss decreased (inf --> 0.384909).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2357884
	speed: 0.0482s/iter; left time: 5087.4772s
	iters: 200, epoch: 2 | loss: 0.2175828
	speed: 0.0578s/iter; left time: 6097.8319s
	iters: 300, epoch: 2 | loss: 0.2219601
	speed: 0.0213s/iter; left time: 2247.5265s
	iters: 400, epoch: 2 | loss: 0.2347181
	speed: 0.0402s/iter; left time: 4228.2129s
	iters: 500, epoch: 2 | loss: 0.2279012
	speed: 0.0377s/iter; left time: 3964.8482s
	iters: 600, epoch: 2 | loss: 0.3028496
	speed: 0.0266s/iter; left time: 2794.3497s
	iters: 700, epoch: 2 | loss: 0.3005594
	speed: 0.0441s/iter; left time: 4625.7849s
	iters: 800, epoch: 2 | loss: 0.2694399
	speed: 0.0159s/iter; left time: 1671.8769s
	iters: 900, epoch: 2 | loss: 0.2785880
	speed: 0.0446s/iter; left time: 4674.1581s
	iters: 1000, epoch: 2 | loss: 0.3073437
	speed: 0.0172s/iter; left time: 1798.1220s
Epoch: 2 cost time: 39.324331283569336
Epoch: 2, Steps: 1067 | Train Loss: 0.2583477 Vali Loss: 0.3782114 Test Loss: 0.2892483
Validation loss decreased (0.384909 --> 0.378211).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2127593
	speed: 0.0412s/iter; left time: 4306.8667s
	iters: 200, epoch: 3 | loss: 0.2609098
	speed: 0.0501s/iter; left time: 5225.3645s
	iters: 300, epoch: 3 | loss: 0.2073007
	speed: 0.0152s/iter; left time: 1582.1124s
	iters: 400, epoch: 3 | loss: 0.3101565
	speed: 0.0337s/iter; left time: 3505.3209s
	iters: 500, epoch: 3 | loss: 0.2445319
	speed: 0.0211s/iter; left time: 2195.1151s
	iters: 600, epoch: 3 | loss: 0.3656141
	speed: 0.0482s/iter; left time: 5009.0818s
	iters: 700, epoch: 3 | loss: 0.2284047
	speed: 0.0361s/iter; left time: 3752.0428s
	iters: 800, epoch: 3 | loss: 0.2404327
	speed: 0.0553s/iter; left time: 5739.5706s
	iters: 900, epoch: 3 | loss: 0.2243465
	speed: 0.0459s/iter; left time: 4760.9171s
	iters: 1000, epoch: 3 | loss: 0.2716514
	speed: 0.0323s/iter; left time: 3347.9582s
Epoch: 3 cost time: 41.205907106399536
Epoch: 3, Steps: 1067 | Train Loss: 0.2479485 Vali Loss: 0.3810866 Test Loss: 0.2862511
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2206962
	speed: 0.0429s/iter; left time: 4433.2909s
	iters: 200, epoch: 4 | loss: 0.2235951
	speed: 0.0587s/iter; left time: 6065.3578s
	iters: 300, epoch: 4 | loss: 0.2683398
	speed: 0.0577s/iter; left time: 5952.9708s
	iters: 400, epoch: 4 | loss: 0.2669405
	speed: 0.0657s/iter; left time: 6775.7328s
	iters: 500, epoch: 4 | loss: 0.2371922
	speed: 0.0203s/iter; left time: 2092.1698s
	iters: 600, epoch: 4 | loss: 0.2516704
	speed: 0.0442s/iter; left time: 4547.6524s
	iters: 700, epoch: 4 | loss: 0.2194086
	speed: 0.0233s/iter; left time: 2399.4558s
	iters: 800, epoch: 4 | loss: 0.2261008
	speed: 0.0329s/iter; left time: 3374.9086s
	iters: 900, epoch: 4 | loss: 0.2379655
	speed: 0.0506s/iter; left time: 5194.9122s
	iters: 1000, epoch: 4 | loss: 0.1957178
	speed: 0.0505s/iter; left time: 5180.9897s
