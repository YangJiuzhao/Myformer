Args in experiment:
Namespace(data='ETTm1', root_path='./datasets/', data_path='ETTm1.csv', data_split=[34560, 11520, 11520], checkpoints='./checkpoints/', in_len=672, out_len=672, seg_lens='12,24,36,48,72,96', data_dim=7, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.2, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=1e-05, lradj='type1', itr=5, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3')
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33217
val 10849
test 10849
	iters: 100, epoch: 1 | loss: 0.7133139
	speed: 0.2124s/iter; left time: 4392.8932s
	iters: 200, epoch: 1 | loss: 0.5623704
	speed: 0.1867s/iter; left time: 3842.1958s
	iters: 300, epoch: 1 | loss: 0.5495732
	speed: 0.1837s/iter; left time: 3762.5618s
	iters: 400, epoch: 1 | loss: 0.4983970
	speed: 0.1759s/iter; left time: 3585.4608s
	iters: 500, epoch: 1 | loss: 0.4411140
	speed: 0.1879s/iter; left time: 3811.7004s
	iters: 600, epoch: 1 | loss: 0.4943690
	speed: 0.1772s/iter; left time: 3575.7005s
	iters: 700, epoch: 1 | loss: 0.4422823
	speed: 0.1892s/iter; left time: 3799.1358s
	iters: 800, epoch: 1 | loss: 0.4161475
	speed: 0.1844s/iter; left time: 3685.3950s
	iters: 900, epoch: 1 | loss: 0.4420480
	speed: 0.1789s/iter; left time: 3556.7139s
	iters: 1000, epoch: 1 | loss: 0.4439764
	speed: 0.2063s/iter; left time: 4081.5739s
Epoch: 1 cost time: 195.953373670578
Epoch: 1, Steps: 1039 | Train Loss: 0.5638342 Vali Loss: 0.9155124 Test Loss: 0.4793890
Validation loss decreased (inf --> 0.915512).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5200617
	speed: 0.1861s/iter; left time: 3655.7861s
	iters: 200, epoch: 2 | loss: 0.4510717
	speed: 0.1911s/iter; left time: 3733.7810s
	iters: 300, epoch: 2 | loss: 0.3821529
	speed: 0.1903s/iter; left time: 3700.2037s
	iters: 400, epoch: 2 | loss: 0.3962630
	speed: 0.1889s/iter; left time: 3652.9366s
	iters: 500, epoch: 2 | loss: 0.3969317
	speed: 0.1844s/iter; left time: 3547.9766s
	iters: 600, epoch: 2 | loss: 0.4372449
	speed: 0.1910s/iter; left time: 3656.4269s
	iters: 700, epoch: 2 | loss: 0.4287899
	speed: 0.1885s/iter; left time: 3588.7369s
	iters: 800, epoch: 2 | loss: 0.4565423
	speed: 0.1801s/iter; left time: 3411.5672s
	iters: 900, epoch: 2 | loss: 0.4076718
	speed: 0.1804s/iter; left time: 3398.9414s
	iters: 1000, epoch: 2 | loss: 0.4220368
	speed: 0.1926s/iter; left time: 3608.8515s
Epoch: 2 cost time: 194.45088291168213
Epoch: 2, Steps: 1039 | Train Loss: 0.4267631 Vali Loss: 0.9099190 Test Loss: 0.4855079
Validation loss decreased (0.915512 --> 0.909919).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.3705100
	speed: 0.1741s/iter; left time: 3238.3986s
	iters: 200, epoch: 3 | loss: 0.3653741
	speed: 0.1793s/iter; left time: 3316.8240s
	iters: 300, epoch: 3 | loss: 0.4033858
	speed: 0.1929s/iter; left time: 3550.0100s
	iters: 400, epoch: 3 | loss: 0.4170460
	speed: 0.1857s/iter; left time: 3399.0996s
	iters: 500, epoch: 3 | loss: 0.3703745
	speed: 0.1966s/iter; left time: 3578.6992s
	iters: 600, epoch: 3 | loss: 0.3756981
	speed: 0.2117s/iter; left time: 3831.6261s
	iters: 700, epoch: 3 | loss: 0.4061419
	speed: 0.1985s/iter; left time: 3573.1380s
	iters: 800, epoch: 3 | loss: 0.3761781
	speed: 0.1927s/iter; left time: 3449.1223s
	iters: 900, epoch: 3 | loss: 0.3927819
	speed: 0.1911s/iter; left time: 3401.9003s
	iters: 1000, epoch: 3 | loss: 0.3918704
	speed: 0.1896s/iter; left time: 3356.6638s
Epoch: 3 cost time: 198.33501625061035
Epoch: 3, Steps: 1039 | Train Loss: 0.3920974 Vali Loss: 0.9296055 Test Loss: 0.5122715
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3879135
	speed: 0.1907s/iter; left time: 3348.8520s
	iters: 200, epoch: 4 | loss: 0.3779615
	speed: 0.1736s/iter; left time: 3030.9738s
	iters: 300, epoch: 4 | loss: 0.3593938
	speed: 0.1787s/iter; left time: 3103.4370s
	iters: 400, epoch: 4 | loss: 0.3672757
	speed: 0.1915s/iter; left time: 3306.2372s
	iters: 500, epoch: 4 | loss: 0.3584526
	speed: 0.1997s/iter; left time: 3427.1871s
	iters: 600, epoch: 4 | loss: 0.3693604
	speed: 0.1918s/iter; left time: 3273.3507s
	iters: 700, epoch: 4 | loss: 0.3613155
	speed: 0.1759s/iter; left time: 2983.5815s
	iters: 800, epoch: 4 | loss: 0.3704807
	speed: 0.1776s/iter; left time: 2995.2260s
	iters: 900, epoch: 4 | loss: 0.3580399
	speed: 0.1730s/iter; left time: 2899.6430s
	iters: 1000, epoch: 4 | loss: 0.3660636
	speed: 0.1787s/iter; left time: 2977.7579s
Epoch: 4 cost time: 190.73616862297058
Epoch: 4, Steps: 1039 | Train Loss: 0.3812660 Vali Loss: 0.9257019 Test Loss: 0.5030275
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.3497073
	speed: 0.1731s/iter; left time: 2860.7932s
	iters: 200, epoch: 5 | loss: 0.3551174
	speed: 0.1801s/iter; left time: 2958.2129s
	iters: 300, epoch: 5 | loss: 0.3759871
	speed: 0.1786s/iter; left time: 2916.1581s
	iters: 400, epoch: 5 | loss: 0.3806296
	speed: 0.1811s/iter; left time: 2938.7558s
	iters: 500, epoch: 5 | loss: 0.4010430
	speed: 0.1723s/iter; left time: 2778.3408s
	iters: 600, epoch: 5 | loss: 0.3534662
	speed: 0.1875s/iter; left time: 3003.8998s
	iters: 700, epoch: 5 | loss: 0.3379473
	speed: 0.1928s/iter; left time: 3070.8685s
	iters: 800, epoch: 5 | loss: 0.3418577
	speed: 0.1817s/iter; left time: 2875.5113s
	iters: 900, epoch: 5 | loss: 0.3314339
	speed: 0.2010s/iter; left time: 3160.6035s
	iters: 1000, epoch: 5 | loss: 0.3887945
	speed: 0.1899s/iter; left time: 2967.5115s
Epoch: 5 cost time: 191.75097584724426
Epoch: 5, Steps: 1039 | Train Loss: 0.3691416 Vali Loss: 0.9332471 Test Loss: 0.5066255
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10849
mse:0.4854893386363983, mae:0.48273584246635437
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33217
val 10849
test 10849
	iters: 100, epoch: 1 | loss: 0.7412037
	speed: 0.1716s/iter; left time: 3549.3912s
	iters: 200, epoch: 1 | loss: 0.6645178
	speed: 0.1675s/iter; left time: 3446.8576s
	iters: 300, epoch: 1 | loss: 0.5283960
	speed: 0.1901s/iter; left time: 3893.6833s
	iters: 400, epoch: 1 | loss: 0.4708426
	speed: 0.1753s/iter; left time: 3571.8750s
	iters: 500, epoch: 1 | loss: 0.4737632
	speed: 0.1568s/iter; left time: 3180.4560s
	iters: 600, epoch: 1 | loss: 0.5038826
	speed: 0.1675s/iter; left time: 3379.6509s
	iters: 700, epoch: 1 | loss: 0.4849563
	speed: 0.1756s/iter; left time: 3525.3927s
	iters: 800, epoch: 1 | loss: 0.4489808
	speed: 0.1712s/iter; left time: 3420.3675s
	iters: 900, epoch: 1 | loss: 0.4621138
	speed: 0.1737s/iter; left time: 3452.4760s
	iters: 1000, epoch: 1 | loss: 0.5039430
	speed: 0.1637s/iter; left time: 3238.1050s
Epoch: 1 cost time: 177.40891194343567
Epoch: 1, Steps: 1039 | Train Loss: 0.5617816 Vali Loss: 0.8953651 Test Loss: 0.4834792
Validation loss decreased (inf --> 0.895365).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4782898
	speed: 0.1728s/iter; left time: 3394.7591s
	iters: 200, epoch: 2 | loss: 0.4112955
	speed: 0.1704s/iter; left time: 3329.6178s
	iters: 300, epoch: 2 | loss: 0.4716308
	speed: 0.1600s/iter; left time: 3111.6873s
	iters: 400, epoch: 2 | loss: 0.4052095
	speed: 0.1786s/iter; left time: 3454.9250s
	iters: 500, epoch: 2 | loss: 0.4395387
	speed: 0.1913s/iter; left time: 3680.7189s
	iters: 600, epoch: 2 | loss: 0.4674892
	speed: 0.1657s/iter; left time: 3172.2537s
	iters: 700, epoch: 2 | loss: 0.4763989
	speed: 0.1798s/iter; left time: 3424.2122s
	iters: 800, epoch: 2 | loss: 0.3481167
	speed: 0.1891s/iter; left time: 3581.5041s
	iters: 900, epoch: 2 | loss: 0.3711904
	speed: 0.1600s/iter; left time: 3015.1929s
	iters: 1000, epoch: 2 | loss: 0.3646727
	speed: 0.1607s/iter; left time: 3010.9758s
Epoch: 2 cost time: 178.9683837890625
Epoch: 2, Steps: 1039 | Train Loss: 0.4246447 Vali Loss: 0.9069540 Test Loss: 0.4956980
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.3636114
	speed: 0.1871s/iter; left time: 3480.7598s
	iters: 200, epoch: 3 | loss: 0.3673655
	speed: 0.1875s/iter; left time: 3470.1596s
	iters: 300, epoch: 3 | loss: 0.3806079
	speed: 0.1712s/iter; left time: 3150.1942s
	iters: 400, epoch: 3 | loss: 0.3565362
	speed: 0.1838s/iter; left time: 3364.3883s
	iters: 500, epoch: 3 | loss: 0.4512812
	speed: 0.1906s/iter; left time: 3469.8111s
	iters: 600, epoch: 3 | loss: 0.4264535
	speed: 0.1791s/iter; left time: 3241.4775s
	iters: 700, epoch: 3 | loss: 0.4273103
	speed: 0.1782s/iter; left time: 3208.4851s
	iters: 800, epoch: 3 | loss: 0.3633474
	speed: 0.1683s/iter; left time: 3013.4547s
	iters: 900, epoch: 3 | loss: 0.4297785
	speed: 0.1806s/iter; left time: 3214.6943s
	iters: 1000, epoch: 3 | loss: 0.4046564
	speed: 0.1818s/iter; left time: 3218.6405s
Epoch: 3 cost time: 187.91634583473206
Epoch: 3, Steps: 1039 | Train Loss: 0.3904350 Vali Loss: 0.9176269 Test Loss: 0.5135077
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.3933881
	speed: 0.1992s/iter; left time: 3498.1369s
	iters: 200, epoch: 4 | loss: 0.4006531
	speed: 0.1956s/iter; left time: 3415.7310s
	iters: 300, epoch: 4 | loss: 0.4420668
	speed: 0.1861s/iter; left time: 3231.3572s
	iters: 400, epoch: 4 | loss: 0.4079169
	speed: 0.1899s/iter; left time: 3278.5058s
	iters: 500, epoch: 4 | loss: 0.3651592
	speed: 0.2005s/iter; left time: 3440.9859s
	iters: 600, epoch: 4 | loss: 0.4018429
	speed: 0.2071s/iter; left time: 3534.6828s
	iters: 700, epoch: 4 | loss: 0.4064968
	speed: 0.2011s/iter; left time: 3411.6108s
	iters: 800, epoch: 4 | loss: 0.3775589
	speed: 0.1992s/iter; left time: 3359.7568s
	iters: 900, epoch: 4 | loss: 0.3327833
	speed: 0.2059s/iter; left time: 3452.3180s
	iters: 1000, epoch: 4 | loss: 0.3467889
	speed: 0.2042s/iter; left time: 3402.9747s
Epoch: 4 cost time: 206.70475459098816
Epoch: 4, Steps: 1039 | Train Loss: 0.3789549 Vali Loss: 0.9475219 Test Loss: 0.5505618
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10849
mse:0.48336395621299744, mae:0.4789232611656189
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33217
val 10849
test 10849
	iters: 100, epoch: 1 | loss: 0.7050905
	speed: 0.1997s/iter; left time: 4129.1737s
	iters: 200, epoch: 1 | loss: 0.6944923
	speed: 0.2082s/iter; left time: 4285.7203s
	iters: 300, epoch: 1 | loss: 0.5481344
	speed: 0.1963s/iter; left time: 4021.0248s
	iters: 400, epoch: 1 | loss: 0.4892406
	speed: 0.1946s/iter; left time: 3965.2396s
	iters: 500, epoch: 1 | loss: 0.5900863
	speed: 0.1973s/iter; left time: 4001.9924s
	iters: 600, epoch: 1 | loss: 0.4793272
	speed: 0.1928s/iter; left time: 3889.9814s
	iters: 700, epoch: 1 | loss: 0.4402259
	speed: 0.1987s/iter; left time: 3990.7349s
	iters: 800, epoch: 1 | loss: 0.4394098
	speed: 0.1938s/iter; left time: 3872.7485s
	iters: 900, epoch: 1 | loss: 0.4939910
	speed: 0.1921s/iter; left time: 3819.5194s
	iters: 1000, epoch: 1 | loss: 0.4145021
	speed: 0.1994s/iter; left time: 3944.0019s
Epoch: 1 cost time: 205.2911822795868
Epoch: 1, Steps: 1039 | Train Loss: 0.5635424 Vali Loss: 0.8961061 Test Loss: 0.4708733
Validation loss decreased (inf --> 0.896106).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3914245
	speed: 0.2060s/iter; left time: 4046.0382s
	iters: 200, epoch: 2 | loss: 0.4527522
	speed: 0.2103s/iter; left time: 4110.5827s
	iters: 300, epoch: 2 | loss: 0.4541431
	speed: 0.2243s/iter; left time: 4360.2889s
	iters: 400, epoch: 2 | loss: 0.4145744
	speed: 0.2086s/iter; left time: 4034.8042s
	iters: 500, epoch: 2 | loss: 0.4438937
	speed: 0.2230s/iter; left time: 4290.2252s
	iters: 600, epoch: 2 | loss: 0.4510706
	speed: 0.2039s/iter; left time: 3902.4529s
	iters: 700, epoch: 2 | loss: 0.4479735
	speed: 0.1871s/iter; left time: 3562.9981s
	iters: 800, epoch: 2 | loss: 0.3681763
	speed: 0.1924s/iter; left time: 3645.0521s
	iters: 900, epoch: 2 | loss: 0.3689275
	speed: 0.2065s/iter; left time: 3891.2815s
	iters: 1000, epoch: 2 | loss: 0.3723620
	speed: 0.2128s/iter; left time: 3989.1077s
Epoch: 2 cost time: 215.29108214378357
Epoch: 2, Steps: 1039 | Train Loss: 0.4235802 Vali Loss: 0.9131563 Test Loss: 0.4922072
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.3865025
	speed: 0.2192s/iter; left time: 4076.9539s
	iters: 200, epoch: 3 | loss: 0.3564987
	speed: 0.2239s/iter; left time: 4143.1742s
	iters: 300, epoch: 3 | loss: 0.3792618
	speed: 0.2077s/iter; left time: 3822.5083s
	iters: 400, epoch: 3 | loss: 0.3616104
	speed: 0.2260s/iter; left time: 4136.5787s
	iters: 500, epoch: 3 | loss: 0.3902992
	speed: 0.1963s/iter; left time: 3573.8964s
	iters: 600, epoch: 3 | loss: 0.4055980
	speed: 0.2029s/iter; left time: 3672.4214s
	iters: 700, epoch: 3 | loss: 0.3601409
	speed: 0.2278s/iter; left time: 4101.4032s
	iters: 800, epoch: 3 | loss: 0.4374017
	speed: 0.2113s/iter; left time: 3782.5237s
	iters: 900, epoch: 3 | loss: 0.4287735
	speed: 0.2152s/iter; left time: 3831.5854s
	iters: 1000, epoch: 3 | loss: 0.3922020
	speed: 0.2200s/iter; left time: 3894.4295s
Epoch: 3 cost time: 224.31546330451965
Epoch: 3, Steps: 1039 | Train Loss: 0.3924116 Vali Loss: 0.8869618 Test Loss: 0.4981026
Validation loss decreased (0.896106 --> 0.886962).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3655832
	speed: 0.2200s/iter; left time: 3864.0045s
	iters: 200, epoch: 4 | loss: 0.4217281
	speed: 0.2128s/iter; left time: 3716.4677s
	iters: 300, epoch: 4 | loss: 0.3545206
	speed: 0.2232s/iter; left time: 3874.9892s
	iters: 400, epoch: 4 | loss: 0.3606441
	speed: 0.2204s/iter; left time: 3804.3352s
	iters: 500, epoch: 4 | loss: 0.3369999
	speed: 0.2265s/iter; left time: 3888.2569s
	iters: 600, epoch: 4 | loss: 0.4052817
	speed: 0.2276s/iter; left time: 3883.4528s
	iters: 700, epoch: 4 | loss: 0.3663244
	speed: 0.2272s/iter; left time: 3854.6755s
	iters: 800, epoch: 4 | loss: 0.3399712
	speed: 0.2402s/iter; left time: 4050.9196s
	iters: 900, epoch: 4 | loss: 0.3626890
	speed: 0.2247s/iter; left time: 3767.3993s
	iters: 1000, epoch: 4 | loss: 0.3742831
	speed: 0.2196s/iter; left time: 3659.1722s
Epoch: 4 cost time: 232.8572130203247
Epoch: 4, Steps: 1039 | Train Loss: 0.3815781 Vali Loss: 0.9394946 Test Loss: 0.6037691
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.3886921
	speed: 0.1945s/iter; left time: 3213.7153s
	iters: 200, epoch: 5 | loss: 0.3439323
	speed: 0.2176s/iter; left time: 3574.6185s
	iters: 300, epoch: 5 | loss: 0.4001436
	speed: 0.2104s/iter; left time: 3435.4214s
	iters: 400, epoch: 5 | loss: 0.3619586
	speed: 0.1972s/iter; left time: 3198.8202s
	iters: 500, epoch: 5 | loss: 0.3568351
	speed: 0.2043s/iter; left time: 3294.7844s
	iters: 600, epoch: 5 | loss: 0.3743045
	speed: 0.2207s/iter; left time: 3537.0463s
	iters: 700, epoch: 5 | loss: 0.3962412
	speed: 0.2090s/iter; left time: 3327.7843s
	iters: 800, epoch: 5 | loss: 0.3841037
	speed: 0.2244s/iter; left time: 3551.5109s
	iters: 900, epoch: 5 | loss: 0.3736610
	speed: 0.2088s/iter; left time: 3283.9349s
	iters: 1000, epoch: 5 | loss: 0.3206523
	speed: 0.2151s/iter; left time: 3361.3165s
Epoch: 5 cost time: 218.55105710029602
Epoch: 5, Steps: 1039 | Train Loss: 0.3687379 Vali Loss: 0.9228290 Test Loss: 0.5346970
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.3381763
	speed: 0.2118s/iter; left time: 3279.3184s
	iters: 200, epoch: 6 | loss: 0.3182804
	speed: 0.1912s/iter; left time: 2941.5203s
	iters: 300, epoch: 6 | loss: 0.3321494
	speed: 0.2052s/iter; left time: 3135.9937s
	iters: 400, epoch: 6 | loss: 0.3755554
	speed: 0.2063s/iter; left time: 3133.3500s
	iters: 500, epoch: 6 | loss: 0.3366207
	speed: 0.2050s/iter; left time: 3093.2459s
	iters: 600, epoch: 6 | loss: 0.3592984
	speed: 0.2100s/iter; left time: 3146.8160s
	iters: 700, epoch: 6 | loss: 0.3727687
	speed: 0.2100s/iter; left time: 3126.3755s
	iters: 800, epoch: 6 | loss: 0.3885928
	speed: 0.2136s/iter; left time: 3158.0827s
	iters: 900, epoch: 6 | loss: 0.3820008
	speed: 0.2096s/iter; left time: 3077.7841s
	iters: 1000, epoch: 6 | loss: 0.3354244
	speed: 0.2075s/iter; left time: 3025.9801s
Epoch: 6 cost time: 214.67259740829468
Epoch: 6, Steps: 1039 | Train Loss: 0.3628870 Vali Loss: 0.9671716 Test Loss: 0.5479559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10849
mse:0.49800124764442444, mae:0.49249106645584106
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33217
val 10849
test 10849
	iters: 100, epoch: 1 | loss: 0.7295509
	speed: 0.2301s/iter; left time: 4757.7567s
	iters: 200, epoch: 1 | loss: 0.6282398
	speed: 0.2075s/iter; left time: 4271.2083s
	iters: 300, epoch: 1 | loss: 0.5019265
	speed: 0.2131s/iter; left time: 4364.9775s
	iters: 400, epoch: 1 | loss: 0.5649165
	speed: 0.2051s/iter; left time: 4180.3627s
	iters: 500, epoch: 1 | loss: 0.5371192
	speed: 0.2146s/iter; left time: 4352.9962s
	iters: 600, epoch: 1 | loss: 0.4469225
	speed: 0.2140s/iter; left time: 4317.9498s
	iters: 700, epoch: 1 | loss: 0.4861365
	speed: 0.2025s/iter; left time: 4066.3082s
	iters: 800, epoch: 1 | loss: 0.4530568
	speed: 0.1957s/iter; left time: 3910.6854s
	iters: 900, epoch: 1 | loss: 0.4183471
	speed: 0.1956s/iter; left time: 3888.0891s
	iters: 1000, epoch: 1 | loss: 0.4701693
	speed: 0.2066s/iter; left time: 4086.3228s
Epoch: 1 cost time: 216.24386835098267
Epoch: 1, Steps: 1039 | Train Loss: 0.5622669 Vali Loss: 0.9602360 Test Loss: 0.4842433
Validation loss decreased (inf --> 0.960236).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4915129
	speed: 0.2129s/iter; left time: 4182.6275s
	iters: 200, epoch: 2 | loss: 0.4019618
	speed: 0.2071s/iter; left time: 4047.9268s
	iters: 300, epoch: 2 | loss: 0.4685644
	speed: 0.2117s/iter; left time: 4116.0349s
	iters: 400, epoch: 2 | loss: 0.3885551
	speed: 0.1876s/iter; left time: 3628.8185s
	iters: 500, epoch: 2 | loss: 0.4113757
	speed: 0.2105s/iter; left time: 4050.0887s
	iters: 600, epoch: 2 | loss: 0.3395179
	speed: 0.2038s/iter; left time: 3901.5650s
	iters: 700, epoch: 2 | loss: 0.3912349
	speed: 0.2111s/iter; left time: 4019.4307s
	iters: 800, epoch: 2 | loss: 0.4403181
	speed: 0.2145s/iter; left time: 4062.3043s
	iters: 900, epoch: 2 | loss: 0.4617403
	speed: 0.1970s/iter; left time: 3711.9239s
	iters: 1000, epoch: 2 | loss: 0.3938647
	speed: 0.2095s/iter; left time: 3926.1515s
Epoch: 2 cost time: 215.66372299194336
Epoch: 2, Steps: 1039 | Train Loss: 0.4268703 Vali Loss: 0.8848109 Test Loss: 0.5929482
Validation loss decreased (0.960236 --> 0.884811).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.3769023
	speed: 0.1995s/iter; left time: 3711.7380s
	iters: 200, epoch: 3 | loss: 0.3832842
	speed: 0.1947s/iter; left time: 3603.0078s
	iters: 300, epoch: 3 | loss: 0.3969741
	speed: 0.2059s/iter; left time: 3789.7111s
	iters: 400, epoch: 3 | loss: 0.3471735
	speed: 0.2137s/iter; left time: 3910.9484s
	iters: 500, epoch: 3 | loss: 0.3503138
	speed: 0.1995s/iter; left time: 3631.9070s
	iters: 600, epoch: 3 | loss: 0.3972602
	speed: 0.2043s/iter; left time: 3698.0839s
	iters: 700, epoch: 3 | loss: 0.4267402
	speed: 0.1958s/iter; left time: 3525.6423s
	iters: 800, epoch: 3 | loss: 0.4099761
	speed: 0.1935s/iter; left time: 3464.7200s
	iters: 900, epoch: 3 | loss: 0.3505296
	speed: 0.2024s/iter; left time: 3604.1396s
	iters: 1000, epoch: 3 | loss: 0.3585292
	speed: 0.1971s/iter; left time: 3489.4467s
Epoch: 3 cost time: 208.8096730709076
Epoch: 3, Steps: 1039 | Train Loss: 0.3917157 Vali Loss: 0.9340534 Test Loss: 0.5411297
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.3862327
	speed: 0.2214s/iter; left time: 3887.8381s
	iters: 200, epoch: 4 | loss: 0.3963147
	speed: 0.1921s/iter; left time: 3354.4341s
	iters: 300, epoch: 4 | loss: 0.3884531
	speed: 0.2029s/iter; left time: 3522.6577s
	iters: 400, epoch: 4 | loss: 0.3160309
	speed: 0.2063s/iter; left time: 3562.0278s
	iters: 500, epoch: 4 | loss: 0.3421333
	speed: 0.2088s/iter; left time: 3583.3657s
	iters: 600, epoch: 4 | loss: 0.3782771
	speed: 0.2129s/iter; left time: 3632.9331s
	iters: 700, epoch: 4 | loss: 0.3099426
	speed: 0.2104s/iter; left time: 3569.8050s
	iters: 800, epoch: 4 | loss: 0.3347448
	speed: 0.2072s/iter; left time: 3493.5395s
	iters: 900, epoch: 4 | loss: 0.4025027
	speed: 0.1939s/iter; left time: 3250.1150s
	iters: 1000, epoch: 4 | loss: 0.3900736
	speed: 0.1983s/iter; left time: 3304.7949s
Epoch: 4 cost time: 213.43561339378357
Epoch: 4, Steps: 1039 | Train Loss: 0.3778041 Vali Loss: 0.9984455 Test Loss: 0.5707716
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.3414870
	speed: 0.2096s/iter; left time: 3463.3109s
	iters: 200, epoch: 5 | loss: 0.3306185
	speed: 0.2084s/iter; left time: 3422.5978s
	iters: 300, epoch: 5 | loss: 0.3788821
	speed: 0.2063s/iter; left time: 3367.1744s
	iters: 400, epoch: 5 | loss: 0.3492563
	speed: 0.2098s/iter; left time: 3403.8372s
	iters: 500, epoch: 5 | loss: 0.3390911
	speed: 0.2077s/iter; left time: 3348.9159s
	iters: 600, epoch: 5 | loss: 0.3940247
	speed: 0.2195s/iter; left time: 3516.9146s
	iters: 700, epoch: 5 | loss: 0.3778428
	speed: 0.2266s/iter; left time: 3608.1484s
	iters: 800, epoch: 5 | loss: 0.3680995
	speed: 0.2164s/iter; left time: 3425.0290s
	iters: 900, epoch: 5 | loss: 0.3588749
	speed: 0.2050s/iter; left time: 3223.9730s
	iters: 1000, epoch: 5 | loss: 0.3395063
	speed: 0.2025s/iter; left time: 3164.1861s
Epoch: 5 cost time: 219.23705887794495
Epoch: 5, Steps: 1039 | Train Loss: 0.3638914 Vali Loss: 0.9915019 Test Loss: 0.5921915
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10849
mse:0.5929199457168579, mae:0.5676125288009644
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33217
val 10849
test 10849
	iters: 100, epoch: 1 | loss: 0.7330052
	speed: 0.2161s/iter; left time: 4468.7839s
	iters: 200, epoch: 1 | loss: 0.5634822
	speed: 0.2072s/iter; left time: 4263.4082s
	iters: 300, epoch: 1 | loss: 0.5529353
	speed: 0.2124s/iter; left time: 4350.8650s
	iters: 400, epoch: 1 | loss: 0.5209705
	speed: 0.2214s/iter; left time: 4511.6939s
	iters: 500, epoch: 1 | loss: 0.4981458
	speed: 0.2220s/iter; left time: 4501.5371s
	iters: 600, epoch: 1 | loss: 0.5426248
	speed: 0.2007s/iter; left time: 4051.0938s
	iters: 700, epoch: 1 | loss: 0.4869165
	speed: 0.2126s/iter; left time: 4270.0123s
	iters: 800, epoch: 1 | loss: 0.4739609
	speed: 0.2241s/iter; left time: 4477.9298s
	iters: 900, epoch: 1 | loss: 0.4436182
	speed: 0.2106s/iter; left time: 4186.0744s
	iters: 1000, epoch: 1 | loss: 0.4683473
	speed: 0.2212s/iter; left time: 4376.3950s
Epoch: 1 cost time: 222.9859335422516
Epoch: 1, Steps: 1039 | Train Loss: 0.5665562 Vali Loss: 0.9685323 Test Loss: 0.5759443
Validation loss decreased (inf --> 0.968532).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4837502
	speed: 0.2083s/iter; left time: 4092.3396s
	iters: 200, epoch: 2 | loss: 0.4099200
	speed: 0.2024s/iter; left time: 3954.6547s
	iters: 300, epoch: 2 | loss: 0.4576962
	speed: 0.2175s/iter; left time: 4227.8752s
	iters: 400, epoch: 2 | loss: 0.4368227
	speed: 0.2063s/iter; left time: 3990.5563s
	iters: 500, epoch: 2 | loss: 0.4535329
	speed: 0.2084s/iter; left time: 4009.2516s
	iters: 600, epoch: 2 | loss: 0.4324931
	speed: 0.2212s/iter; left time: 4235.1473s
	iters: 700, epoch: 2 | loss: 0.4006821
	speed: 0.2160s/iter; left time: 4113.1488s
	iters: 800, epoch: 2 | loss: 0.4092341
	speed: 0.2231s/iter; left time: 4225.2956s
	iters: 900, epoch: 2 | loss: 0.4139581
	speed: 0.2144s/iter; left time: 4038.9596s
	iters: 1000, epoch: 2 | loss: 0.4459922
	speed: 0.2184s/iter; left time: 4092.9174s
Epoch: 2 cost time: 221.8333878517151
Epoch: 2, Steps: 1039 | Train Loss: 0.4308189 Vali Loss: 0.9368030 Test Loss: 0.5796584
Validation loss decreased (0.968532 --> 0.936803).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.3528595
	speed: 0.2144s/iter; left time: 3987.6386s
	iters: 200, epoch: 3 | loss: 0.3987496
	speed: 0.2052s/iter; left time: 3796.9992s
	iters: 300, epoch: 3 | loss: 0.4219019
	speed: 0.2205s/iter; left time: 4057.5886s
	iters: 400, epoch: 3 | loss: 0.4526964
	speed: 0.2055s/iter; left time: 3761.1168s
	iters: 500, epoch: 3 | loss: 0.3816316
	speed: 0.2154s/iter; left time: 3920.3054s
	iters: 600, epoch: 3 | loss: 0.3681500
	speed: 0.2084s/iter; left time: 3773.4140s
	iters: 700, epoch: 3 | loss: 0.3980960
	speed: 0.2175s/iter; left time: 3915.1647s
	iters: 800, epoch: 3 | loss: 0.3762402
	speed: 0.2235s/iter; left time: 4001.1249s
	iters: 900, epoch: 3 | loss: 0.3902719
	speed: 0.2025s/iter; left time: 3605.4771s
	iters: 1000, epoch: 3 | loss: 0.4035821
	speed: 0.2302s/iter; left time: 4074.4559s
Epoch: 3 cost time: 223.16244626045227
Epoch: 3, Steps: 1039 | Train Loss: 0.3943993 Vali Loss: 0.9043447 Test Loss: 0.5565926
Validation loss decreased (0.936803 --> 0.904345).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3952929
	speed: 0.2224s/iter; left time: 3905.7825s
	iters: 200, epoch: 4 | loss: 0.4145623
	speed: 0.2325s/iter; left time: 4061.2177s
	iters: 300, epoch: 4 | loss: 0.3711267
	speed: 0.2014s/iter; left time: 3496.5869s
	iters: 400, epoch: 4 | loss: 0.3870110
	speed: 0.2068s/iter; left time: 3569.9451s
	iters: 500, epoch: 4 | loss: 0.3761348
	speed: 0.1957s/iter; left time: 3358.9652s
	iters: 600, epoch: 4 | loss: 0.3856532
	speed: 0.2058s/iter; left time: 3512.1292s
	iters: 700, epoch: 4 | loss: 0.3925409
	speed: 0.2246s/iter; left time: 3809.9227s
	iters: 800, epoch: 4 | loss: 0.4034621
	speed: 0.2193s/iter; left time: 3698.5150s
	iters: 900, epoch: 4 | loss: 0.4286764
	speed: 0.2190s/iter; left time: 3671.3541s
	iters: 1000, epoch: 4 | loss: 0.3734409
	speed: 0.2160s/iter; left time: 3599.9278s
Epoch: 4 cost time: 222.96071934700012
Epoch: 4, Steps: 1039 | Train Loss: 0.3832180 Vali Loss: 0.9311044 Test Loss: 0.6471743
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.3657025
	speed: 0.2227s/iter; left time: 3679.3491s
	iters: 200, epoch: 5 | loss: 0.4033650
	speed: 0.2254s/iter; left time: 3702.7580s
	iters: 300, epoch: 5 | loss: 0.3865340
	speed: 0.2295s/iter; left time: 3747.0927s
	iters: 400, epoch: 5 | loss: 0.3881003
	speed: 0.2185s/iter; left time: 3545.9090s
	iters: 500, epoch: 5 | loss: 0.3373456
	speed: 0.2173s/iter; left time: 3504.0066s
	iters: 600, epoch: 5 | loss: 0.3404651
	speed: 0.2108s/iter; left time: 3378.4529s
	iters: 700, epoch: 5 | loss: 0.3736126
	speed: 0.2117s/iter; left time: 3371.4060s
	iters: 800, epoch: 5 | loss: 0.3465359
	speed: 0.2075s/iter; left time: 3283.2058s
	iters: 900, epoch: 5 | loss: 0.3698082
	speed: 0.2035s/iter; left time: 3200.3096s
	iters: 1000, epoch: 5 | loss: 0.3620820
	speed: 0.2171s/iter; left time: 3392.3620s
Epoch: 5 cost time: 225.89176297187805
Epoch: 5, Steps: 1039 | Train Loss: 0.3702319 Vali Loss: 0.9512631 Test Loss: 0.5309988
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.3932610
	speed: 0.2127s/iter; left time: 3293.5891s
	iters: 200, epoch: 6 | loss: 0.3747478
	speed: 0.2164s/iter; left time: 3329.4879s
	iters: 300, epoch: 6 | loss: 0.3528914
	speed: 0.2201s/iter; left time: 3364.9571s
	iters: 400, epoch: 6 | loss: 0.3618897
	speed: 0.2052s/iter; left time: 3116.1840s
	iters: 500, epoch: 6 | loss: 0.4307602
	speed: 0.2197s/iter; left time: 3314.3249s
	iters: 600, epoch: 6 | loss: 0.3868990
	speed: 0.2114s/iter; left time: 3167.7924s
	iters: 700, epoch: 6 | loss: 0.3497621
	speed: 0.2121s/iter; left time: 3157.6015s
	iters: 800, epoch: 6 | loss: 0.3020329
	speed: 0.2241s/iter; left time: 3313.4022s
	iters: 900, epoch: 6 | loss: 0.3396138
	speed: 0.2026s/iter; left time: 2975.7283s
	iters: 1000, epoch: 6 | loss: 0.3346053
	speed: 0.1987s/iter; left time: 2898.5910s
Epoch: 6 cost time: 220.44543504714966
Epoch: 6, Steps: 1039 | Train Loss: 0.3648834 Vali Loss: 0.9606276 Test Loss: 0.5747933
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol672_sl12,24,36,48,72,96_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10849
mse:0.5567212104797363, mae:0.5365521907806396
