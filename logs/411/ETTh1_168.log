Args in experiment:
Namespace(data='ETTh1', root_path='./datasets/', data_path='ETTh1.csv', data_split=[8640, 2880, 2880], checkpoints='./checkpoints/', in_len=720, out_len=168, seg_lens='6,12,24,36,48,72', data_dim=7, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.2, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=1e-05, lradj='type1', itr=5, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3')
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7753
val 2713
test 2713
	iters: 100, epoch: 1 | loss: 0.7529244
	speed: 0.2980s/iter; left time: 1418.8625s
	iters: 200, epoch: 1 | loss: 0.5892128
	speed: 0.2628s/iter; left time: 1224.7586s
Epoch: 1 cost time: 67.41636633872986
Epoch: 1, Steps: 243 | Train Loss: 0.7629779 Vali Loss: 1.0483277 Test Loss: 0.5700865
Validation loss decreased (inf --> 1.048328).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4709640
	speed: 0.2689s/iter; left time: 1215.0061s
	iters: 200, epoch: 2 | loss: 0.5257364
	speed: 0.2655s/iter; left time: 1173.0836s
Epoch: 2 cost time: 64.64686965942383
Epoch: 2, Steps: 243 | Train Loss: 0.5127546 Vali Loss: 0.9815387 Test Loss: 0.5029629
Validation loss decreased (1.048328 --> 0.981539).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.4375188
	speed: 0.2664s/iter; left time: 1138.7258s
	iters: 200, epoch: 3 | loss: 0.4961790
	speed: 0.2747s/iter; left time: 1146.8401s
Epoch: 3 cost time: 66.22310400009155
Epoch: 3, Steps: 243 | Train Loss: 0.4533596 Vali Loss: 0.9525755 Test Loss: 0.4633094
Validation loss decreased (0.981539 --> 0.952575).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4424806
	speed: 0.2622s/iter; left time: 1057.0712s
	iters: 200, epoch: 4 | loss: 0.4510056
	speed: 0.2640s/iter; left time: 1038.0305s
Epoch: 4 cost time: 64.10759019851685
Epoch: 4, Steps: 243 | Train Loss: 0.4363644 Vali Loss: 0.9339943 Test Loss: 0.4592519
Validation loss decreased (0.952575 --> 0.933994).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.4404717
	speed: 0.2517s/iter; left time: 953.7078s
	iters: 200, epoch: 5 | loss: 0.4208156
	speed: 0.2698s/iter; left time: 995.1891s
Epoch: 5 cost time: 62.82460904121399
Epoch: 5, Steps: 243 | Train Loss: 0.4165482 Vali Loss: 0.9305975 Test Loss: 0.4425743
Validation loss decreased (0.933994 --> 0.930597).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4358352
	speed: 0.2576s/iter; left time: 913.4640s
	iters: 200, epoch: 6 | loss: 0.3567984
	speed: 0.2583s/iter; left time: 890.1934s
Epoch: 6 cost time: 62.608059883117676
Epoch: 6, Steps: 243 | Train Loss: 0.4103257 Vali Loss: 0.9206504 Test Loss: 0.4465136
Validation loss decreased (0.930597 --> 0.920650).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.4405758
	speed: 0.2707s/iter; left time: 894.0388s
	iters: 200, epoch: 7 | loss: 0.4194814
	speed: 0.2628s/iter; left time: 841.8378s
Epoch: 7 cost time: 65.26577258110046
Epoch: 7, Steps: 243 | Train Loss: 0.4006243 Vali Loss: 0.9159894 Test Loss: 0.4465967
Validation loss decreased (0.920650 --> 0.915989).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4025670
	speed: 0.2665s/iter; left time: 815.5826s
	iters: 200, epoch: 8 | loss: 0.4230753
	speed: 0.2537s/iter; left time: 751.0933s
Epoch: 8 cost time: 63.08092021942139
Epoch: 8, Steps: 243 | Train Loss: 0.3977128 Vali Loss: 0.9180220 Test Loss: 0.4430614
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.4036845
	speed: 0.2770s/iter; left time: 780.1878s
	iters: 200, epoch: 9 | loss: 0.4278348
	speed: 0.2818s/iter; left time: 765.6508s
Epoch: 9 cost time: 68.22066354751587
Epoch: 9, Steps: 243 | Train Loss: 0.3927701 Vali Loss: 0.9132075 Test Loss: 0.4393072
Validation loss decreased (0.915989 --> 0.913207).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3982956
	speed: 0.2599s/iter; left time: 669.0353s
	iters: 200, epoch: 10 | loss: 0.3899060
	speed: 0.2714s/iter; left time: 671.5464s
Epoch: 10 cost time: 64.7866747379303
Epoch: 10, Steps: 243 | Train Loss: 0.3916260 Vali Loss: 0.9162296 Test Loss: 0.4436523
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.4551193
	speed: 0.2841s/iter; left time: 662.1548s
	iters: 200, epoch: 11 | loss: 0.3757910
	speed: 0.2686s/iter; left time: 599.1478s
Epoch: 11 cost time: 67.27876353263855
Epoch: 11, Steps: 243 | Train Loss: 0.3892500 Vali Loss: 0.9141242 Test Loss: 0.4394209
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 12 | loss: 0.4198849
	speed: 0.2656s/iter; left time: 554.4889s
	iters: 200, epoch: 12 | loss: 0.4260303
	speed: 0.2671s/iter; left time: 531.0759s
Epoch: 12 cost time: 63.770968437194824
Epoch: 12, Steps: 243 | Train Loss: 0.3883776 Vali Loss: 0.9129355 Test Loss: 0.4413818
Validation loss decreased (0.913207 --> 0.912936).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3857038
	speed: 0.2746s/iter; left time: 506.5834s
	iters: 200, epoch: 13 | loss: 0.3748763
	speed: 0.2859s/iter; left time: 498.8320s
Epoch: 13 cost time: 67.41325330734253
Epoch: 13, Steps: 243 | Train Loss: 0.3879271 Vali Loss: 0.9125749 Test Loss: 0.4420949
Validation loss decreased (0.912936 --> 0.912575).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3867373
	speed: 0.2749s/iter; left time: 440.4047s
	iters: 200, epoch: 14 | loss: 0.3526056
	speed: 0.2953s/iter; left time: 443.6091s
Epoch: 14 cost time: 69.85906505584717
Epoch: 14, Steps: 243 | Train Loss: 0.3868384 Vali Loss: 0.9124195 Test Loss: 0.4347346
Validation loss decreased (0.912575 --> 0.912420).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3735593
	speed: 0.3260s/iter; left time: 443.0372s
	iters: 200, epoch: 15 | loss: 0.4114794
	speed: 0.3253s/iter; left time: 409.5598s
Epoch: 15 cost time: 79.26149368286133
Epoch: 15, Steps: 243 | Train Loss: 0.3862269 Vali Loss: 0.9128905 Test Loss: 0.4380727
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 16 | loss: 0.3627352
	speed: 0.2603s/iter; left time: 290.5098s
	iters: 200, epoch: 16 | loss: 0.4160965
	speed: 0.2887s/iter; left time: 293.2790s
Epoch: 16 cost time: 66.6740710735321
Epoch: 16, Steps: 243 | Train Loss: 0.3852963 Vali Loss: 0.9102775 Test Loss: 0.4330492
Validation loss decreased (0.912420 --> 0.910277).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.3420040
	speed: 0.3340s/iter; left time: 291.5829s
	iters: 200, epoch: 17 | loss: 0.3624033
	speed: 0.3328s/iter; left time: 257.2911s
Epoch: 17 cost time: 80.90224075317383
Epoch: 17, Steps: 243 | Train Loss: 0.3847520 Vali Loss: 0.9107107 Test Loss: 0.4347976
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 18 | loss: 0.3976637
	speed: 0.2829s/iter; left time: 178.2086s
	iters: 200, epoch: 18 | loss: 0.3983998
	speed: 0.2893s/iter; left time: 153.3170s
Epoch: 18 cost time: 69.60373449325562
Epoch: 18, Steps: 243 | Train Loss: 0.3839228 Vali Loss: 0.9118138 Test Loss: 0.4381582
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 19 | loss: 0.3783942
	speed: 0.3036s/iter; left time: 117.4978s
	iters: 200, epoch: 19 | loss: 0.3448557
	speed: 0.3198s/iter; left time: 91.7966s
Epoch: 19 cost time: 76.1198742389679
Epoch: 19, Steps: 243 | Train Loss: 0.3830116 Vali Loss: 0.9087235 Test Loss: 0.4361443
Validation loss decreased (0.910277 --> 0.908724).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.3795800
	speed: 0.2951s/iter; left time: 42.4886s
	iters: 200, epoch: 20 | loss: 0.3595597
	speed: 0.2658s/iter; left time: 11.6963s
Epoch: 20 cost time: 67.88519096374512
Epoch: 20, Steps: 243 | Train Loss: 0.3825598 Vali Loss: 0.9102048 Test Loss: 0.4389330
EarlyStopping counter: 1 out of 3
>>>>>>>testing : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2713
mse:0.4360980987548828, mae:0.4531155824661255
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7753
val 2713
test 2713
	iters: 100, epoch: 1 | loss: 0.6433672
	speed: 0.3049s/iter; left time: 1451.7642s
	iters: 200, epoch: 1 | loss: 0.5074946
	speed: 0.3373s/iter; left time: 1572.0835s
Epoch: 1 cost time: 78.22370290756226
Epoch: 1, Steps: 243 | Train Loss: 0.7599016 Vali Loss: 1.0362547 Test Loss: 0.5664641
Validation loss decreased (inf --> 1.036255).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4900269
	speed: 0.2730s/iter; left time: 1233.3854s
	iters: 200, epoch: 2 | loss: 0.5065129
	speed: 0.2614s/iter; left time: 1154.9322s
Epoch: 2 cost time: 65.06638288497925
Epoch: 2, Steps: 243 | Train Loss: 0.5113680 Vali Loss: 0.9680156 Test Loss: 0.5116048
Validation loss decreased (1.036255 --> 0.968016).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.4739738
	speed: 0.3042s/iter; left time: 1300.2575s
	iters: 200, epoch: 3 | loss: 0.4079228
	speed: 0.3175s/iter; left time: 1325.7050s
Epoch: 3 cost time: 75.77614307403564
Epoch: 3, Steps: 243 | Train Loss: 0.4509751 Vali Loss: 0.9421302 Test Loss: 0.4621611
Validation loss decreased (0.968016 --> 0.942130).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4356905
	speed: 0.2716s/iter; left time: 1095.0024s
	iters: 200, epoch: 4 | loss: 0.4286896
	speed: 0.2768s/iter; left time: 1088.4918s
Epoch: 4 cost time: 66.96586799621582
Epoch: 4, Steps: 243 | Train Loss: 0.4343149 Vali Loss: 0.9330764 Test Loss: 0.4583678
Validation loss decreased (0.942130 --> 0.933076).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.4003076
	speed: 0.3152s/iter; left time: 1194.1975s
	iters: 200, epoch: 5 | loss: 0.4023984
	speed: 0.3348s/iter; left time: 1234.9681s
Epoch: 5 cost time: 79.42797899246216
Epoch: 5, Steps: 243 | Train Loss: 0.4140560 Vali Loss: 0.9213676 Test Loss: 0.4518522
Validation loss decreased (0.933076 --> 0.921368).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4862001
	speed: 0.2801s/iter; left time: 993.1690s
	iters: 200, epoch: 6 | loss: 0.4276304
	speed: 0.2772s/iter; left time: 955.3564s
Epoch: 6 cost time: 66.79030704498291
Epoch: 6, Steps: 243 | Train Loss: 0.4082107 Vali Loss: 0.9191319 Test Loss: 0.4484731
Validation loss decreased (0.921368 --> 0.919132).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.3643239
	speed: 0.2925s/iter; left time: 966.2231s
	iters: 200, epoch: 7 | loss: 0.3402176
	speed: 0.3304s/iter; left time: 1058.2844s
Epoch: 7 cost time: 76.81971216201782
Epoch: 7, Steps: 243 | Train Loss: 0.3985147 Vali Loss: 0.9152559 Test Loss: 0.4409084
Validation loss decreased (0.919132 --> 0.915256).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4330918
	speed: 0.2939s/iter; left time: 899.1970s
	iters: 200, epoch: 8 | loss: 0.4040072
	speed: 0.3039s/iter; left time: 899.5564s
Epoch: 8 cost time: 73.14438462257385
Epoch: 8, Steps: 243 | Train Loss: 0.3959519 Vali Loss: 0.9151184 Test Loss: 0.4464867
Validation loss decreased (0.915256 --> 0.915118).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.3935939
	speed: 0.2827s/iter; left time: 796.3101s
	iters: 200, epoch: 9 | loss: 0.3656547
	speed: 0.3059s/iter; left time: 831.1760s
Epoch: 9 cost time: 72.75110149383545
Epoch: 9, Steps: 243 | Train Loss: 0.3908075 Vali Loss: 0.9091928 Test Loss: 0.4381764
Validation loss decreased (0.915118 --> 0.909193).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3613842
	speed: 0.2851s/iter; left time: 733.9538s
	iters: 200, epoch: 10 | loss: 0.3726810
	speed: 0.2882s/iter; left time: 713.1183s
Epoch: 10 cost time: 69.45296597480774
Epoch: 10, Steps: 243 | Train Loss: 0.3897157 Vali Loss: 0.9116732 Test Loss: 0.4399604
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.3962117
	speed: 0.2910s/iter; left time: 678.2232s
	iters: 200, epoch: 11 | loss: 0.3880296
	speed: 0.2924s/iter; left time: 652.3602s
Epoch: 11 cost time: 71.10158085823059
Epoch: 11, Steps: 243 | Train Loss: 0.3872816 Vali Loss: 0.9070068 Test Loss: 0.4384672
Validation loss decreased (0.909193 --> 0.907007).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4461267
	speed: 0.2908s/iter; left time: 607.2500s
	iters: 200, epoch: 12 | loss: 0.4060720
	speed: 0.2982s/iter; left time: 592.9112s
Epoch: 12 cost time: 71.10689282417297
Epoch: 12, Steps: 243 | Train Loss: 0.3863087 Vali Loss: 0.9071170 Test Loss: 0.4357718
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 13 | loss: 0.3646353
	speed: 0.2895s/iter; left time: 534.1836s
	iters: 200, epoch: 13 | loss: 0.3860447
	speed: 0.2954s/iter; left time: 515.3921s
Epoch: 13 cost time: 71.31154823303223
Epoch: 13, Steps: 243 | Train Loss: 0.3856610 Vali Loss: 0.9057436 Test Loss: 0.4349389
Validation loss decreased (0.907007 --> 0.905744).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.3805431
	speed: 0.2955s/iter; left time: 473.4227s
	iters: 200, epoch: 14 | loss: 0.3646179
	speed: 0.2939s/iter; left time: 441.3651s
Epoch: 14 cost time: 72.1528787612915
Epoch: 14, Steps: 243 | Train Loss: 0.3851639 Vali Loss: 0.9064292 Test Loss: 0.4379639
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 15 | loss: 0.3817617
	speed: 0.3157s/iter; left time: 429.0897s
	iters: 200, epoch: 15 | loss: 0.3975581
	speed: 0.3004s/iter; left time: 378.1941s
Epoch: 15 cost time: 73.96146845817566
Epoch: 15, Steps: 243 | Train Loss: 0.3841857 Vali Loss: 0.9045874 Test Loss: 0.4359673
Validation loss decreased (0.905744 --> 0.904587).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3686995
	speed: 0.3054s/iter; left time: 340.7858s
	iters: 200, epoch: 16 | loss: 0.3747371
	speed: 0.2981s/iter; left time: 302.8966s
Epoch: 16 cost time: 72.72215437889099
Epoch: 16, Steps: 243 | Train Loss: 0.3836300 Vali Loss: 0.9087932 Test Loss: 0.4400134
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 17 | loss: 0.4170155
	speed: 0.3180s/iter; left time: 277.6377s
	iters: 200, epoch: 17 | loss: 0.3620115
	speed: 0.3186s/iter; left time: 246.3085s
Epoch: 17 cost time: 75.99812459945679
Epoch: 17, Steps: 243 | Train Loss: 0.3828005 Vali Loss: 0.9079711 Test Loss: 0.4362444
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 18 | loss: 0.3852313
	speed: 0.2791s/iter; left time: 175.8234s
	iters: 200, epoch: 18 | loss: 0.3945525
	speed: 0.2901s/iter; left time: 153.7546s
Epoch: 18 cost time: 70.30055260658264
Epoch: 18, Steps: 243 | Train Loss: 0.3819743 Vali Loss: 0.9070472 Test Loss: 0.4367524
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2713
mse:0.4359135925769806, mae:0.45311450958251953
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7753
val 2713
test 2713
	iters: 100, epoch: 1 | loss: 0.6742176
	speed: 0.3364s/iter; left time: 1601.7440s
	iters: 200, epoch: 1 | loss: 0.5583730
	speed: 0.2947s/iter; left time: 1373.5289s
Epoch: 1 cost time: 75.04050588607788
Epoch: 1, Steps: 243 | Train Loss: 0.7639558 Vali Loss: 1.0506951 Test Loss: 0.5728013
Validation loss decreased (inf --> 1.050695).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5112428
	speed: 0.2611s/iter; left time: 1179.7304s
	iters: 200, epoch: 2 | loss: 0.4403273
	speed: 0.3195s/iter; left time: 1411.7412s
Epoch: 2 cost time: 73.48721694946289
Epoch: 2, Steps: 243 | Train Loss: 0.5129266 Vali Loss: 0.9983152 Test Loss: 0.5479004
Validation loss decreased (1.050695 --> 0.998315).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.4395241
	speed: 0.3283s/iter; left time: 1403.5903s
	iters: 200, epoch: 3 | loss: 0.4449028
	speed: 0.2998s/iter; left time: 1251.4603s
Epoch: 3 cost time: 76.14936304092407
Epoch: 3, Steps: 243 | Train Loss: 0.4533182 Vali Loss: 0.9488766 Test Loss: 0.4639444
Validation loss decreased (0.998315 --> 0.948877).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4839028
	speed: 0.3111s/iter; left time: 1254.5434s
	iters: 200, epoch: 4 | loss: 0.3871076
	speed: 0.3325s/iter; left time: 1307.2820s
Epoch: 4 cost time: 79.42288446426392
Epoch: 4, Steps: 243 | Train Loss: 0.4348427 Vali Loss: 0.9445869 Test Loss: 0.4509890
Validation loss decreased (0.948877 --> 0.944587).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.4658074
	speed: 0.3118s/iter; left time: 1181.2473s
	iters: 200, epoch: 5 | loss: 0.4478689
	speed: 0.3483s/iter; left time: 1284.9229s
Epoch: 5 cost time: 81.63086867332458
Epoch: 5, Steps: 243 | Train Loss: 0.4161032 Vali Loss: 0.9187855 Test Loss: 0.4538094
Validation loss decreased (0.944587 --> 0.918785).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4305734
	speed: 0.2804s/iter; left time: 994.4610s
	iters: 200, epoch: 6 | loss: 0.4009641
	speed: 0.2659s/iter; left time: 916.3516s
Epoch: 6 cost time: 67.30460047721863
Epoch: 6, Steps: 243 | Train Loss: 0.4099314 Vali Loss: 0.9151469 Test Loss: 0.4368781
Validation loss decreased (0.918785 --> 0.915147).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.4535654
	speed: 0.3534s/iter; left time: 1167.3950s
	iters: 200, epoch: 7 | loss: 0.4252941
	speed: 0.3627s/iter; left time: 1161.7693s
Epoch: 7 cost time: 87.05328750610352
Epoch: 7, Steps: 243 | Train Loss: 0.4009931 Vali Loss: 0.9145644 Test Loss: 0.4399153
Validation loss decreased (0.915147 --> 0.914564).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4336139
	speed: 0.2653s/iter; left time: 811.7408s
	iters: 200, epoch: 8 | loss: 0.3786344
	speed: 0.2695s/iter; left time: 797.7884s
Epoch: 8 cost time: 66.17600440979004
Epoch: 8, Steps: 243 | Train Loss: 0.3977316 Vali Loss: 0.9094085 Test Loss: 0.4448968
Validation loss decreased (0.914564 --> 0.909409).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.3657376
	speed: 0.3657s/iter; left time: 1030.2065s
	iters: 200, epoch: 9 | loss: 0.3841049
	speed: 0.3104s/iter; left time: 843.2755s
Epoch: 9 cost time: 79.91334557533264
Epoch: 9, Steps: 243 | Train Loss: 0.3930329 Vali Loss: 0.9159304 Test Loss: 0.4405292
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.3703516
	speed: 0.2726s/iter; left time: 701.7143s
	iters: 200, epoch: 10 | loss: 0.3698123
	speed: 0.2952s/iter; left time: 730.3439s
Epoch: 10 cost time: 68.79619717597961
Epoch: 10, Steps: 243 | Train Loss: 0.3917428 Vali Loss: 0.9112648 Test Loss: 0.4371951
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.4112988
	speed: 0.3103s/iter; left time: 723.2350s
	iters: 200, epoch: 11 | loss: 0.3437867
	speed: 0.3007s/iter; left time: 670.9471s
Epoch: 11 cost time: 74.05026459693909
Epoch: 11, Steps: 243 | Train Loss: 0.3894166 Vali Loss: 0.9092302 Test Loss: 0.4387595
Validation loss decreased (0.909409 --> 0.909230).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3706853
	speed: 0.3140s/iter; left time: 655.6383s
	iters: 200, epoch: 12 | loss: 0.3674751
	speed: 0.2880s/iter; left time: 572.5360s
Epoch: 12 cost time: 73.20207500457764
Epoch: 12, Steps: 243 | Train Loss: 0.3884004 Vali Loss: 0.9081547 Test Loss: 0.4378007
Validation loss decreased (0.909230 --> 0.908155).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4696107
	speed: 0.2946s/iter; left time: 543.4701s
	iters: 200, epoch: 13 | loss: 0.3961164
	speed: 0.3010s/iter; left time: 525.3305s
Epoch: 13 cost time: 72.94243097305298
Epoch: 13, Steps: 243 | Train Loss: 0.3877582 Vali Loss: 0.9130096 Test Loss: 0.4453268
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 14 | loss: 0.4061143
	speed: 0.3455s/iter; left time: 553.4290s
	iters: 200, epoch: 14 | loss: 0.3454859
	speed: 0.2769s/iter; left time: 415.9081s
Epoch: 14 cost time: 73.75413918495178
Epoch: 14, Steps: 243 | Train Loss: 0.3872042 Vali Loss: 0.9141166 Test Loss: 0.4452378
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 15 | loss: 0.4128488
	speed: 0.2991s/iter; left time: 406.4557s
	iters: 200, epoch: 15 | loss: 0.3840096
	speed: 0.3747s/iter; left time: 471.6864s
Epoch: 15 cost time: 83.46297836303711
Epoch: 15, Steps: 243 | Train Loss: 0.3864642 Vali Loss: 0.9068247 Test Loss: 0.4356829
Validation loss decreased (0.908155 --> 0.906825).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3140156
	speed: 0.2948s/iter; left time: 328.9829s
	iters: 200, epoch: 16 | loss: 0.3886527
	speed: 0.2599s/iter; left time: 264.0370s
Epoch: 16 cost time: 66.23543810844421
Epoch: 16, Steps: 243 | Train Loss: 0.3854826 Vali Loss: 0.9082012 Test Loss: 0.4360317
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 17 | loss: 0.3761065
	speed: 0.3513s/iter; left time: 306.7154s
	iters: 200, epoch: 17 | loss: 0.4348735
	speed: 0.3136s/iter; left time: 242.4201s
Epoch: 17 cost time: 79.13276100158691
Epoch: 17, Steps: 243 | Train Loss: 0.3851909 Vali Loss: 0.9075543 Test Loss: 0.4372058
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 18 | loss: 0.3552306
	speed: 0.3326s/iter; left time: 209.5073s
	iters: 200, epoch: 18 | loss: 0.4054613
	speed: 0.3216s/iter; left time: 170.4486s
Epoch: 18 cost time: 78.62296485900879
Epoch: 18, Steps: 243 | Train Loss: 0.3844413 Vali Loss: 0.9042465 Test Loss: 0.4337070
Validation loss decreased (0.906825 --> 0.904246).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4057534
	speed: 0.2688s/iter; left time: 104.0178s
	iters: 200, epoch: 19 | loss: 0.3904646
	speed: 0.3041s/iter; left time: 87.2728s
Epoch: 19 cost time: 72.76242995262146
Epoch: 19, Steps: 243 | Train Loss: 0.3831643 Vali Loss: 0.9092485 Test Loss: 0.4398005
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 20 | loss: 0.3727435
	speed: 0.3336s/iter; left time: 48.0334s
	iters: 200, epoch: 20 | loss: 0.3868041
	speed: 0.3018s/iter; left time: 13.2812s
Epoch: 20 cost time: 76.01597929000854
Epoch: 20, Steps: 243 | Train Loss: 0.3824288 Vali Loss: 0.9046078 Test Loss: 0.4333063
EarlyStopping counter: 2 out of 3
>>>>>>>testing : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2713
mse:0.4336291551589966, mae:0.4517918527126312
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7753
val 2713
test 2713
	iters: 100, epoch: 1 | loss: 0.6878671
	speed: 0.3343s/iter; left time: 1591.4767s
	iters: 200, epoch: 1 | loss: 0.5305242
	speed: 0.3521s/iter; left time: 1641.3191s
Epoch: 1 cost time: 81.23621392250061
Epoch: 1, Steps: 243 | Train Loss: 0.7609829 Vali Loss: 1.0339938 Test Loss: 0.5743976
Validation loss decreased (inf --> 1.033994).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5135798
	speed: 0.2833s/iter; left time: 1280.0490s
	iters: 200, epoch: 2 | loss: 0.4990829
	speed: 0.3228s/iter; left time: 1426.2269s
Epoch: 2 cost time: 74.14866876602173
Epoch: 2, Steps: 243 | Train Loss: 0.5110156 Vali Loss: 0.9674694 Test Loss: 0.5106609
Validation loss decreased (1.033994 --> 0.967469).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.4292639
	speed: 0.2957s/iter; left time: 1264.1853s
	iters: 200, epoch: 3 | loss: 0.4062552
	speed: 0.2949s/iter; left time: 1231.4014s
Epoch: 3 cost time: 71.74611353874207
Epoch: 3, Steps: 243 | Train Loss: 0.4525318 Vali Loss: 0.9446958 Test Loss: 0.4781744
Validation loss decreased (0.967469 --> 0.944696).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4448438
	speed: 0.2973s/iter; left time: 1198.7331s
	iters: 200, epoch: 4 | loss: 0.4056643
	speed: 0.3399s/iter; left time: 1336.6397s
Epoch: 4 cost time: 78.43781781196594
Epoch: 4, Steps: 243 | Train Loss: 0.4343081 Vali Loss: 0.9425676 Test Loss: 0.4608715
Validation loss decreased (0.944696 --> 0.942568).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.3572216
	speed: 0.2546s/iter; left time: 964.8132s
	iters: 200, epoch: 5 | loss: 0.4417774
	speed: 0.2888s/iter; left time: 1065.2676s
Epoch: 5 cost time: 67.10003519058228
Epoch: 5, Steps: 243 | Train Loss: 0.4148186 Vali Loss: 0.9231702 Test Loss: 0.4443017
Validation loss decreased (0.942568 --> 0.923170).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3823242
	speed: 0.3618s/iter; left time: 1282.9348s
	iters: 200, epoch: 6 | loss: 0.4702994
	speed: 0.3230s/iter; left time: 1113.2104s
Epoch: 6 cost time: 81.15616369247437
Epoch: 6, Steps: 243 | Train Loss: 0.4084571 Vali Loss: 0.9178737 Test Loss: 0.4463549
Validation loss decreased (0.923170 --> 0.917874).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.3831225
	speed: 0.2853s/iter; left time: 942.3150s
	iters: 200, epoch: 7 | loss: 0.4417554
	speed: 0.3406s/iter; left time: 1091.0783s
Epoch: 7 cost time: 77.65278053283691
Epoch: 7, Steps: 243 | Train Loss: 0.3996963 Vali Loss: 0.9175821 Test Loss: 0.4485041
Validation loss decreased (0.917874 --> 0.917582).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3919778
	speed: 0.2947s/iter; left time: 901.8900s
	iters: 200, epoch: 8 | loss: 0.3936954
	speed: 0.3193s/iter; left time: 945.0722s
Epoch: 8 cost time: 77.19279313087463
Epoch: 8, Steps: 243 | Train Loss: 0.3966834 Vali Loss: 0.9115920 Test Loss: 0.4366352
Validation loss decreased (0.917582 --> 0.911592).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.4544141
	speed: 0.2720s/iter; left time: 766.1519s
	iters: 200, epoch: 9 | loss: 0.3900737
	speed: 0.2624s/iter; left time: 712.9286s
Epoch: 9 cost time: 65.6820297241211
Epoch: 9, Steps: 243 | Train Loss: 0.3920119 Vali Loss: 0.9087533 Test Loss: 0.4370905
Validation loss decreased (0.911592 --> 0.908753).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4010172
	speed: 0.3409s/iter; left time: 877.5547s
	iters: 200, epoch: 10 | loss: 0.4098443
	speed: 0.3577s/iter; left time: 885.0574s
Epoch: 10 cost time: 85.77261662483215
Epoch: 10, Steps: 243 | Train Loss: 0.3907470 Vali Loss: 0.9135735 Test Loss: 0.4468861
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.3940859
	speed: 0.2483s/iter; left time: 578.7388s
	iters: 200, epoch: 11 | loss: 0.3687992
	speed: 0.2584s/iter; left time: 576.4891s
Epoch: 11 cost time: 61.453667640686035
Epoch: 11, Steps: 243 | Train Loss: 0.3881620 Vali Loss: 0.9109492 Test Loss: 0.4419920
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 12 | loss: 0.4071510
	speed: 0.3555s/iter; left time: 742.3880s
	iters: 200, epoch: 12 | loss: 0.4198661
	speed: 0.3161s/iter; left time: 628.3900s
Epoch: 12 cost time: 79.73290991783142
Epoch: 12, Steps: 243 | Train Loss: 0.3873853 Vali Loss: 0.9100693 Test Loss: 0.4364076
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2713
mse:0.4370447099208832, mae:0.45331239700317383
Use GPU: cuda:1
>>>>>>>start training : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7753
val 2713
test 2713
	iters: 100, epoch: 1 | loss: 0.6829397
	speed: 0.3015s/iter; left time: 1435.5372s
	iters: 200, epoch: 1 | loss: 0.5412660
	speed: 0.2961s/iter; left time: 1380.0332s
Epoch: 1 cost time: 71.9365246295929
Epoch: 1, Steps: 243 | Train Loss: 0.7702637 Vali Loss: 1.0597398 Test Loss: 0.5563277
Validation loss decreased (inf --> 1.059740).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5894020
	speed: 0.2946s/iter; left time: 1330.9336s
	iters: 200, epoch: 2 | loss: 0.5303430
	speed: 0.2883s/iter; left time: 1273.7983s
Epoch: 2 cost time: 73.62103724479675
Epoch: 2, Steps: 243 | Train Loss: 0.5152868 Vali Loss: 0.9780872 Test Loss: 0.5004746
Validation loss decreased (1.059740 --> 0.978087).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.4967340
	speed: 0.3228s/iter; left time: 1379.8505s
	iters: 200, epoch: 3 | loss: 0.4491313
	speed: 0.2565s/iter; left time: 1070.7635s
Epoch: 3 cost time: 68.58382081985474
Epoch: 3, Steps: 243 | Train Loss: 0.4537511 Vali Loss: 0.9476741 Test Loss: 0.4650715
Validation loss decreased (0.978087 --> 0.947674).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4461783
	speed: 0.3401s/iter; left time: 1371.4392s
	iters: 200, epoch: 4 | loss: 0.4146304
	speed: 0.3569s/iter; left time: 1403.1825s
Epoch: 4 cost time: 85.27325630187988
Epoch: 4, Steps: 243 | Train Loss: 0.4355154 Vali Loss: 0.9343327 Test Loss: 0.4619210
Validation loss decreased (0.947674 --> 0.934333).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.3922210
	speed: 0.2824s/iter; left time: 1070.1466s
	iters: 200, epoch: 5 | loss: 0.3913809
	speed: 0.2555s/iter; left time: 942.5883s
Epoch: 5 cost time: 64.8181471824646
Epoch: 5, Steps: 243 | Train Loss: 0.4161259 Vali Loss: 0.9186658 Test Loss: 0.4499869
Validation loss decreased (0.934333 --> 0.918666).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4346621
	speed: 0.3547s/iter; left time: 1257.6905s
	iters: 200, epoch: 6 | loss: 0.4386064
	speed: 0.3496s/iter; left time: 1204.8194s
Epoch: 6 cost time: 82.59804606437683
Epoch: 6, Steps: 243 | Train Loss: 0.4093427 Vali Loss: 0.9196888 Test Loss: 0.4479351
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.3805265
	speed: 0.2854s/iter; left time: 942.8406s
	iters: 200, epoch: 7 | loss: 0.4695699
	speed: 0.3017s/iter; left time: 966.2336s
Epoch: 7 cost time: 71.3373155593872
Epoch: 7, Steps: 243 | Train Loss: 0.4001154 Vali Loss: 0.9157222 Test Loss: 0.4447247
Validation loss decreased (0.918666 --> 0.915722).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3622792
	speed: 0.2936s/iter; left time: 898.4742s
	iters: 200, epoch: 8 | loss: 0.3433058
	speed: 0.2979s/iter; left time: 881.7015s
Epoch: 8 cost time: 71.80214190483093
Epoch: 8, Steps: 243 | Train Loss: 0.3971757 Vali Loss: 0.9118680 Test Loss: 0.4333793
Validation loss decreased (0.915722 --> 0.911868).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.4218687
	speed: 0.3599s/iter; left time: 1013.8194s
	iters: 200, epoch: 9 | loss: 0.3874438
	speed: 0.3133s/iter; left time: 851.1622s
Epoch: 9 cost time: 78.21994805335999
Epoch: 9, Steps: 243 | Train Loss: 0.3928923 Vali Loss: 0.9142645 Test Loss: 0.4414961
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.4015650
	speed: 0.2886s/iter; left time: 742.8765s
	iters: 200, epoch: 10 | loss: 0.3642352
	speed: 0.3152s/iter; left time: 779.7757s
Epoch: 10 cost time: 76.66509175300598
Epoch: 10, Steps: 243 | Train Loss: 0.3910352 Vali Loss: 0.9086954 Test Loss: 0.4352727
Validation loss decreased (0.911868 --> 0.908695).  Saving model ...
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.3693110
	speed: 0.3186s/iter; left time: 742.5569s
	iters: 200, epoch: 11 | loss: 0.3496983
	speed: 0.3066s/iter; left time: 683.9896s
Epoch: 11 cost time: 74.00602436065674
Epoch: 11, Steps: 243 | Train Loss: 0.3882455 Vali Loss: 0.9079309 Test Loss: 0.4380381
Validation loss decreased (0.908695 --> 0.907931).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.3682414
	speed: 0.3058s/iter; left time: 638.5266s
	iters: 200, epoch: 12 | loss: 0.3923674
	speed: 0.2574s/iter; left time: 511.6295s
Epoch: 12 cost time: 67.03689408302307
Epoch: 12, Steps: 243 | Train Loss: 0.3880355 Vali Loss: 0.9113390 Test Loss: 0.4406235
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 13 | loss: 0.4616728
	speed: 0.3691s/iter; left time: 681.0165s
	iters: 200, epoch: 13 | loss: 0.4082701
	speed: 0.3861s/iter; left time: 673.7316s
Epoch: 13 cost time: 90.32126092910767
Epoch: 13, Steps: 243 | Train Loss: 0.3872865 Vali Loss: 0.9106439 Test Loss: 0.4426679
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 14 | loss: 0.4053631
	speed: 0.2565s/iter; left time: 410.9381s
	iters: 200, epoch: 14 | loss: 0.4544928
	speed: 0.2965s/iter; left time: 445.3373s
Epoch: 14 cost time: 68.73926663398743
Epoch: 14, Steps: 243 | Train Loss: 0.3862582 Vali Loss: 0.9085632 Test Loss: 0.4396243
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTh1_il720_ol168_sl6,12,24,36,48,72_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2713
mse:0.43799957633018494, mae:0.4554688632488251
