Args in experiment:
Namespace(data='WTH', root_path='./datasets/', data_path='WTH.csv', data_split=[20160, 7200, 7200], checkpoints='./checkpoints/', in_len=48, out_len=48, seg_lens='12,16,24', data_dim=12, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.2, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.0001, lradj='type1', itr=5, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3')
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 20065
val 7153
test 7153
	iters: 100, epoch: 1 | loss: 0.5922778
	speed: 0.0969s/iter; left time: 1207.7478s
	iters: 200, epoch: 1 | loss: 0.5706110
	speed: 0.0532s/iter; left time: 657.4922s
	iters: 300, epoch: 1 | loss: 0.5266284
	speed: 0.0397s/iter; left time: 486.9436s
	iters: 400, epoch: 1 | loss: 0.5431273
	speed: 0.0504s/iter; left time: 613.2496s
	iters: 500, epoch: 1 | loss: 0.5387641
	speed: 0.0461s/iter; left time: 555.6280s
	iters: 600, epoch: 1 | loss: 0.4121532
	speed: 0.0369s/iter; left time: 441.2120s
Epoch: 1 cost time: 33.188210248947144
Epoch: 1, Steps: 628 | Train Loss: 0.5720401 Vali Loss: 0.4161054 Test Loss: 0.4549267
Validation loss decreased (inf --> 0.416105).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5402386
	speed: 0.0415s/iter; left time: 491.4139s
	iters: 200, epoch: 2 | loss: 0.5080593
	speed: 0.0445s/iter; left time: 521.9784s
	iters: 300, epoch: 2 | loss: 0.5086579
	speed: 0.0397s/iter; left time: 461.4033s
	iters: 400, epoch: 2 | loss: 0.5531784
	speed: 0.0469s/iter; left time: 541.1739s
	iters: 500, epoch: 2 | loss: 0.4678687
	speed: 0.0399s/iter; left time: 456.3601s
	iters: 600, epoch: 2 | loss: 0.4466933
	speed: 0.0492s/iter; left time: 557.2035s
Epoch: 2 cost time: 27.699233293533325
Epoch: 2, Steps: 628 | Train Loss: 0.4988928 Vali Loss: 0.4126552 Test Loss: 0.4460396
Validation loss decreased (0.416105 --> 0.412655).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4261393
	speed: 0.0449s/iter; left time: 502.8819s
	iters: 200, epoch: 3 | loss: 0.4837839
	speed: 0.0462s/iter; left time: 513.4446s
	iters: 300, epoch: 3 | loss: 0.5229372
	speed: 0.0435s/iter; left time: 478.8748s
	iters: 400, epoch: 3 | loss: 0.4762461
	speed: 0.0433s/iter; left time: 472.0075s
	iters: 500, epoch: 3 | loss: 0.3944080
	speed: 0.0584s/iter; left time: 631.2882s
	iters: 600, epoch: 3 | loss: 0.5382702
	speed: 0.0465s/iter; left time: 498.1342s
Epoch: 3 cost time: 29.868014574050903
Epoch: 3, Steps: 628 | Train Loss: 0.4779492 Vali Loss: 0.3887972 Test Loss: 0.4352012
Validation loss decreased (0.412655 --> 0.388797).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4019948
	speed: 0.0423s/iter; left time: 447.4274s
	iters: 200, epoch: 4 | loss: 0.4696360
	speed: 0.0515s/iter; left time: 539.7553s
	iters: 300, epoch: 4 | loss: 0.4712736
	speed: 0.0347s/iter; left time: 359.8224s
	iters: 400, epoch: 4 | loss: 0.4339639
	speed: 0.0503s/iter; left time: 516.7392s
	iters: 500, epoch: 4 | loss: 0.4624447
	speed: 0.0444s/iter; left time: 452.2750s
	iters: 600, epoch: 4 | loss: 0.4478526
	speed: 0.0456s/iter; left time: 459.0848s
Epoch: 4 cost time: 28.115472078323364
Epoch: 4, Steps: 628 | Train Loss: 0.4705465 Vali Loss: 0.3903995 Test Loss: 0.4256808
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3926744
	speed: 0.0528s/iter; left time: 525.5003s
	iters: 200, epoch: 5 | loss: 0.4174973
	speed: 0.0495s/iter; left time: 487.8052s
	iters: 300, epoch: 5 | loss: 0.4916631
	speed: 0.0435s/iter; left time: 423.9761s
	iters: 400, epoch: 5 | loss: 0.4675964
	speed: 0.0519s/iter; left time: 500.4368s
	iters: 500, epoch: 5 | loss: 0.5636411
	speed: 0.0545s/iter; left time: 519.9897s
	iters: 600, epoch: 5 | loss: 0.4415659
	speed: 0.0496s/iter; left time: 468.7164s
Epoch: 5 cost time: 31.74179697036743
Epoch: 5, Steps: 628 | Train Loss: 0.4600220 Vali Loss: 0.3792194 Test Loss: 0.4169288
Validation loss decreased (0.388797 --> 0.379219).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6304177
	speed: 0.0406s/iter; left time: 378.5100s
	iters: 200, epoch: 6 | loss: 0.4182320
	speed: 0.0359s/iter; left time: 331.0940s
	iters: 300, epoch: 6 | loss: 0.4444622
	speed: 0.0378s/iter; left time: 345.1187s
	iters: 400, epoch: 6 | loss: 0.4238606
	speed: 0.0480s/iter; left time: 432.7416s
	iters: 500, epoch: 6 | loss: 0.4219647
	speed: 0.0546s/iter; left time: 486.6816s
	iters: 600, epoch: 6 | loss: 0.5294890
	speed: 0.0538s/iter; left time: 474.8967s
Epoch: 6 cost time: 28.84375786781311
Epoch: 6, Steps: 628 | Train Loss: 0.4568798 Vali Loss: 0.3830495 Test Loss: 0.4247533
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.4136398
	speed: 0.0530s/iter; left time: 460.9624s
	iters: 200, epoch: 7 | loss: 0.4451376
	speed: 0.0500s/iter; left time: 429.6184s
	iters: 300, epoch: 7 | loss: 0.4296456
	speed: 0.0519s/iter; left time: 440.9801s
	iters: 400, epoch: 7 | loss: 0.5552342
	speed: 0.0488s/iter; left time: 409.3349s
	iters: 500, epoch: 7 | loss: 0.4377228
	speed: 0.0414s/iter; left time: 343.2842s
	iters: 600, epoch: 7 | loss: 0.4674720
	speed: 0.0471s/iter; left time: 386.1595s
Epoch: 7 cost time: 31.065333127975464
Epoch: 7, Steps: 628 | Train Loss: 0.4532663 Vali Loss: 0.3744833 Test Loss: 0.4155828
Validation loss decreased (0.379219 --> 0.374483).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4699220
	speed: 0.0398s/iter; left time: 320.8283s
	iters: 200, epoch: 8 | loss: 0.4863893
	speed: 0.0466s/iter; left time: 370.9257s
	iters: 300, epoch: 8 | loss: 0.4376904
	speed: 0.0526s/iter; left time: 413.8104s
	iters: 400, epoch: 8 | loss: 0.5045142
	speed: 0.0584s/iter; left time: 453.3519s
	iters: 500, epoch: 8 | loss: 0.4437798
	speed: 0.0443s/iter; left time: 339.4612s
	iters: 600, epoch: 8 | loss: 0.4312574
	speed: 0.0538s/iter; left time: 406.9808s
Epoch: 8 cost time: 30.692745447158813
Epoch: 8, Steps: 628 | Train Loss: 0.4501786 Vali Loss: 0.3722105 Test Loss: 0.4136016
Validation loss decreased (0.374483 --> 0.372210).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 9 | loss: 0.4601335
	speed: 0.0520s/iter; left time: 386.7599s
	iters: 200, epoch: 9 | loss: 0.4118344
	speed: 0.0421s/iter; left time: 309.0436s
	iters: 300, epoch: 9 | loss: 0.4861024
	speed: 0.0442s/iter; left time: 319.6034s
	iters: 400, epoch: 9 | loss: 0.4722810
	speed: 0.0482s/iter; left time: 344.0866s
	iters: 500, epoch: 9 | loss: 0.4203591
	speed: 0.0517s/iter; left time: 363.5044s
	iters: 600, epoch: 9 | loss: 0.4923389
	speed: 0.0426s/iter; left time: 295.7879s
Epoch: 9 cost time: 29.09995150566101
Epoch: 9, Steps: 628 | Train Loss: 0.4472304 Vali Loss: 0.3724651 Test Loss: 0.4117506
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.4740983
	speed: 0.0433s/iter; left time: 294.7630s
	iters: 200, epoch: 10 | loss: 0.3530083
	speed: 0.0357s/iter; left time: 239.3900s
	iters: 300, epoch: 10 | loss: 0.4896468
	speed: 0.0397s/iter; left time: 262.4530s
	iters: 400, epoch: 10 | loss: 0.4091410
	speed: 0.0530s/iter; left time: 345.2111s
	iters: 500, epoch: 10 | loss: 0.4833967
	speed: 0.0563s/iter; left time: 360.8052s
	iters: 600, epoch: 10 | loss: 0.4427378
	speed: 0.0427s/iter; left time: 269.6474s
Epoch: 10 cost time: 28.48263955116272
Epoch: 10, Steps: 628 | Train Loss: 0.4467300 Vali Loss: 0.3783157 Test Loss: 0.4141722
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 11 | loss: 0.4212358
	speed: 0.0530s/iter; left time: 327.8262s
	iters: 200, epoch: 11 | loss: 0.4852190
	speed: 0.0461s/iter; left time: 280.3792s
	iters: 300, epoch: 11 | loss: 0.4524682
	speed: 0.0495s/iter; left time: 296.0216s
	iters: 400, epoch: 11 | loss: 0.4008741
	speed: 0.0372s/iter; left time: 219.0437s
	iters: 500, epoch: 11 | loss: 0.4837339
	speed: 0.0512s/iter; left time: 295.8195s
	iters: 600, epoch: 11 | loss: 0.4570141
	speed: 0.0527s/iter; left time: 299.6206s
Epoch: 11 cost time: 30.3675594329834
Epoch: 11, Steps: 628 | Train Loss: 0.4446892 Vali Loss: 0.3724063 Test Loss: 0.4110603
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7153
mse:0.41330960392951965, mae:0.43870583176612854
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 20065
val 7153
test 7153
	iters: 100, epoch: 1 | loss: 0.7227553
	speed: 0.0465s/iter; left time: 579.0579s
	iters: 200, epoch: 1 | loss: 0.5987118
	speed: 0.0492s/iter; left time: 608.1214s
	iters: 300, epoch: 1 | loss: 0.4508649
	speed: 0.0451s/iter; left time: 553.1912s
	iters: 400, epoch: 1 | loss: 0.5387762
	speed: 0.0577s/iter; left time: 701.4202s
	iters: 500, epoch: 1 | loss: 0.4840961
	speed: 0.0538s/iter; left time: 649.4081s
	iters: 600, epoch: 1 | loss: 0.5584333
	speed: 0.0442s/iter; left time: 528.8247s
Epoch: 1 cost time: 30.938608646392822
Epoch: 1, Steps: 628 | Train Loss: 0.5855936 Vali Loss: 0.4216934 Test Loss: 0.4707894
Validation loss decreased (inf --> 0.421693).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5523164
	speed: 0.0493s/iter; left time: 583.2141s
	iters: 200, epoch: 2 | loss: 0.5788614
	speed: 0.0545s/iter; left time: 639.8014s
	iters: 300, epoch: 2 | loss: 0.4530484
	speed: 0.0580s/iter; left time: 674.5341s
	iters: 400, epoch: 2 | loss: 0.5174170
	speed: 0.0494s/iter; left time: 569.5119s
	iters: 500, epoch: 2 | loss: 0.4787249
	speed: 0.0498s/iter; left time: 568.8872s
	iters: 600, epoch: 2 | loss: 0.4265238
	speed: 0.0506s/iter; left time: 573.3507s
Epoch: 2 cost time: 32.47593426704407
Epoch: 2, Steps: 628 | Train Loss: 0.4997584 Vali Loss: 0.4091047 Test Loss: 0.4468245
Validation loss decreased (0.421693 --> 0.409105).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.3894655
	speed: 0.0571s/iter; left time: 640.0389s
	iters: 200, epoch: 3 | loss: 0.4313995
	speed: 0.0526s/iter; left time: 583.9875s
	iters: 300, epoch: 3 | loss: 0.4360496
	speed: 0.0587s/iter; left time: 646.3041s
	iters: 400, epoch: 3 | loss: 0.4880956
	speed: 0.0543s/iter; left time: 592.4596s
	iters: 500, epoch: 3 | loss: 0.5398309
	speed: 0.0536s/iter; left time: 578.9708s
	iters: 600, epoch: 3 | loss: 0.5426486
	speed: 0.0499s/iter; left time: 533.8635s
Epoch: 3 cost time: 34.122870445251465
Epoch: 3, Steps: 628 | Train Loss: 0.4759667 Vali Loss: 0.3838710 Test Loss: 0.4277092
Validation loss decreased (0.409105 --> 0.383871).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4170431
	speed: 0.0606s/iter; left time: 641.3344s
	iters: 200, epoch: 4 | loss: 0.4619445
	speed: 0.0454s/iter; left time: 476.0721s
	iters: 300, epoch: 4 | loss: 0.3839664
	speed: 0.0412s/iter; left time: 427.5167s
	iters: 400, epoch: 4 | loss: 0.4925060
	speed: 0.0577s/iter; left time: 592.5038s
	iters: 500, epoch: 4 | loss: 0.4762559
	speed: 0.0611s/iter; left time: 621.6689s
	iters: 600, epoch: 4 | loss: 0.4448207
	speed: 0.0528s/iter; left time: 532.2168s
Epoch: 4 cost time: 33.240644454956055
Epoch: 4, Steps: 628 | Train Loss: 0.4698438 Vali Loss: 0.3903077 Test Loss: 0.4339357
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3993865
	speed: 0.0485s/iter; left time: 482.2726s
	iters: 200, epoch: 5 | loss: 0.5071962
	speed: 0.0381s/iter; left time: 375.6239s
	iters: 300, epoch: 5 | loss: 0.4030610
	speed: 0.0430s/iter; left time: 419.3018s
	iters: 400, epoch: 5 | loss: 0.4241294
	speed: 0.0464s/iter; left time: 447.3585s
	iters: 500, epoch: 5 | loss: 0.4794891
	speed: 0.0554s/iter; left time: 528.5872s
	iters: 600, epoch: 5 | loss: 0.4411502
	speed: 0.0538s/iter; left time: 508.3871s
Epoch: 5 cost time: 29.756947994232178
Epoch: 5, Steps: 628 | Train Loss: 0.4592047 Vali Loss: 0.3785539 Test Loss: 0.4187938
Validation loss decreased (0.383871 --> 0.378554).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4578813
	speed: 0.0389s/iter; left time: 362.7154s
	iters: 200, epoch: 6 | loss: 0.4347966
	speed: 0.0487s/iter; left time: 449.3254s
	iters: 300, epoch: 6 | loss: 0.5165517
	speed: 0.0535s/iter; left time: 488.2377s
	iters: 400, epoch: 6 | loss: 0.5393090
	speed: 0.0500s/iter; left time: 451.3366s
	iters: 500, epoch: 6 | loss: 0.5428637
	speed: 0.0418s/iter; left time: 372.7005s
	iters: 600, epoch: 6 | loss: 0.4321572
	speed: 0.0386s/iter; left time: 340.2019s
Epoch: 6 cost time: 28.80390214920044
Epoch: 6, Steps: 628 | Train Loss: 0.4558715 Vali Loss: 0.3777704 Test Loss: 0.4207510
Validation loss decreased (0.378554 --> 0.377770).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.3946124
	speed: 0.0531s/iter; left time: 461.7467s
	iters: 200, epoch: 7 | loss: 0.3479616
	speed: 0.0521s/iter; left time: 447.9231s
	iters: 300, epoch: 7 | loss: 0.4559564
	speed: 0.0495s/iter; left time: 420.0269s
	iters: 400, epoch: 7 | loss: 0.5253627
	speed: 0.0467s/iter; left time: 391.7612s
	iters: 500, epoch: 7 | loss: 0.5174856
	speed: 0.0417s/iter; left time: 345.5912s
	iters: 600, epoch: 7 | loss: 0.4385675
	speed: 0.0429s/iter; left time: 351.7439s
Epoch: 7 cost time: 29.608386039733887
Epoch: 7, Steps: 628 | Train Loss: 0.4510835 Vali Loss: 0.3784037 Test Loss: 0.4160655
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.4320409
	speed: 0.0515s/iter; left time: 415.5234s
	iters: 200, epoch: 8 | loss: 0.5111156
	speed: 0.0520s/iter; left time: 414.4642s
	iters: 300, epoch: 8 | loss: 0.4127462
	speed: 0.0537s/iter; left time: 422.0157s
	iters: 400, epoch: 8 | loss: 0.5559597
	speed: 0.0427s/iter; left time: 331.7162s
	iters: 500, epoch: 8 | loss: 0.4785112
	speed: 0.0494s/iter; left time: 378.5691s
	iters: 600, epoch: 8 | loss: 0.4338717
	speed: 0.0447s/iter; left time: 338.1857s
Epoch: 8 cost time: 31.000633716583252
Epoch: 8, Steps: 628 | Train Loss: 0.4494520 Vali Loss: 0.3734103 Test Loss: 0.4139502
Validation loss decreased (0.377770 --> 0.373410).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 9 | loss: 0.4955018
	speed: 0.0443s/iter; left time: 329.1604s
	iters: 200, epoch: 9 | loss: 0.4010256
	speed: 0.0378s/iter; left time: 277.3606s
	iters: 300, epoch: 9 | loss: 0.4508907
	speed: 0.0522s/iter; left time: 377.9086s
	iters: 400, epoch: 9 | loss: 0.4532239
	speed: 0.0528s/iter; left time: 376.5846s
	iters: 500, epoch: 9 | loss: 0.5078118
	speed: 0.0502s/iter; left time: 353.5991s
	iters: 600, epoch: 9 | loss: 0.4763516
	speed: 0.0566s/iter; left time: 392.8154s
Epoch: 9 cost time: 30.83919048309326
Epoch: 9, Steps: 628 | Train Loss: 0.4464545 Vali Loss: 0.3724835 Test Loss: 0.4132558
Validation loss decreased (0.373410 --> 0.372484).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4563732
	speed: 0.0440s/iter; left time: 299.7014s
	iters: 200, epoch: 10 | loss: 0.3718584
	speed: 0.0436s/iter; left time: 292.2181s
	iters: 300, epoch: 10 | loss: 0.4523746
	speed: 0.0606s/iter; left time: 400.6193s
	iters: 400, epoch: 10 | loss: 0.4403328
	speed: 0.0580s/iter; left time: 377.4391s
	iters: 500, epoch: 10 | loss: 0.5480055
	speed: 0.0562s/iter; left time: 360.4641s
	iters: 600, epoch: 10 | loss: 0.4411441
	speed: 0.0499s/iter; left time: 314.6802s
Epoch: 10 cost time: 32.745031118392944
Epoch: 10, Steps: 628 | Train Loss: 0.4456544 Vali Loss: 0.3727585 Test Loss: 0.4112932
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 11 | loss: 0.4140962
	speed: 0.0613s/iter; left time: 378.9478s
	iters: 200, epoch: 11 | loss: 0.4655651
	speed: 0.0458s/iter; left time: 278.7014s
	iters: 300, epoch: 11 | loss: 0.4683653
	speed: 0.0504s/iter; left time: 301.2709s
	iters: 400, epoch: 11 | loss: 0.4007875
	speed: 0.0428s/iter; left time: 251.5248s
	iters: 500, epoch: 11 | loss: 0.4428669
	speed: 0.0568s/iter; left time: 328.4077s
	iters: 600, epoch: 11 | loss: 0.4094832
	speed: 0.0486s/iter; left time: 276.1642s
Epoch: 11 cost time: 31.943954467773438
Epoch: 11, Steps: 628 | Train Loss: 0.4440184 Vali Loss: 0.3735127 Test Loss: 0.4113486
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 12 | loss: 0.4506148
	speed: 0.0475s/iter; left time: 263.7564s
	iters: 200, epoch: 12 | loss: 0.4609681
	speed: 0.0477s/iter; left time: 260.0373s
	iters: 300, epoch: 12 | loss: 0.4890690
	speed: 0.0489s/iter; left time: 261.7730s
	iters: 400, epoch: 12 | loss: 0.4514121
	speed: 0.0475s/iter; left time: 249.6206s
	iters: 500, epoch: 12 | loss: 0.4878128
	speed: 0.0479s/iter; left time: 246.7948s
	iters: 600, epoch: 12 | loss: 0.3899944
	speed: 0.0541s/iter; left time: 273.5785s
Epoch: 12 cost time: 30.842758893966675
Epoch: 12, Steps: 628 | Train Loss: 0.4436165 Vali Loss: 0.3743586 Test Loss: 0.4119414
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7153
mse:0.41302675008773804, mae:0.4380674362182617
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 20065
val 7153
test 7153
	iters: 100, epoch: 1 | loss: 0.5059877
	speed: 0.0554s/iter; left time: 689.7823s
	iters: 200, epoch: 1 | loss: 0.5872548
	speed: 0.0516s/iter; left time: 638.2989s
	iters: 300, epoch: 1 | loss: 0.4465289
	speed: 0.0430s/iter; left time: 527.0878s
	iters: 400, epoch: 1 | loss: 0.6404393
	speed: 0.0487s/iter; left time: 592.4902s
	iters: 500, epoch: 1 | loss: 0.5089870
	speed: 0.0538s/iter; left time: 648.4726s
	iters: 600, epoch: 1 | loss: 0.4969800
	speed: 0.0401s/iter; left time: 479.1420s
Epoch: 1 cost time: 30.639572858810425
Epoch: 1, Steps: 628 | Train Loss: 0.5764293 Vali Loss: 0.4712743 Test Loss: 0.5138940
Validation loss decreased (inf --> 0.471274).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4423841
	speed: 0.0687s/iter; left time: 812.6237s
	iters: 200, epoch: 2 | loss: 0.5052975
	speed: 0.0534s/iter; left time: 626.8129s
	iters: 300, epoch: 2 | loss: 0.4935762
	speed: 0.0509s/iter; left time: 591.8836s
	iters: 400, epoch: 2 | loss: 0.5174770
	speed: 0.0421s/iter; left time: 485.8475s
	iters: 500, epoch: 2 | loss: 0.4370838
	speed: 0.0478s/iter; left time: 546.9839s
	iters: 600, epoch: 2 | loss: 0.4470515
	speed: 0.0504s/iter; left time: 570.8197s
Epoch: 2 cost time: 32.934054374694824
Epoch: 2, Steps: 628 | Train Loss: 0.5006983 Vali Loss: 0.4195105 Test Loss: 0.4643145
Validation loss decreased (0.471274 --> 0.419510).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4925286
	speed: 0.0372s/iter; left time: 416.3251s
	iters: 200, epoch: 3 | loss: 0.4381317
	speed: 0.0383s/iter; left time: 425.2154s
	iters: 300, epoch: 3 | loss: 0.3698629
	speed: 0.0378s/iter; left time: 416.0226s
	iters: 400, epoch: 3 | loss: 0.3739984
	speed: 0.0510s/iter; left time: 556.5904s
	iters: 500, epoch: 3 | loss: 0.4868332
	speed: 0.0519s/iter; left time: 560.6146s
	iters: 600, epoch: 3 | loss: 0.4651785
	speed: 0.0428s/iter; left time: 457.6506s
Epoch: 3 cost time: 27.35859489440918
Epoch: 3, Steps: 628 | Train Loss: 0.4783153 Vali Loss: 0.4128320 Test Loss: 0.4442589
Validation loss decreased (0.419510 --> 0.412832).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4407445
	speed: 0.0457s/iter; left time: 482.8899s
	iters: 200, epoch: 4 | loss: 0.4940685
	speed: 0.0477s/iter; left time: 499.5875s
	iters: 300, epoch: 4 | loss: 0.4468992
	speed: 0.0553s/iter; left time: 574.2474s
	iters: 400, epoch: 4 | loss: 0.5059153
	speed: 0.0579s/iter; left time: 594.8573s
	iters: 500, epoch: 4 | loss: 0.4818842
	speed: 0.0553s/iter; left time: 562.3314s
	iters: 600, epoch: 4 | loss: 0.4172600
	speed: 0.0425s/iter; left time: 428.2729s
Epoch: 4 cost time: 31.457173109054565
Epoch: 4, Steps: 628 | Train Loss: 0.4702550 Vali Loss: 0.3896952 Test Loss: 0.4358061
Validation loss decreased (0.412832 --> 0.389695).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.3965275
	speed: 0.0527s/iter; left time: 524.3549s
	iters: 200, epoch: 5 | loss: 0.5553164
	speed: 0.0503s/iter; left time: 494.9499s
	iters: 300, epoch: 5 | loss: 0.4563041
	speed: 0.0474s/iter; left time: 461.8624s
	iters: 400, epoch: 5 | loss: 0.4357558
	speed: 0.0381s/iter; left time: 367.6205s
	iters: 500, epoch: 5 | loss: 0.5471264
	speed: 0.0532s/iter; left time: 508.1658s
	iters: 600, epoch: 5 | loss: 0.4246139
	speed: 0.0351s/iter; left time: 331.8258s
Epoch: 5 cost time: 29.302152633666992
Epoch: 5, Steps: 628 | Train Loss: 0.4593372 Vali Loss: 0.3851256 Test Loss: 0.4180481
Validation loss decreased (0.389695 --> 0.385126).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4599749
	speed: 0.0451s/iter; left time: 420.4247s
	iters: 200, epoch: 6 | loss: 0.5452777
	speed: 0.0476s/iter; left time: 438.8701s
	iters: 300, epoch: 6 | loss: 0.5019004
	speed: 0.0514s/iter; left time: 468.8859s
	iters: 400, epoch: 6 | loss: 0.4475835
	speed: 0.0506s/iter; left time: 456.0325s
	iters: 500, epoch: 6 | loss: 0.4439633
	speed: 0.0385s/iter; left time: 343.7045s
	iters: 600, epoch: 6 | loss: 0.4650637
	speed: 0.0485s/iter; left time: 428.1279s
Epoch: 6 cost time: 29.5804123878479
Epoch: 6, Steps: 628 | Train Loss: 0.4568755 Vali Loss: 0.3793559 Test Loss: 0.4172300
Validation loss decreased (0.385126 --> 0.379356).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.3956727
	speed: 0.0480s/iter; left time: 416.8329s
	iters: 200, epoch: 7 | loss: 0.3716259
	speed: 0.0441s/iter; left time: 379.2484s
	iters: 300, epoch: 7 | loss: 0.4199702
	speed: 0.0462s/iter; left time: 392.0451s
	iters: 400, epoch: 7 | loss: 0.4434783
	speed: 0.0510s/iter; left time: 428.0959s
	iters: 500, epoch: 7 | loss: 0.4422216
	speed: 0.0545s/iter; left time: 451.6767s
	iters: 600, epoch: 7 | loss: 0.4106865
	speed: 0.0523s/iter; left time: 428.4684s
Epoch: 7 cost time: 30.865587949752808
Epoch: 7, Steps: 628 | Train Loss: 0.4525341 Vali Loss: 0.3753872 Test Loss: 0.4148477
Validation loss decreased (0.379356 --> 0.375387).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4298026
	speed: 0.0566s/iter; left time: 456.2392s
	iters: 200, epoch: 8 | loss: 0.4440031
	speed: 0.0419s/iter; left time: 334.0757s
	iters: 300, epoch: 8 | loss: 0.5449038
	speed: 0.0447s/iter; left time: 351.8916s
	iters: 400, epoch: 8 | loss: 0.4444515
	speed: 0.0483s/iter; left time: 375.2946s
	iters: 500, epoch: 8 | loss: 0.4942148
	speed: 0.0616s/iter; left time: 471.9195s
	iters: 600, epoch: 8 | loss: 0.4199543
	speed: 0.0391s/iter; left time: 295.9637s
Epoch: 8 cost time: 30.530733346939087
Epoch: 8, Steps: 628 | Train Loss: 0.4506233 Vali Loss: 0.3762433 Test Loss: 0.4129599
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 9 | loss: 0.3521813
	speed: 0.0509s/iter; left time: 378.4527s
	iters: 200, epoch: 9 | loss: 0.3730787
	speed: 0.0438s/iter; left time: 321.5913s
	iters: 300, epoch: 9 | loss: 0.4036005
	speed: 0.0505s/iter; left time: 365.2050s
	iters: 400, epoch: 9 | loss: 0.4068398
	speed: 0.0454s/iter; left time: 323.6954s
	iters: 500, epoch: 9 | loss: 0.4393069
	speed: 0.0420s/iter; left time: 295.8917s
	iters: 600, epoch: 9 | loss: 0.4114676
	speed: 0.0465s/iter; left time: 322.6741s
Epoch: 9 cost time: 29.274465322494507
Epoch: 9, Steps: 628 | Train Loss: 0.4463934 Vali Loss: 0.3741111 Test Loss: 0.4140114
Validation loss decreased (0.375387 --> 0.374111).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3800947
	speed: 0.0449s/iter; left time: 305.4134s
	iters: 200, epoch: 10 | loss: 0.4546678
	speed: 0.0434s/iter; left time: 291.2166s
	iters: 300, epoch: 10 | loss: 0.4278268
	speed: 0.0533s/iter; left time: 352.2697s
	iters: 400, epoch: 10 | loss: 0.4371192
	speed: 0.0506s/iter; left time: 329.5662s
	iters: 500, epoch: 10 | loss: 0.5036989
	speed: 0.0503s/iter; left time: 322.6398s
	iters: 600, epoch: 10 | loss: 0.4659294
	speed: 0.0517s/iter; left time: 326.1723s
Epoch: 10 cost time: 30.7759530544281
Epoch: 10, Steps: 628 | Train Loss: 0.4464229 Vali Loss: 0.3744761 Test Loss: 0.4115689
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 11 | loss: 0.4212251
	speed: 0.0534s/iter; left time: 330.1661s
	iters: 200, epoch: 11 | loss: 0.4899959
	speed: 0.0528s/iter; left time: 321.3569s
	iters: 300, epoch: 11 | loss: 0.5116675
	speed: 0.0615s/iter; left time: 367.6788s
	iters: 400, epoch: 11 | loss: 0.4449045
	speed: 0.0383s/iter; left time: 225.1549s
	iters: 500, epoch: 11 | loss: 0.4451212
	speed: 0.0464s/iter; left time: 267.9619s
	iters: 600, epoch: 11 | loss: 0.4460047
	speed: 0.0410s/iter; left time: 232.9027s
Epoch: 11 cost time: 30.855881929397583
Epoch: 11, Steps: 628 | Train Loss: 0.4444260 Vali Loss: 0.3731809 Test Loss: 0.4110972
Validation loss decreased (0.374111 --> 0.373181).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.4745236
	speed: 0.0482s/iter; left time: 267.5977s
	iters: 200, epoch: 12 | loss: 0.3738710
	speed: 0.0561s/iter; left time: 305.7233s
	iters: 300, epoch: 12 | loss: 0.4053496
	speed: 0.0462s/iter; left time: 247.4890s
	iters: 400, epoch: 12 | loss: 0.4769946
	speed: 0.0431s/iter; left time: 226.3065s
	iters: 500, epoch: 12 | loss: 0.4910230
	speed: 0.0540s/iter; left time: 278.3040s
	iters: 600, epoch: 12 | loss: 0.3618078
	speed: 0.0546s/iter; left time: 275.9237s
Epoch: 12 cost time: 31.280418395996094
Epoch: 12, Steps: 628 | Train Loss: 0.4443255 Vali Loss: 0.3724921 Test Loss: 0.4119899
Validation loss decreased (0.373181 --> 0.372492).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.4162232
	speed: 0.0340s/iter; left time: 167.6868s
	iters: 200, epoch: 13 | loss: 0.4692088
	speed: 0.0426s/iter; left time: 205.7631s
	iters: 300, epoch: 13 | loss: 0.4567324
	speed: 0.0432s/iter; left time: 204.1028s
	iters: 400, epoch: 13 | loss: 0.4490711
	speed: 0.0406s/iter; left time: 187.6033s
	iters: 500, epoch: 13 | loss: 0.4664669
	speed: 0.0432s/iter; left time: 195.5307s
	iters: 600, epoch: 13 | loss: 0.4382006
	speed: 0.0378s/iter; left time: 167.3120s
Epoch: 13 cost time: 26.178147077560425
Epoch: 13, Steps: 628 | Train Loss: 0.4435891 Vali Loss: 0.3735792 Test Loss: 0.4114516
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 14 | loss: 0.4352551
	speed: 0.0554s/iter; left time: 238.2559s
	iters: 200, epoch: 14 | loss: 0.4098622
	speed: 0.0502s/iter; left time: 210.5582s
	iters: 300, epoch: 14 | loss: 0.4372756
	speed: 0.0445s/iter; left time: 182.2104s
	iters: 400, epoch: 14 | loss: 0.5410398
	speed: 0.0532s/iter; left time: 212.5451s
	iters: 500, epoch: 14 | loss: 0.4295959
	speed: 0.0430s/iter; left time: 167.6281s
	iters: 600, epoch: 14 | loss: 0.4275977
	speed: 0.0580s/iter; left time: 220.0727s
Epoch: 14 cost time: 31.335069179534912
Epoch: 14, Steps: 628 | Train Loss: 0.4441750 Vali Loss: 0.3738206 Test Loss: 0.4118573
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 15 | loss: 0.4468493
	speed: 0.0449s/iter; left time: 164.6265s
	iters: 200, epoch: 15 | loss: 0.4345741
	speed: 0.0394s/iter; left time: 140.5623s
	iters: 300, epoch: 15 | loss: 0.4529836
	speed: 0.0406s/iter; left time: 140.8949s
	iters: 400, epoch: 15 | loss: 0.4593107
	speed: 0.0476s/iter; left time: 160.2545s
	iters: 500, epoch: 15 | loss: 0.4644489
	speed: 0.0482s/iter; left time: 157.7195s
	iters: 600, epoch: 15 | loss: 0.4473020
	speed: 0.0417s/iter; left time: 132.0672s
Epoch: 15 cost time: 26.98926615715027
Epoch: 15, Steps: 628 | Train Loss: 0.4432242 Vali Loss: 0.3712585 Test Loss: 0.4112402
Validation loss decreased (0.372492 --> 0.371259).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.4468723
	speed: 0.0434s/iter; left time: 131.9129s
	iters: 200, epoch: 16 | loss: 0.4047989
	speed: 0.0462s/iter; left time: 135.9019s
	iters: 300, epoch: 16 | loss: 0.3584503
	speed: 0.0532s/iter; left time: 151.2368s
	iters: 400, epoch: 16 | loss: 0.4073124
	speed: 0.0504s/iter; left time: 138.2682s
	iters: 500, epoch: 16 | loss: 0.4505631
	speed: 0.0444s/iter; left time: 117.2598s
	iters: 600, epoch: 16 | loss: 0.4917583
	speed: 0.0476s/iter; left time: 120.8514s
Epoch: 16 cost time: 29.75081753730774
Epoch: 16, Steps: 628 | Train Loss: 0.4431263 Vali Loss: 0.3731366 Test Loss: 0.4106789
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 17 | loss: 0.4487474
	speed: 0.0421s/iter; left time: 101.4815s
	iters: 200, epoch: 17 | loss: 0.4877520
	speed: 0.0346s/iter; left time: 80.0148s
	iters: 300, epoch: 17 | loss: 0.5053370
	speed: 0.0383s/iter; left time: 84.7582s
	iters: 400, epoch: 17 | loss: 0.4081378
	speed: 0.0514s/iter; left time: 108.5076s
	iters: 500, epoch: 17 | loss: 0.3916439
	speed: 0.0404s/iter; left time: 81.2543s
	iters: 600, epoch: 17 | loss: 0.5127423
	speed: 0.0480s/iter; left time: 91.7722s
Epoch: 17 cost time: 26.75755023956299
Epoch: 17, Steps: 628 | Train Loss: 0.4421538 Vali Loss: 0.3725811 Test Loss: 0.4111781
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 18 | loss: 0.3703719
	speed: 0.0346s/iter; left time: 61.7476s
	iters: 200, epoch: 18 | loss: 0.3786675
	speed: 0.0537s/iter; left time: 90.4180s
	iters: 300, epoch: 18 | loss: 0.4757696
	speed: 0.0433s/iter; left time: 68.6309s
	iters: 400, epoch: 18 | loss: 0.4436458
	speed: 0.0505s/iter; left time: 75.0328s
	iters: 500, epoch: 18 | loss: 0.4011759
	speed: 0.0568s/iter; left time: 78.6055s
	iters: 600, epoch: 18 | loss: 0.4394648
	speed: 0.0521s/iter; left time: 66.9863s
Epoch: 18 cost time: 30.59348487854004
Epoch: 18, Steps: 628 | Train Loss: 0.4424466 Vali Loss: 0.3709636 Test Loss: 0.4101476
Validation loss decreased (0.371259 --> 0.370964).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.4141759
	speed: 0.0519s/iter; left time: 60.0501s
	iters: 200, epoch: 19 | loss: 0.4271071
	speed: 0.0550s/iter; left time: 58.1651s
	iters: 300, epoch: 19 | loss: 0.4542640
	speed: 0.0524s/iter; left time: 50.1675s
	iters: 400, epoch: 19 | loss: 0.4749437
	speed: 0.0636s/iter; left time: 54.5278s
	iters: 500, epoch: 19 | loss: 0.4233707
	speed: 0.0459s/iter; left time: 34.7728s
	iters: 600, epoch: 19 | loss: 0.4466414
	speed: 0.0465s/iter; left time: 30.5605s
Epoch: 19 cost time: 32.88452863693237
Epoch: 19, Steps: 628 | Train Loss: 0.4425037 Vali Loss: 0.3719872 Test Loss: 0.4110096
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 20 | loss: 0.4421294
	speed: 0.0478s/iter; left time: 25.3062s
	iters: 200, epoch: 20 | loss: 0.4962486
	speed: 0.0470s/iter; left time: 20.1736s
	iters: 300, epoch: 20 | loss: 0.3798451
	speed: 0.0494s/iter; left time: 16.2371s
	iters: 400, epoch: 20 | loss: 0.4524967
	speed: 0.0465s/iter; left time: 10.6528s
	iters: 500, epoch: 20 | loss: 0.4701646
	speed: 0.0526s/iter; left time: 6.7824s
	iters: 600, epoch: 20 | loss: 0.3346118
	speed: 0.0481s/iter; left time: 1.3947s
Epoch: 20 cost time: 30.53469204902649
Epoch: 20, Steps: 628 | Train Loss: 0.4419232 Vali Loss: 0.3728945 Test Loss: 0.4102562
EarlyStopping counter: 2 out of 3
>>>>>>>testing : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7153
mse:0.4098576605319977, mae:0.4359750747680664
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 20065
val 7153
test 7153
	iters: 100, epoch: 1 | loss: 0.4914509
	speed: 0.0407s/iter; left time: 507.4259s
	iters: 200, epoch: 1 | loss: 0.5220219
	speed: 0.0528s/iter; left time: 652.5521s
	iters: 300, epoch: 1 | loss: 0.6082957
	speed: 0.0377s/iter; left time: 461.9480s
	iters: 400, epoch: 1 | loss: 0.4512992
	speed: 0.0375s/iter; left time: 456.4240s
	iters: 500, epoch: 1 | loss: 0.5118783
	speed: 0.0528s/iter; left time: 636.3786s
	iters: 600, epoch: 1 | loss: 0.4879705
	speed: 0.0489s/iter; left time: 584.9057s
Epoch: 1 cost time: 28.67290735244751
Epoch: 1, Steps: 628 | Train Loss: 0.5707455 Vali Loss: 0.4312460 Test Loss: 0.4858168
Validation loss decreased (inf --> 0.431246).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4824821
	speed: 0.0541s/iter; left time: 640.4991s
	iters: 200, epoch: 2 | loss: 0.4616314
	speed: 0.0453s/iter; left time: 531.4420s
	iters: 300, epoch: 2 | loss: 0.5711027
	speed: 0.0498s/iter; left time: 578.7900s
	iters: 400, epoch: 2 | loss: 0.5324873
	speed: 0.0439s/iter; left time: 506.3892s
	iters: 500, epoch: 2 | loss: 0.4979123
	speed: 0.0359s/iter; left time: 409.9944s
	iters: 600, epoch: 2 | loss: 0.4995367
	speed: 0.0485s/iter; left time: 549.8274s
Epoch: 2 cost time: 29.08130168914795
Epoch: 2, Steps: 628 | Train Loss: 0.4984722 Vali Loss: 0.3960889 Test Loss: 0.4341751
Validation loss decreased (0.431246 --> 0.396089).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4832014
	speed: 0.0424s/iter; left time: 475.4454s
	iters: 200, epoch: 3 | loss: 0.4390127
	speed: 0.0468s/iter; left time: 519.6168s
	iters: 300, epoch: 3 | loss: 0.3978676
	speed: 0.0429s/iter; left time: 472.1354s
	iters: 400, epoch: 3 | loss: 0.4456312
	speed: 0.0380s/iter; left time: 414.7993s
	iters: 500, epoch: 3 | loss: 0.4743400
	speed: 0.0494s/iter; left time: 534.2823s
	iters: 600, epoch: 3 | loss: 0.4904128
	speed: 0.0343s/iter; left time: 367.0651s
Epoch: 3 cost time: 26.850546836853027
Epoch: 3, Steps: 628 | Train Loss: 0.4760230 Vali Loss: 0.3987282 Test Loss: 0.4324725
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.4484799
	speed: 0.0432s/iter; left time: 456.7205s
	iters: 200, epoch: 4 | loss: 0.4584391
	speed: 0.0444s/iter; left time: 465.0738s
	iters: 300, epoch: 4 | loss: 0.4639044
	speed: 0.0465s/iter; left time: 482.0339s
	iters: 400, epoch: 4 | loss: 0.4396039
	speed: 0.0445s/iter; left time: 457.1222s
	iters: 500, epoch: 4 | loss: 0.4373031
	speed: 0.0428s/iter; left time: 435.7316s
	iters: 600, epoch: 4 | loss: 0.4790841
	speed: 0.0369s/iter; left time: 371.6374s
Epoch: 4 cost time: 27.283896684646606
Epoch: 4, Steps: 628 | Train Loss: 0.4697153 Vali Loss: 0.3946118 Test Loss: 0.4301180
Validation loss decreased (0.396089 --> 0.394612).  Saving model ...
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.4790175
	speed: 0.0496s/iter; left time: 493.6987s
	iters: 200, epoch: 5 | loss: 0.3951294
	speed: 0.0476s/iter; left time: 468.5094s
	iters: 300, epoch: 5 | loss: 0.4194202
	speed: 0.0358s/iter; left time: 349.3058s
	iters: 400, epoch: 5 | loss: 0.5575448
	speed: 0.0513s/iter; left time: 494.5943s
	iters: 500, epoch: 5 | loss: 0.5341119
	speed: 0.0301s/iter; left time: 287.0303s
	iters: 600, epoch: 5 | loss: 0.4240896
	speed: 0.0375s/iter; left time: 354.1409s
Epoch: 5 cost time: 26.058475017547607
Epoch: 5, Steps: 628 | Train Loss: 0.4591151 Vali Loss: 0.3998929 Test Loss: 0.4265168
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.4455318
	speed: 0.0536s/iter; left time: 500.0702s
	iters: 200, epoch: 6 | loss: 0.4754232
	speed: 0.0379s/iter; left time: 349.6274s
	iters: 300, epoch: 6 | loss: 0.5058318
	speed: 0.0483s/iter; left time: 440.6053s
	iters: 400, epoch: 6 | loss: 0.4944032
	speed: 0.0532s/iter; left time: 480.0330s
	iters: 500, epoch: 6 | loss: 0.4305414
	speed: 0.0463s/iter; left time: 413.1610s
	iters: 600, epoch: 6 | loss: 0.4709684
	speed: 0.0395s/iter; left time: 348.6554s
Epoch: 6 cost time: 29.127817392349243
Epoch: 6, Steps: 628 | Train Loss: 0.4555637 Vali Loss: 0.3856600 Test Loss: 0.4200835
Validation loss decreased (0.394612 --> 0.385660).  Saving model ...
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.3855316
	speed: 0.0505s/iter; left time: 439.1493s
	iters: 200, epoch: 7 | loss: 0.4107372
	speed: 0.0438s/iter; left time: 376.5543s
	iters: 300, epoch: 7 | loss: 0.4116391
	speed: 0.0591s/iter; left time: 501.7273s
	iters: 400, epoch: 7 | loss: 0.5724468
	speed: 0.0551s/iter; left time: 462.7494s
	iters: 500, epoch: 7 | loss: 0.4741483
	speed: 0.0425s/iter; left time: 352.5446s
	iters: 600, epoch: 7 | loss: 0.4294829
	speed: 0.0441s/iter; left time: 361.5826s
Epoch: 7 cost time: 30.60983109474182
Epoch: 7, Steps: 628 | Train Loss: 0.4497766 Vali Loss: 0.3802432 Test Loss: 0.4147223
Validation loss decreased (0.385660 --> 0.380243).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4394943
	speed: 0.0448s/iter; left time: 360.9531s
	iters: 200, epoch: 8 | loss: 0.4588750
	speed: 0.0477s/iter; left time: 379.8842s
	iters: 300, epoch: 8 | loss: 0.4319760
	speed: 0.0357s/iter; left time: 280.9611s
	iters: 400, epoch: 8 | loss: 0.4310087
	speed: 0.0439s/iter; left time: 341.1485s
	iters: 500, epoch: 8 | loss: 0.4118640
	speed: 0.0511s/iter; left time: 391.9948s
	iters: 600, epoch: 8 | loss: 0.4484808
	speed: 0.0492s/iter; left time: 371.8944s
Epoch: 8 cost time: 28.47270441055298
Epoch: 8, Steps: 628 | Train Loss: 0.4484351 Vali Loss: 0.3762905 Test Loss: 0.4144780
Validation loss decreased (0.380243 --> 0.376291).  Saving model ...
Updating learning rate to 6.25e-06
	iters: 100, epoch: 9 | loss: 0.4247646
	speed: 0.0407s/iter; left time: 303.0146s
	iters: 200, epoch: 9 | loss: 0.4982342
	speed: 0.0398s/iter; left time: 292.1816s
	iters: 300, epoch: 9 | loss: 0.4650427
	speed: 0.0461s/iter; left time: 333.4854s
	iters: 400, epoch: 9 | loss: 0.4722957
	speed: 0.0475s/iter; left time: 339.2216s
	iters: 500, epoch: 9 | loss: 0.5114207
	speed: 0.0450s/iter; left time: 316.7259s
	iters: 600, epoch: 9 | loss: 0.4943978
	speed: 0.0516s/iter; left time: 357.7788s
Epoch: 9 cost time: 28.603418111801147
Epoch: 9, Steps: 628 | Train Loss: 0.4455808 Vali Loss: 0.3719282 Test Loss: 0.4108741
Validation loss decreased (0.376291 --> 0.371928).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4755674
	speed: 0.0466s/iter; left time: 317.1538s
	iters: 200, epoch: 10 | loss: 0.4006846
	speed: 0.0347s/iter; left time: 232.9390s
	iters: 300, epoch: 10 | loss: 0.5102170
	speed: 0.0484s/iter; left time: 319.7505s
	iters: 400, epoch: 10 | loss: 0.4461614
	speed: 0.0327s/iter; left time: 213.1038s
	iters: 500, epoch: 10 | loss: 0.4383434
	speed: 0.0500s/iter; left time: 320.2628s
	iters: 600, epoch: 10 | loss: 0.3688045
	speed: 0.0456s/iter; left time: 287.5569s
Epoch: 10 cost time: 27.395869255065918
Epoch: 10, Steps: 628 | Train Loss: 0.4448536 Vali Loss: 0.3743473 Test Loss: 0.4103682
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-06
	iters: 100, epoch: 11 | loss: 0.4478750
	speed: 0.0431s/iter; left time: 266.1555s
	iters: 200, epoch: 11 | loss: 0.4483711
	speed: 0.0433s/iter; left time: 263.0172s
	iters: 300, epoch: 11 | loss: 0.4459745
	speed: 0.0550s/iter; left time: 329.2372s
	iters: 400, epoch: 11 | loss: 0.4596700
	speed: 0.0490s/iter; left time: 288.0609s
	iters: 500, epoch: 11 | loss: 0.3967780
	speed: 0.0433s/iter; left time: 250.3282s
	iters: 600, epoch: 11 | loss: 0.4124265
	speed: 0.0436s/iter; left time: 247.8090s
Epoch: 11 cost time: 29.313372135162354
Epoch: 11, Steps: 628 | Train Loss: 0.4431813 Vali Loss: 0.3739352 Test Loss: 0.4095692
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 12 | loss: 0.3845328
	speed: 0.0360s/iter; left time: 199.9334s
	iters: 200, epoch: 12 | loss: 0.4245948
	speed: 0.0372s/iter; left time: 203.0026s
	iters: 300, epoch: 12 | loss: 0.5070319
	speed: 0.0385s/iter; left time: 206.1401s
	iters: 400, epoch: 12 | loss: 0.4001784
	speed: 0.0368s/iter; left time: 193.5037s
	iters: 500, epoch: 12 | loss: 0.4269530
	speed: 0.0413s/iter; left time: 213.0411s
	iters: 600, epoch: 12 | loss: 0.4737354
	speed: 0.0472s/iter; left time: 238.6246s
Epoch: 12 cost time: 24.809422969818115
Epoch: 12, Steps: 628 | Train Loss: 0.4432894 Vali Loss: 0.3737414 Test Loss: 0.4089245
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7153
mse:0.4106431305408478, mae:0.4362260401248932
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 20065
val 7153
test 7153
	iters: 100, epoch: 1 | loss: 0.5228654
	speed: 0.0537s/iter; left time: 669.6593s
	iters: 200, epoch: 1 | loss: 0.5336869
	speed: 0.0476s/iter; left time: 588.5399s
	iters: 300, epoch: 1 | loss: 0.5344238
	speed: 0.0443s/iter; left time: 542.9875s
	iters: 400, epoch: 1 | loss: 0.5080509
	speed: 0.0490s/iter; left time: 596.4096s
	iters: 500, epoch: 1 | loss: 0.5509541
	speed: 0.0453s/iter; left time: 546.9030s
	iters: 600, epoch: 1 | loss: 0.5523949
	speed: 0.0457s/iter; left time: 546.9993s
Epoch: 1 cost time: 29.551478624343872
Epoch: 1, Steps: 628 | Train Loss: 0.5751259 Vali Loss: 0.4260032 Test Loss: 0.4718360
Validation loss decreased (inf --> 0.426003).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4622557
	speed: 0.0461s/iter; left time: 545.0287s
	iters: 200, epoch: 2 | loss: 0.4898866
	speed: 0.0462s/iter; left time: 541.6738s
	iters: 300, epoch: 2 | loss: 0.4559703
	speed: 0.0500s/iter; left time: 581.2444s
	iters: 400, epoch: 2 | loss: 0.4596116
	speed: 0.0471s/iter; left time: 543.6541s
	iters: 500, epoch: 2 | loss: 0.4509418
	speed: 0.0488s/iter; left time: 557.5618s
	iters: 600, epoch: 2 | loss: 0.4773281
	speed: 0.0379s/iter; left time: 428.9705s
Epoch: 2 cost time: 28.626396656036377
Epoch: 2, Steps: 628 | Train Loss: 0.4978515 Vali Loss: 0.4108240 Test Loss: 0.4529352
Validation loss decreased (0.426003 --> 0.410824).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.5056946
	speed: 0.0447s/iter; left time: 500.9050s
	iters: 200, epoch: 3 | loss: 0.5105050
	speed: 0.0405s/iter; left time: 449.6424s
	iters: 300, epoch: 3 | loss: 0.5252013
	speed: 0.0456s/iter; left time: 501.6953s
	iters: 400, epoch: 3 | loss: 0.4903515
	speed: 0.0553s/iter; left time: 603.4472s
	iters: 500, epoch: 3 | loss: 0.4808773
	speed: 0.0396s/iter; left time: 428.3869s
	iters: 600, epoch: 3 | loss: 0.5709913
	speed: 0.0443s/iter; left time: 473.8888s
Epoch: 3 cost time: 28.206283569335938
Epoch: 3, Steps: 628 | Train Loss: 0.4751664 Vali Loss: 0.3960260 Test Loss: 0.4330356
Validation loss decreased (0.410824 --> 0.396026).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5402414
	speed: 0.0382s/iter; left time: 403.6050s
	iters: 200, epoch: 4 | loss: 0.3615403
	speed: 0.0403s/iter; left time: 422.1184s
	iters: 300, epoch: 4 | loss: 0.5225986
	speed: 0.0464s/iter; left time: 481.9185s
	iters: 400, epoch: 4 | loss: 0.4388155
	speed: 0.0399s/iter; left time: 410.0574s
	iters: 500, epoch: 4 | loss: 0.5088724
	speed: 0.0479s/iter; left time: 487.0104s
	iters: 600, epoch: 4 | loss: 0.5247523
	speed: 0.0381s/iter; left time: 383.6137s
Epoch: 4 cost time: 26.097269535064697
Epoch: 4, Steps: 628 | Train Loss: 0.4685266 Vali Loss: 0.4054199 Test Loss: 0.4384983
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.5013577
	speed: 0.0405s/iter; left time: 403.3911s
	iters: 200, epoch: 5 | loss: 0.4455591
	speed: 0.0451s/iter; left time: 444.5466s
	iters: 300, epoch: 5 | loss: 0.5353583
	speed: 0.0700s/iter; left time: 682.2467s
	iters: 400, epoch: 5 | loss: 0.4348338
	speed: 0.0494s/iter; left time: 476.2580s
	iters: 500, epoch: 5 | loss: 0.4229374
	speed: 0.0462s/iter; left time: 440.8483s
	iters: 600, epoch: 5 | loss: 0.4725970
	speed: 0.0423s/iter; left time: 399.5745s
Epoch: 5 cost time: 30.769461154937744
Epoch: 5, Steps: 628 | Train Loss: 0.4584669 Vali Loss: 0.3759389 Test Loss: 0.4189245
Validation loss decreased (0.396026 --> 0.375939).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3537163
	speed: 0.0502s/iter; left time: 468.1824s
	iters: 200, epoch: 6 | loss: 0.3775789
	speed: 0.0469s/iter; left time: 432.5713s
	iters: 300, epoch: 6 | loss: 0.4794292
	speed: 0.0391s/iter; left time: 356.5237s
	iters: 400, epoch: 6 | loss: 0.5040297
	speed: 0.0496s/iter; left time: 447.8565s
	iters: 500, epoch: 6 | loss: 0.4312504
	speed: 0.0492s/iter; left time: 439.0223s
	iters: 600, epoch: 6 | loss: 0.4935310
	speed: 0.0490s/iter; left time: 432.0758s
Epoch: 6 cost time: 29.599273443222046
Epoch: 6, Steps: 628 | Train Loss: 0.4545028 Vali Loss: 0.3770279 Test Loss: 0.4177287
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.4685888
	speed: 0.0408s/iter; left time: 354.3080s
	iters: 200, epoch: 7 | loss: 0.4538817
	speed: 0.0413s/iter; left time: 355.0014s
	iters: 300, epoch: 7 | loss: 0.3822858
	speed: 0.0663s/iter; left time: 562.9993s
	iters: 400, epoch: 7 | loss: 0.4111051
	speed: 0.0484s/iter; left time: 406.0723s
	iters: 500, epoch: 7 | loss: 0.4253916
	speed: 0.0420s/iter; left time: 347.9825s
	iters: 600, epoch: 7 | loss: 0.4250607
	speed: 0.0352s/iter; left time: 288.0070s
Epoch: 7 cost time: 28.41030740737915
Epoch: 7, Steps: 628 | Train Loss: 0.4491736 Vali Loss: 0.3739476 Test Loss: 0.4157659
Validation loss decreased (0.375939 --> 0.373948).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5395864
	speed: 0.0437s/iter; left time: 352.5851s
	iters: 200, epoch: 8 | loss: 0.4507837
	speed: 0.0441s/iter; left time: 351.5694s
	iters: 300, epoch: 8 | loss: 0.4530815
	speed: 0.0395s/iter; left time: 310.4318s
	iters: 400, epoch: 8 | loss: 0.4693727
	speed: 0.0393s/iter; left time: 305.3037s
	iters: 500, epoch: 8 | loss: 0.4254762
	speed: 0.0327s/iter; left time: 250.5248s
	iters: 600, epoch: 8 | loss: 0.4852890
	speed: 0.0384s/iter; left time: 290.4593s
Epoch: 8 cost time: 24.777135610580444
Epoch: 8, Steps: 628 | Train Loss: 0.4478117 Vali Loss: 0.3783349 Test Loss: 0.4166963
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-06
	iters: 100, epoch: 9 | loss: 0.4440194
	speed: 0.0500s/iter; left time: 372.0889s
	iters: 200, epoch: 9 | loss: 0.3527868
	speed: 0.0457s/iter; left time: 334.9736s
	iters: 300, epoch: 9 | loss: 0.4346170
	speed: 0.0467s/iter; left time: 337.9873s
	iters: 400, epoch: 9 | loss: 0.4230829
	speed: 0.0420s/iter; left time: 299.8899s
	iters: 500, epoch: 9 | loss: 0.4311912
	speed: 0.0533s/iter; left time: 375.1679s
	iters: 600, epoch: 9 | loss: 0.3920356
	speed: 0.0484s/iter; left time: 335.9979s
Epoch: 9 cost time: 30.110633850097656
Epoch: 9, Steps: 628 | Train Loss: 0.4450567 Vali Loss: 0.3724492 Test Loss: 0.4127276
Validation loss decreased (0.373948 --> 0.372449).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4730703
	speed: 0.0452s/iter; left time: 308.0628s
	iters: 200, epoch: 10 | loss: 0.3514263
	speed: 0.0435s/iter; left time: 291.6709s
	iters: 300, epoch: 10 | loss: 0.4640174
	speed: 0.0493s/iter; left time: 325.8173s
	iters: 400, epoch: 10 | loss: 0.4535891
	speed: 0.0386s/iter; left time: 250.9939s
	iters: 500, epoch: 10 | loss: 0.4369413
	speed: 0.0371s/iter; left time: 237.9111s
	iters: 600, epoch: 10 | loss: 0.5669060
	speed: 0.0369s/iter; left time: 233.0798s
Epoch: 10 cost time: 25.85990285873413
Epoch: 10, Steps: 628 | Train Loss: 0.4438848 Vali Loss: 0.3718115 Test Loss: 0.4133550
Validation loss decreased (0.372449 --> 0.371812).  Saving model ...
Updating learning rate to 3.125e-06
	iters: 100, epoch: 11 | loss: 0.4465947
	speed: 0.0501s/iter; left time: 309.4855s
	iters: 200, epoch: 11 | loss: 0.4345963
	speed: 0.0506s/iter; left time: 307.6579s
	iters: 300, epoch: 11 | loss: 0.4430109
	speed: 0.0364s/iter; left time: 217.9260s
	iters: 400, epoch: 11 | loss: 0.4693056
	speed: 0.0460s/iter; left time: 270.5973s
	iters: 500, epoch: 11 | loss: 0.4444182
	speed: 0.0507s/iter; left time: 293.1361s
	iters: 600, epoch: 11 | loss: 0.4385653
	speed: 0.0440s/iter; left time: 249.7231s
Epoch: 11 cost time: 29.4969003200531
Epoch: 11, Steps: 628 | Train Loss: 0.4427661 Vali Loss: 0.3730933 Test Loss: 0.4124706
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.5319932
	speed: 0.0392s/iter; left time: 217.6676s
	iters: 200, epoch: 12 | loss: 0.3975671
	speed: 0.0485s/iter; left time: 264.4968s
	iters: 300, epoch: 12 | loss: 0.4978003
	speed: 0.0410s/iter; left time: 219.5027s
	iters: 400, epoch: 12 | loss: 0.4503003
	speed: 0.0491s/iter; left time: 258.0490s
	iters: 500, epoch: 12 | loss: 0.5011909
	speed: 0.0535s/iter; left time: 275.8561s
	iters: 600, epoch: 12 | loss: 0.4025734
	speed: 0.0445s/iter; left time: 224.9965s
Epoch: 12 cost time: 28.980594396591187
Epoch: 12, Steps: 628 | Train Loss: 0.4417758 Vali Loss: 0.3722424 Test Loss: 0.4120451
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 13 | loss: 0.4713544
	speed: 0.0355s/iter; left time: 174.6533s
	iters: 200, epoch: 13 | loss: 0.5159400
	speed: 0.0360s/iter; left time: 173.6272s
	iters: 300, epoch: 13 | loss: 0.4647688
	speed: 0.0500s/iter; left time: 236.0211s
	iters: 400, epoch: 13 | loss: 0.4383281
	speed: 0.0466s/iter; left time: 215.4825s
	iters: 500, epoch: 13 | loss: 0.4141878
	speed: 0.0419s/iter; left time: 189.7843s
	iters: 600, epoch: 13 | loss: 0.4047736
	speed: 0.0422s/iter; left time: 186.7259s
Epoch: 13 cost time: 26.77888560295105
Epoch: 13, Steps: 628 | Train Loss: 0.4415738 Vali Loss: 0.3724261 Test Loss: 0.4121750
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_WTH_il48_ol48_sl12,16,24_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7153
mse:0.41304510831832886, mae:0.4368833303451538
