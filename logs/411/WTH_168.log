Args in experiment:
Namespace(data='WTH', root_path='./datasets/', data_path='WTH.csv', data_split=[20160, 7200, 7200], checkpoints='./checkpoints/', in_len=336, out_len=168, seg_lens='24,36,48,56', data_dim=12, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.2, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=1e-05, lradj='type1', itr=5, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3')
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 19657
val 7033
test 7033
	iters: 100, epoch: 1 | loss: 1.1283674
	speed: 0.2612s/iter; left time: 3186.4466s
	iters: 200, epoch: 1 | loss: 0.8850639
	speed: 0.2115s/iter; left time: 2559.3713s
	iters: 300, epoch: 1 | loss: 0.8778342
	speed: 0.1984s/iter; left time: 2380.5494s
	iters: 400, epoch: 1 | loss: 0.8085465
	speed: 0.2238s/iter; left time: 2663.4487s
	iters: 500, epoch: 1 | loss: 0.7609889
	speed: 0.2306s/iter; left time: 2721.8225s
	iters: 600, epoch: 1 | loss: 0.7896010
	speed: 0.2168s/iter; left time: 2536.8031s
Epoch: 1 cost time: 137.25658750534058
Epoch: 1, Steps: 615 | Train Loss: 0.9400566 Vali Loss: 0.5548024 Test Loss: 0.6175080
Validation loss decreased (inf --> 0.554802).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6522046
	speed: 0.2159s/iter; left time: 2501.3659s
	iters: 200, epoch: 2 | loss: 0.6290951
	speed: 0.2284s/iter; left time: 2623.7797s
	iters: 300, epoch: 2 | loss: 0.7171767
	speed: 0.2060s/iter; left time: 2346.0091s
	iters: 400, epoch: 2 | loss: 0.6705231
	speed: 0.2164s/iter; left time: 2442.3831s
	iters: 500, epoch: 2 | loss: 0.6182638
	speed: 0.2272s/iter; left time: 2541.4558s
	iters: 600, epoch: 2 | loss: 0.5631838
	speed: 0.2269s/iter; left time: 2514.9554s
Epoch: 2 cost time: 135.3846459388733
Epoch: 2, Steps: 615 | Train Loss: 0.6498729 Vali Loss: 0.4891660 Test Loss: 0.5446663
Validation loss decreased (0.554802 --> 0.489166).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.5589146
	speed: 0.2080s/iter; left time: 2281.9616s
	iters: 200, epoch: 3 | loss: 0.5625995
	speed: 0.2112s/iter; left time: 2295.6332s
	iters: 300, epoch: 3 | loss: 0.6587532
	speed: 0.2217s/iter; left time: 2387.8924s
	iters: 400, epoch: 3 | loss: 0.5628791
	speed: 0.2042s/iter; left time: 2179.3344s
	iters: 500, epoch: 3 | loss: 0.5647545
	speed: 0.2151s/iter; left time: 2273.7318s
	iters: 600, epoch: 3 | loss: 0.6337872
	speed: 0.2204s/iter; left time: 2308.1493s
Epoch: 3 cost time: 131.57599711418152
Epoch: 3, Steps: 615 | Train Loss: 0.6136269 Vali Loss: 0.4760272 Test Loss: 0.5310768
Validation loss decreased (0.489166 --> 0.476027).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6251261
	speed: 0.2211s/iter; left time: 2289.8911s
	iters: 200, epoch: 4 | loss: 0.6471126
	speed: 0.2371s/iter; left time: 2431.7888s
	iters: 300, epoch: 4 | loss: 0.5125848
	speed: 0.2197s/iter; left time: 2231.2987s
	iters: 400, epoch: 4 | loss: 0.5916176
	speed: 0.2090s/iter; left time: 2102.1569s
	iters: 500, epoch: 4 | loss: 0.6277075
	speed: 0.2065s/iter; left time: 2056.1658s
	iters: 600, epoch: 4 | loss: 0.6406629
	speed: 0.2183s/iter; left time: 2151.5618s
Epoch: 4 cost time: 134.18687510490417
Epoch: 4, Steps: 615 | Train Loss: 0.6031386 Vali Loss: 0.4662097 Test Loss: 0.5251068
Validation loss decreased (0.476027 --> 0.466210).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.6311207
	speed: 0.2179s/iter; left time: 2122.2913s
	iters: 200, epoch: 5 | loss: 0.5580055
	speed: 0.2108s/iter; left time: 2032.1732s
	iters: 300, epoch: 5 | loss: 0.5972597
	speed: 0.2048s/iter; left time: 1954.2254s
	iters: 400, epoch: 5 | loss: 0.6151674
	speed: 0.2286s/iter; left time: 2157.8911s
	iters: 500, epoch: 5 | loss: 0.6490448
	speed: 0.2028s/iter; left time: 1893.9070s
	iters: 600, epoch: 5 | loss: 0.5946556
	speed: 0.2399s/iter; left time: 2217.2618s
Epoch: 5 cost time: 133.70016860961914
Epoch: 5, Steps: 615 | Train Loss: 0.5955193 Vali Loss: 0.4677087 Test Loss: 0.5226679
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.5910912
	speed: 0.2175s/iter; left time: 1984.7843s
	iters: 200, epoch: 6 | loss: 0.6871191
	speed: 0.2157s/iter; left time: 1946.4968s
	iters: 300, epoch: 6 | loss: 0.5540128
	speed: 0.2200s/iter; left time: 1964.1380s
	iters: 400, epoch: 6 | loss: 0.6805374
	speed: 0.2219s/iter; left time: 1958.4057s
	iters: 500, epoch: 6 | loss: 0.5894472
	speed: 0.2179s/iter; left time: 1901.2828s
	iters: 600, epoch: 6 | loss: 0.6104921
	speed: 0.2194s/iter; left time: 1892.2697s
Epoch: 6 cost time: 134.68485164642334
Epoch: 6, Steps: 615 | Train Loss: 0.5921473 Vali Loss: 0.4632559 Test Loss: 0.5181084
Validation loss decreased (0.466210 --> 0.463256).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.6336263
	speed: 0.2241s/iter; left time: 1907.5284s
	iters: 200, epoch: 7 | loss: 0.6612645
	speed: 0.2324s/iter; left time: 1954.3385s
	iters: 300, epoch: 7 | loss: 0.5841872
	speed: 0.2255s/iter; left time: 1874.4155s
	iters: 400, epoch: 7 | loss: 0.5772234
	speed: 0.2121s/iter; left time: 1741.2919s
	iters: 500, epoch: 7 | loss: 0.5808353
	speed: 0.2320s/iter; left time: 1881.9338s
	iters: 600, epoch: 7 | loss: 0.5397713
	speed: 0.2080s/iter; left time: 1665.9109s
Epoch: 7 cost time: 136.49420547485352
Epoch: 7, Steps: 615 | Train Loss: 0.5890189 Vali Loss: 0.4615637 Test Loss: 0.5180641
Validation loss decreased (0.463256 --> 0.461564).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.6147571
	speed: 0.2257s/iter; left time: 1781.9303s
	iters: 200, epoch: 8 | loss: 0.6628900
	speed: 0.2137s/iter; left time: 1665.9806s
	iters: 300, epoch: 8 | loss: 0.5870375
	speed: 0.2328s/iter; left time: 1791.3029s
	iters: 400, epoch: 8 | loss: 0.6245559
	speed: 0.2115s/iter; left time: 1606.2695s
	iters: 500, epoch: 8 | loss: 0.6100402
	speed: 0.2045s/iter; left time: 1533.2545s
	iters: 600, epoch: 8 | loss: 0.5241680
	speed: 0.2079s/iter; left time: 1537.3082s
Epoch: 8 cost time: 132.86044573783875
Epoch: 8, Steps: 615 | Train Loss: 0.5875355 Vali Loss: 0.4614856 Test Loss: 0.5166645
Validation loss decreased (0.461564 --> 0.461486).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.6228219
	speed: 0.2221s/iter; left time: 1617.4725s
	iters: 200, epoch: 9 | loss: 0.6297246
	speed: 0.2152s/iter; left time: 1545.1991s
	iters: 300, epoch: 9 | loss: 0.5089687
	speed: 0.2126s/iter; left time: 1505.5208s
	iters: 400, epoch: 9 | loss: 0.5424501
	speed: 0.2198s/iter; left time: 1534.3889s
	iters: 500, epoch: 9 | loss: 0.5373148
	speed: 0.2058s/iter; left time: 1416.2114s
	iters: 600, epoch: 9 | loss: 0.6026635
	speed: 0.2065s/iter; left time: 1400.5402s
Epoch: 9 cost time: 131.5262987613678
Epoch: 9, Steps: 615 | Train Loss: 0.5860368 Vali Loss: 0.4608108 Test Loss: 0.5166297
Validation loss decreased (0.461486 --> 0.460811).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6133526
	speed: 0.1933s/iter; left time: 1288.2098s
	iters: 200, epoch: 10 | loss: 0.6460772
	speed: 0.2096s/iter; left time: 1376.4365s
	iters: 300, epoch: 10 | loss: 0.5189076
	speed: 0.2138s/iter; left time: 1382.1744s
	iters: 400, epoch: 10 | loss: 0.5577340
	speed: 0.2043s/iter; left time: 1300.8170s
	iters: 500, epoch: 10 | loss: 0.5436049
	speed: 0.2105s/iter; left time: 1319.0110s
	iters: 600, epoch: 10 | loss: 0.6795034
	speed: 0.2076s/iter; left time: 1279.9282s
Epoch: 10 cost time: 127.20418572425842
Epoch: 10, Steps: 615 | Train Loss: 0.5852870 Vali Loss: 0.4601231 Test Loss: 0.5164506
Validation loss decreased (0.460811 --> 0.460123).  Saving model ...
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.5624402
	speed: 0.2156s/iter; left time: 1304.8528s
	iters: 200, epoch: 11 | loss: 0.5377793
	speed: 0.2051s/iter; left time: 1220.5930s
	iters: 300, epoch: 11 | loss: 0.5918842
	speed: 0.2212s/iter; left time: 1294.4357s
	iters: 400, epoch: 11 | loss: 0.5457382
	speed: 0.2270s/iter; left time: 1305.6217s
	iters: 500, epoch: 11 | loss: 0.6050296
	speed: 0.1963s/iter; left time: 1109.4597s
	iters: 600, epoch: 11 | loss: 0.6307632
	speed: 0.2049s/iter; left time: 1137.4199s
Epoch: 11 cost time: 130.3088619709015
Epoch: 11, Steps: 615 | Train Loss: 0.5844531 Vali Loss: 0.4602684 Test Loss: 0.5153894
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.6086117
	speed: 0.2238s/iter; left time: 1216.7027s
	iters: 200, epoch: 12 | loss: 0.5828778
	speed: 0.2109s/iter; left time: 1125.3178s
	iters: 300, epoch: 12 | loss: 0.5803066
	speed: 0.2153s/iter; left time: 1127.2054s
	iters: 400, epoch: 12 | loss: 0.5838004
	speed: 0.2216s/iter; left time: 1138.0557s
	iters: 500, epoch: 12 | loss: 0.5729632
	speed: 0.2174s/iter; left time: 1094.8713s
	iters: 600, epoch: 12 | loss: 0.6558551
	speed: 0.2112s/iter; left time: 1042.4622s
Epoch: 12 cost time: 133.43407797813416
Epoch: 12, Steps: 615 | Train Loss: 0.5842910 Vali Loss: 0.4598452 Test Loss: 0.5156098
Validation loss decreased (0.460123 --> 0.459845).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5953549
	speed: 0.2231s/iter; left time: 1075.6588s
	iters: 200, epoch: 13 | loss: 0.5903763
	speed: 0.2197s/iter; left time: 1036.9688s
	iters: 300, epoch: 13 | loss: 0.5799722
	speed: 0.2153s/iter; left time: 994.7519s
	iters: 400, epoch: 13 | loss: 0.5635458
	speed: 0.2132s/iter; left time: 963.6887s
	iters: 500, epoch: 13 | loss: 0.5966138
	speed: 0.2149s/iter; left time: 949.8909s
	iters: 600, epoch: 13 | loss: 0.6184707
	speed: 0.2179s/iter; left time: 941.5287s
Epoch: 13 cost time: 133.99384212493896
Epoch: 13, Steps: 615 | Train Loss: 0.5840069 Vali Loss: 0.4594217 Test Loss: 0.5152289
Validation loss decreased (0.459845 --> 0.459422).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5485362
	speed: 0.2055s/iter; left time: 864.2983s
	iters: 200, epoch: 14 | loss: 0.5426946
	speed: 0.1980s/iter; left time: 812.9648s
	iters: 300, epoch: 14 | loss: 0.5902857
	speed: 0.2159s/iter; left time: 864.9218s
	iters: 400, epoch: 14 | loss: 0.5624138
	speed: 0.2246s/iter; left time: 877.1418s
	iters: 500, epoch: 14 | loss: 0.5746833
	speed: 0.2242s/iter; left time: 853.2412s
	iters: 600, epoch: 14 | loss: 0.5147638
	speed: 0.2164s/iter; left time: 801.9396s
Epoch: 14 cost time: 131.5231785774231
Epoch: 14, Steps: 615 | Train Loss: 0.5836093 Vali Loss: 0.4593492 Test Loss: 0.5146751
Validation loss decreased (0.459422 --> 0.459349).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5899348
	speed: 0.2158s/iter; left time: 774.9620s
	iters: 200, epoch: 15 | loss: 0.6133410
	speed: 0.2066s/iter; left time: 721.0826s
	iters: 300, epoch: 15 | loss: 0.5947368
	speed: 0.2387s/iter; left time: 809.2723s
	iters: 400, epoch: 15 | loss: 0.5656030
	speed: 0.2175s/iter; left time: 715.6870s
	iters: 500, epoch: 15 | loss: 0.5789801
	speed: 0.2203s/iter; left time: 702.8821s
	iters: 600, epoch: 15 | loss: 0.5369516
	speed: 0.2206s/iter; left time: 681.8808s
Epoch: 15 cost time: 135.0201153755188
Epoch: 15, Steps: 615 | Train Loss: 0.5833626 Vali Loss: 0.4594784 Test Loss: 0.5148009
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 16 | loss: 0.5994385
	speed: 0.2146s/iter; left time: 638.6951s
	iters: 200, epoch: 16 | loss: 0.5716723
	speed: 0.2229s/iter; left time: 641.1470s
	iters: 300, epoch: 16 | loss: 0.5639793
	speed: 0.2236s/iter; left time: 620.6783s
	iters: 400, epoch: 16 | loss: 0.5844612
	speed: 0.2136s/iter; left time: 571.5799s
	iters: 500, epoch: 16 | loss: 0.6553320
	speed: 0.2289s/iter; left time: 589.5342s
	iters: 600, epoch: 16 | loss: 0.6322654
	speed: 0.2167s/iter; left time: 536.5485s
Epoch: 16 cost time: 134.9940104484558
Epoch: 16, Steps: 615 | Train Loss: 0.5832040 Vali Loss: 0.4590575 Test Loss: 0.5150411
Validation loss decreased (0.459349 --> 0.459058).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.5924711
	speed: 0.2276s/iter; left time: 537.3330s
	iters: 200, epoch: 17 | loss: 0.6655042
	speed: 0.2246s/iter; left time: 507.7530s
	iters: 300, epoch: 17 | loss: 0.6011424
	speed: 0.2183s/iter; left time: 471.6473s
	iters: 400, epoch: 17 | loss: 0.5761763
	speed: 0.2330s/iter; left time: 480.2012s
	iters: 500, epoch: 17 | loss: 0.5682606
	speed: 0.2164s/iter; left time: 424.3987s
	iters: 600, epoch: 17 | loss: 0.6498022
	speed: 0.2212s/iter; left time: 411.6970s
Epoch: 17 cost time: 136.83667707443237
Epoch: 17, Steps: 615 | Train Loss: 0.5828741 Vali Loss: 0.4587321 Test Loss: 0.5146826
Validation loss decreased (0.459058 --> 0.458732).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5764723
	speed: 0.2346s/iter; left time: 409.5556s
	iters: 200, epoch: 18 | loss: 0.5551481
	speed: 0.2229s/iter; left time: 366.9443s
	iters: 300, epoch: 18 | loss: 0.6028154
	speed: 0.2137s/iter; left time: 330.4136s
	iters: 400, epoch: 18 | loss: 0.5483497
	speed: 0.2231s/iter; left time: 322.6137s
	iters: 500, epoch: 18 | loss: 0.6505855
	speed: 0.2203s/iter; left time: 296.5048s
	iters: 600, epoch: 18 | loss: 0.5871341
	speed: 0.2306s/iter; left time: 287.3500s
Epoch: 18 cost time: 138.3113842010498
Epoch: 18, Steps: 615 | Train Loss: 0.5824691 Vali Loss: 0.4584084 Test Loss: 0.5149718
Validation loss decreased (0.458732 --> 0.458408).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5429054
	speed: 0.2108s/iter; left time: 238.3657s
	iters: 200, epoch: 19 | loss: 0.5518827
	speed: 0.1910s/iter; left time: 196.9017s
	iters: 300, epoch: 19 | loss: 0.5861557
	speed: 0.1956s/iter; left time: 182.0798s
	iters: 400, epoch: 19 | loss: 0.5147973
	speed: 0.2092s/iter; left time: 173.8432s
	iters: 500, epoch: 19 | loss: 0.5822879
	speed: 0.2394s/iter; left time: 175.0059s
	iters: 600, epoch: 19 | loss: 0.5541376
	speed: 0.2454s/iter; left time: 154.8185s
Epoch: 19 cost time: 132.58710956573486
Epoch: 19, Steps: 615 | Train Loss: 0.5822004 Vali Loss: 0.4595840 Test Loss: 0.5145058
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 20 | loss: 0.6261095
	speed: 0.2121s/iter; left time: 109.4592s
	iters: 200, epoch: 20 | loss: 0.5418419
	speed: 0.2059s/iter; left time: 85.6406s
	iters: 300, epoch: 20 | loss: 0.5397555
	speed: 0.1953s/iter; left time: 61.7287s
	iters: 400, epoch: 20 | loss: 0.5672950
	speed: 0.1989s/iter; left time: 42.9531s
	iters: 500, epoch: 20 | loss: 0.5846516
	speed: 0.2154s/iter; left time: 24.9909s
	iters: 600, epoch: 20 | loss: 0.6492711
	speed: 0.2225s/iter; left time: 3.5605s
Epoch: 20 cost time: 128.3309292793274
Epoch: 20, Steps: 615 | Train Loss: 0.5819602 Vali Loss: 0.4598810 Test Loss: 0.5143185
EarlyStopping counter: 2 out of 3
>>>>>>>testing : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7033
mse:0.5137742161750793, mae:0.5198277235031128
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 19657
val 7033
test 7033
	iters: 100, epoch: 1 | loss: 1.2468619
	speed: 0.1831s/iter; left time: 2233.9067s
	iters: 200, epoch: 1 | loss: 0.8603379
	speed: 0.1952s/iter; left time: 2362.2300s
	iters: 300, epoch: 1 | loss: 0.8200014
	speed: 0.2244s/iter; left time: 2693.5212s
	iters: 400, epoch: 1 | loss: 0.7333860
	speed: 0.2079s/iter; left time: 2473.6309s
	iters: 500, epoch: 1 | loss: 0.6944405
	speed: 0.2212s/iter; left time: 2610.0089s
	iters: 600, epoch: 1 | loss: 0.6722828
	speed: 0.2107s/iter; left time: 2465.9439s
Epoch: 1 cost time: 127.41269993782043
Epoch: 1, Steps: 615 | Train Loss: 0.9386156 Vali Loss: 0.5507591 Test Loss: 0.6150339
Validation loss decreased (inf --> 0.550759).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5972852
	speed: 0.1879s/iter; left time: 2177.0318s
	iters: 200, epoch: 2 | loss: 0.6537125
	speed: 0.1935s/iter; left time: 2222.2012s
	iters: 300, epoch: 2 | loss: 0.5802177
	speed: 0.1976s/iter; left time: 2249.7268s
	iters: 400, epoch: 2 | loss: 0.6061105
	speed: 0.2096s/iter; left time: 2365.8704s
	iters: 500, epoch: 2 | loss: 0.6507133
	speed: 0.2073s/iter; left time: 2319.2098s
	iters: 600, epoch: 2 | loss: 0.5789160
	speed: 0.2315s/iter; left time: 2566.5065s
Epoch: 2 cost time: 125.74129104614258
Epoch: 2, Steps: 615 | Train Loss: 0.6491916 Vali Loss: 0.4850869 Test Loss: 0.5485860
Validation loss decreased (0.550759 --> 0.485087).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.6023064
	speed: 0.1708s/iter; left time: 1873.8757s
	iters: 200, epoch: 3 | loss: 0.7260974
	speed: 0.1888s/iter; left time: 2052.4957s
	iters: 300, epoch: 3 | loss: 0.6072969
	speed: 0.1764s/iter; left time: 1899.6767s
	iters: 400, epoch: 3 | loss: 0.5946177
	speed: 0.1844s/iter; left time: 1967.9198s
	iters: 500, epoch: 3 | loss: 0.5967991
	speed: 0.2048s/iter; left time: 2165.0041s
	iters: 600, epoch: 3 | loss: 0.5698715
	speed: 0.2019s/iter; left time: 2113.8752s
Epoch: 3 cost time: 116.14556384086609
Epoch: 3, Steps: 615 | Train Loss: 0.6125041 Vali Loss: 0.4729836 Test Loss: 0.5327328
Validation loss decreased (0.485087 --> 0.472984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5659645
	speed: 0.1949s/iter; left time: 2017.9559s
	iters: 200, epoch: 4 | loss: 0.5972328
	speed: 0.1729s/iter; left time: 1773.0778s
	iters: 300, epoch: 4 | loss: 0.5854705
	speed: 0.1817s/iter; left time: 1845.6791s
	iters: 400, epoch: 4 | loss: 0.6704133
	speed: 0.1956s/iter; left time: 1967.4524s
	iters: 500, epoch: 4 | loss: 0.6173422
	speed: 0.2015s/iter; left time: 2005.8442s
	iters: 600, epoch: 4 | loss: 0.5888283
	speed: 0.2312s/iter; left time: 2278.5782s
Epoch: 4 cost time: 121.43320560455322
Epoch: 4, Steps: 615 | Train Loss: 0.6020889 Vali Loss: 0.4682306 Test Loss: 0.5248888
Validation loss decreased (0.472984 --> 0.468231).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.5909783
	speed: 0.2162s/iter; left time: 2106.4703s
	iters: 200, epoch: 5 | loss: 0.6612216
	speed: 0.1809s/iter; left time: 1743.7340s
	iters: 300, epoch: 5 | loss: 0.5594851
	speed: 0.1883s/iter; left time: 1796.8303s
	iters: 400, epoch: 5 | loss: 0.5781475
	speed: 0.1985s/iter; left time: 1874.0304s
	iters: 500, epoch: 5 | loss: 0.5928640
	speed: 0.2047s/iter; left time: 1912.5201s
	iters: 600, epoch: 5 | loss: 0.6544740
	speed: 0.2208s/iter; left time: 2040.6877s
Epoch: 5 cost time: 124.80220890045166
Epoch: 5, Steps: 615 | Train Loss: 0.5943890 Vali Loss: 0.4632538 Test Loss: 0.5222533
Validation loss decreased (0.468231 --> 0.463254).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5927331
	speed: 0.2209s/iter; left time: 2016.3759s
	iters: 200, epoch: 6 | loss: 0.6220227
	speed: 0.2091s/iter; left time: 1887.1519s
	iters: 300, epoch: 6 | loss: 0.5534035
	speed: 0.2080s/iter; left time: 1856.3442s
	iters: 400, epoch: 6 | loss: 0.5878040
	speed: 0.1857s/iter; left time: 1639.1443s
	iters: 500, epoch: 6 | loss: 0.5551099
	speed: 0.2065s/iter; left time: 1801.8554s
	iters: 600, epoch: 6 | loss: 0.6141577
	speed: 0.2169s/iter; left time: 1871.1412s
Epoch: 6 cost time: 127.83699345588684
Epoch: 6, Steps: 615 | Train Loss: 0.5910971 Vali Loss: 0.4622674 Test Loss: 0.5209844
Validation loss decreased (0.463254 --> 0.462267).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.6444488
	speed: 0.2268s/iter; left time: 1930.2102s
	iters: 200, epoch: 7 | loss: 0.5910029
	speed: 0.2169s/iter; left time: 1824.4210s
	iters: 300, epoch: 7 | loss: 0.6296328
	speed: 0.2151s/iter; left time: 1787.3409s
	iters: 400, epoch: 7 | loss: 0.5024714
	speed: 0.1968s/iter; left time: 1615.5742s
	iters: 500, epoch: 7 | loss: 0.5244715
	speed: 0.2128s/iter; left time: 1726.1263s
	iters: 600, epoch: 7 | loss: 0.5561531
	speed: 0.2060s/iter; left time: 1650.3340s
Epoch: 7 cost time: 130.52423906326294
Epoch: 7, Steps: 615 | Train Loss: 0.5880344 Vali Loss: 0.4613131 Test Loss: 0.5172056
Validation loss decreased (0.462267 --> 0.461313).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5482287
	speed: 0.2027s/iter; left time: 1600.3683s
	iters: 200, epoch: 8 | loss: 0.6224264
	speed: 0.2009s/iter; left time: 1566.2604s
	iters: 300, epoch: 8 | loss: 0.6176931
	speed: 0.2150s/iter; left time: 1654.7068s
	iters: 400, epoch: 8 | loss: 0.6439413
	speed: 0.2275s/iter; left time: 1728.1037s
	iters: 500, epoch: 8 | loss: 0.5492038
	speed: 0.2388s/iter; left time: 1789.8883s
	iters: 600, epoch: 8 | loss: 0.6227925
	speed: 0.2253s/iter; left time: 1666.5463s
Epoch: 8 cost time: 134.69438433647156
Epoch: 8, Steps: 615 | Train Loss: 0.5866062 Vali Loss: 0.4613572 Test Loss: 0.5184560
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.5453659
	speed: 0.2096s/iter; left time: 1526.3271s
	iters: 200, epoch: 9 | loss: 0.5247882
	speed: 0.2228s/iter; left time: 1599.9822s
	iters: 300, epoch: 9 | loss: 0.5514413
	speed: 0.2220s/iter; left time: 1571.8272s
	iters: 400, epoch: 9 | loss: 0.5305192
	speed: 0.2202s/iter; left time: 1537.5268s
	iters: 500, epoch: 9 | loss: 0.5214100
	speed: 0.2334s/iter; left time: 1605.8962s
	iters: 600, epoch: 9 | loss: 0.6346313
	speed: 0.2191s/iter; left time: 1485.9087s
Epoch: 9 cost time: 135.58294248580933
Epoch: 9, Steps: 615 | Train Loss: 0.5849105 Vali Loss: 0.4600360 Test Loss: 0.5162633
Validation loss decreased (0.461313 --> 0.460036).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5344488
	speed: 0.2060s/iter; left time: 1373.5104s
	iters: 200, epoch: 10 | loss: 0.6301889
	speed: 0.1841s/iter; left time: 1208.7938s
	iters: 300, epoch: 10 | loss: 0.5852482
	speed: 0.2272s/iter; left time: 1469.1170s
	iters: 400, epoch: 10 | loss: 0.5719008
	speed: 0.2138s/iter; left time: 1361.1613s
	iters: 500, epoch: 10 | loss: 0.5795311
	speed: 0.2125s/iter; left time: 1331.4721s
	iters: 600, epoch: 10 | loss: 0.5309947
	speed: 0.2301s/iter; left time: 1418.6503s
Epoch: 10 cost time: 130.31573486328125
Epoch: 10, Steps: 615 | Train Loss: 0.5843530 Vali Loss: 0.4598827 Test Loss: 0.5156919
Validation loss decreased (0.460036 --> 0.459883).  Saving model ...
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.5553904
	speed: 0.1973s/iter; left time: 1193.9311s
	iters: 200, epoch: 11 | loss: 0.5472858
	speed: 0.1941s/iter; left time: 1155.3862s
	iters: 300, epoch: 11 | loss: 0.5314037
	speed: 0.1894s/iter; left time: 1107.9647s
	iters: 400, epoch: 11 | loss: 0.5596330
	speed: 0.1480s/iter; left time: 850.9893s
	iters: 500, epoch: 11 | loss: 0.5972803
	speed: 0.1782s/iter; left time: 1006.9141s
	iters: 600, epoch: 11 | loss: 0.5755156
	speed: 0.1884s/iter; left time: 1045.8127s
Epoch: 11 cost time: 112.33306384086609
Epoch: 11, Steps: 615 | Train Loss: 0.5837798 Vali Loss: 0.4602608 Test Loss: 0.5153846
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.6128631
	speed: 0.1476s/iter; left time: 802.5402s
	iters: 200, epoch: 12 | loss: 0.5632849
	speed: 0.1448s/iter; left time: 772.7928s
	iters: 300, epoch: 12 | loss: 0.5647722
	speed: 0.1768s/iter; left time: 925.5820s
	iters: 400, epoch: 12 | loss: 0.5682901
	speed: 0.1852s/iter; left time: 951.0937s
	iters: 500, epoch: 12 | loss: 0.6016940
	speed: 0.1717s/iter; left time: 864.5334s
	iters: 600, epoch: 12 | loss: 0.5695895
	speed: 0.1238s/iter; left time: 610.8714s
Epoch: 12 cost time: 96.72801780700684
Epoch: 12, Steps: 615 | Train Loss: 0.5832383 Vali Loss: 0.4594547 Test Loss: 0.5157063
Validation loss decreased (0.459883 --> 0.459455).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5979449
	speed: 0.1906s/iter; left time: 918.8846s
	iters: 200, epoch: 13 | loss: 0.5486749
	speed: 0.1567s/iter; left time: 739.8702s
	iters: 300, epoch: 13 | loss: 0.7228801
	speed: 0.1659s/iter; left time: 766.8246s
	iters: 400, epoch: 13 | loss: 0.6137278
	speed: 0.1382s/iter; left time: 624.9282s
	iters: 500, epoch: 13 | loss: 0.6579865
	speed: 0.1472s/iter; left time: 650.7987s
	iters: 600, epoch: 13 | loss: 0.5868576
	speed: 0.1363s/iter; left time: 589.1483s
Epoch: 13 cost time: 95.38505387306213
Epoch: 13, Steps: 615 | Train Loss: 0.5828916 Vali Loss: 0.4588842 Test Loss: 0.5152225
Validation loss decreased (0.459455 --> 0.458884).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5831124
	speed: 0.1301s/iter; left time: 547.1433s
	iters: 200, epoch: 14 | loss: 0.5499032
	speed: 0.1447s/iter; left time: 593.9925s
	iters: 300, epoch: 14 | loss: 0.6085777
	speed: 0.1577s/iter; left time: 631.6735s
	iters: 400, epoch: 14 | loss: 0.6002325
	speed: 0.1659s/iter; left time: 647.8728s
	iters: 500, epoch: 14 | loss: 0.5282147
	speed: 0.2128s/iter; left time: 809.8152s
	iters: 600, epoch: 14 | loss: 0.5691518
	speed: 0.1936s/iter; left time: 717.3281s
Epoch: 14 cost time: 102.54406189918518
Epoch: 14, Steps: 615 | Train Loss: 0.5825499 Vali Loss: 0.4598270 Test Loss: 0.5147261
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 15 | loss: 0.5672926
	speed: 0.1671s/iter; left time: 600.1988s
	iters: 200, epoch: 15 | loss: 0.6091793
	speed: 0.1250s/iter; left time: 436.2112s
	iters: 300, epoch: 15 | loss: 0.5846615
	speed: 0.1361s/iter; left time: 461.5707s
	iters: 400, epoch: 15 | loss: 0.5788790
	speed: 0.1666s/iter; left time: 548.3533s
	iters: 500, epoch: 15 | loss: 0.5465831
	speed: 0.1300s/iter; left time: 414.7285s
	iters: 600, epoch: 15 | loss: 0.6535448
	speed: 0.1280s/iter; left time: 395.6260s
Epoch: 15 cost time: 89.09528160095215
Epoch: 15, Steps: 615 | Train Loss: 0.5822403 Vali Loss: 0.4576650 Test Loss: 0.5152401
Validation loss decreased (0.458884 --> 0.457665).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6275638
	speed: 0.1449s/iter; left time: 431.3242s
	iters: 200, epoch: 16 | loss: 0.5522330
	speed: 0.2037s/iter; left time: 585.8827s
	iters: 300, epoch: 16 | loss: 0.5542947
	speed: 0.2070s/iter; left time: 574.7595s
	iters: 400, epoch: 16 | loss: 0.5758266
	speed: 0.1574s/iter; left time: 421.0871s
	iters: 500, epoch: 16 | loss: 0.5409471
	speed: 0.1318s/iter; left time: 339.4335s
	iters: 600, epoch: 16 | loss: 0.5408205
	speed: 0.1408s/iter; left time: 348.6986s
Epoch: 16 cost time: 100.90214323997498
Epoch: 16, Steps: 615 | Train Loss: 0.5820851 Vali Loss: 0.4587445 Test Loss: 0.5148333
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 17 | loss: 0.5562919
	speed: 0.1708s/iter; left time: 403.1545s
	iters: 200, epoch: 17 | loss: 0.5446919
	speed: 0.1653s/iter; left time: 373.7899s
	iters: 300, epoch: 17 | loss: 0.6179246
	speed: 0.1970s/iter; left time: 425.8127s
	iters: 400, epoch: 17 | loss: 0.5301291
	speed: 0.2162s/iter; left time: 445.6134s
	iters: 500, epoch: 17 | loss: 0.6264248
	speed: 0.1902s/iter; left time: 372.9260s
	iters: 600, epoch: 17 | loss: 0.5861492
	speed: 0.1694s/iter; left time: 315.2652s
Epoch: 17 cost time: 112.97941517829895
Epoch: 17, Steps: 615 | Train Loss: 0.5817077 Vali Loss: 0.4583265 Test Loss: 0.5139799
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 18 | loss: 0.6258095
	speed: 0.1976s/iter; left time: 345.0087s
	iters: 200, epoch: 18 | loss: 0.6115511
	speed: 0.1547s/iter; left time: 254.5691s
	iters: 300, epoch: 18 | loss: 0.5120209
	speed: 0.1905s/iter; left time: 294.4591s
	iters: 400, epoch: 18 | loss: 0.5566413
	speed: 0.1847s/iter; left time: 267.0450s
	iters: 500, epoch: 18 | loss: 0.5710231
	speed: 0.1673s/iter; left time: 225.1767s
	iters: 600, epoch: 18 | loss: 0.5731949
	speed: 0.1731s/iter; left time: 215.7230s
Epoch: 18 cost time: 110.85220146179199
Epoch: 18, Steps: 615 | Train Loss: 0.5812840 Vali Loss: 0.4593341 Test Loss: 0.5144747
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7033
mse:0.5140416026115417, mae:0.5195030570030212
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 19657
val 7033
test 7033
	iters: 100, epoch: 1 | loss: 1.1217666
	speed: 0.1611s/iter; left time: 1965.8641s
	iters: 200, epoch: 1 | loss: 0.9800086
	speed: 0.1686s/iter; left time: 2040.6948s
	iters: 300, epoch: 1 | loss: 0.7819614
	speed: 0.1342s/iter; left time: 1610.7685s
	iters: 400, epoch: 1 | loss: 0.7718928
	speed: 0.1267s/iter; left time: 1507.3929s
	iters: 500, epoch: 1 | loss: 0.8518194
	speed: 0.1313s/iter; left time: 1549.9577s
	iters: 600, epoch: 1 | loss: 0.7174649
	speed: 0.1458s/iter; left time: 1705.7639s
Epoch: 1 cost time: 89.98579168319702
Epoch: 1, Steps: 615 | Train Loss: 0.9452702 Vali Loss: 0.5484619 Test Loss: 0.6117095
Validation loss decreased (inf --> 0.548462).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6656393
	speed: 0.1250s/iter; left time: 1448.4009s
	iters: 200, epoch: 2 | loss: 0.6415451
	speed: 0.1211s/iter; left time: 1390.7279s
	iters: 300, epoch: 2 | loss: 0.6542835
	speed: 0.1292s/iter; left time: 1471.3831s
	iters: 400, epoch: 2 | loss: 0.6710452
	speed: 0.1326s/iter; left time: 1496.9069s
	iters: 500, epoch: 2 | loss: 0.6441299
	speed: 0.1307s/iter; left time: 1461.5959s
	iters: 600, epoch: 2 | loss: 0.6277952
	speed: 0.1691s/iter; left time: 1874.6112s
Epoch: 2 cost time: 83.39291667938232
Epoch: 2, Steps: 615 | Train Loss: 0.6488952 Vali Loss: 0.4846523 Test Loss: 0.5464035
Validation loss decreased (0.548462 --> 0.484652).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.6256090
	speed: 0.1791s/iter; left time: 1965.2144s
	iters: 200, epoch: 3 | loss: 0.6176229
	speed: 0.1857s/iter; left time: 2018.8306s
	iters: 300, epoch: 3 | loss: 0.6477027
	speed: 0.1718s/iter; left time: 1849.9364s
	iters: 400, epoch: 3 | loss: 0.5707065
	speed: 0.1385s/iter; left time: 1478.2230s
	iters: 500, epoch: 3 | loss: 0.6629623
	speed: 0.1237s/iter; left time: 1308.0037s
	iters: 600, epoch: 3 | loss: 0.6027271
	speed: 0.1369s/iter; left time: 1433.4113s
Epoch: 3 cost time: 96.66951656341553
Epoch: 3, Steps: 615 | Train Loss: 0.6142460 Vali Loss: 0.4741686 Test Loss: 0.5347678
Validation loss decreased (0.484652 --> 0.474169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6076385
	speed: 0.1386s/iter; left time: 1435.6621s
	iters: 200, epoch: 4 | loss: 0.5911211
	speed: 0.1363s/iter; left time: 1398.2961s
	iters: 300, epoch: 4 | loss: 0.6599545
	speed: 0.1260s/iter; left time: 1279.4409s
	iters: 400, epoch: 4 | loss: 0.7268304
	speed: 0.1450s/iter; left time: 1457.7265s
	iters: 500, epoch: 4 | loss: 0.6821243
	speed: 0.1403s/iter; left time: 1397.2355s
	iters: 600, epoch: 4 | loss: 0.6341489
	speed: 0.1890s/iter; left time: 1862.9449s
Epoch: 4 cost time: 89.81403088569641
Epoch: 4, Steps: 615 | Train Loss: 0.6039951 Vali Loss: 0.4689897 Test Loss: 0.5243954
Validation loss decreased (0.474169 --> 0.468990).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.6394289
	speed: 0.1338s/iter; left time: 1303.4264s
	iters: 200, epoch: 5 | loss: 0.6677398
	speed: 0.1425s/iter; left time: 1373.9409s
	iters: 300, epoch: 5 | loss: 0.6211823
	speed: 0.1602s/iter; left time: 1528.3244s
	iters: 400, epoch: 5 | loss: 0.6020682
	speed: 0.1859s/iter; left time: 1754.9976s
	iters: 500, epoch: 5 | loss: 0.5352886
	speed: 0.1507s/iter; left time: 1407.6803s
	iters: 600, epoch: 5 | loss: 0.6237178
	speed: 0.1432s/iter; left time: 1323.3632s
Epoch: 5 cost time: 93.33208394050598
Epoch: 5, Steps: 615 | Train Loss: 0.5958991 Vali Loss: 0.4667959 Test Loss: 0.5224375
Validation loss decreased (0.468990 --> 0.466796).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.6499939
	speed: 0.1773s/iter; left time: 1617.5857s
	iters: 200, epoch: 6 | loss: 0.5492540
	speed: 0.1453s/iter; left time: 1311.1251s
	iters: 300, epoch: 6 | loss: 0.5826550
	speed: 0.1417s/iter; left time: 1264.9760s
	iters: 400, epoch: 6 | loss: 0.6041321
	speed: 0.1407s/iter; left time: 1241.9956s
	iters: 500, epoch: 6 | loss: 0.5549610
	speed: 0.1230s/iter; left time: 1073.4403s
	iters: 600, epoch: 6 | loss: 0.6297951
	speed: 0.1284s/iter; left time: 1107.7121s
Epoch: 6 cost time: 87.63263750076294
Epoch: 6, Steps: 615 | Train Loss: 0.5924457 Vali Loss: 0.4617026 Test Loss: 0.5195103
Validation loss decreased (0.466796 --> 0.461703).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.5527368
	speed: 0.1516s/iter; left time: 1290.6458s
	iters: 200, epoch: 7 | loss: 0.5789199
	speed: 0.1998s/iter; left time: 1680.8455s
	iters: 300, epoch: 7 | loss: 0.5322485
	speed: 0.1906s/iter; left time: 1583.8998s
	iters: 400, epoch: 7 | loss: 0.5868391
	speed: 0.2000s/iter; left time: 1642.5016s
	iters: 500, epoch: 7 | loss: 0.5524129
	speed: 0.2015s/iter; left time: 1634.1046s
	iters: 600, epoch: 7 | loss: 0.6673918
	speed: 0.2024s/iter; left time: 1621.4570s
Epoch: 7 cost time: 116.55298447608948
Epoch: 7, Steps: 615 | Train Loss: 0.5891071 Vali Loss: 0.4628549 Test Loss: 0.5176336
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.5409164
	speed: 0.1797s/iter; left time: 1418.7694s
	iters: 200, epoch: 8 | loss: 0.5483047
	speed: 0.1699s/iter; left time: 1324.9157s
	iters: 300, epoch: 8 | loss: 0.5136446
	speed: 0.1732s/iter; left time: 1333.0723s
	iters: 400, epoch: 8 | loss: 0.6376536
	speed: 0.2047s/iter; left time: 1555.2116s
	iters: 500, epoch: 8 | loss: 0.6222186
	speed: 0.2021s/iter; left time: 1515.1737s
	iters: 600, epoch: 8 | loss: 0.5828893
	speed: 0.1893s/iter; left time: 1400.1602s
Epoch: 8 cost time: 114.92689871788025
Epoch: 8, Steps: 615 | Train Loss: 0.5877849 Vali Loss: 0.4626255 Test Loss: 0.5175851
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.5748776
	speed: 0.1569s/iter; left time: 1142.0580s
	iters: 200, epoch: 9 | loss: 0.6213084
	speed: 0.1683s/iter; left time: 1208.5939s
	iters: 300, epoch: 9 | loss: 0.6249533
	speed: 0.1452s/iter; left time: 1028.4505s
	iters: 400, epoch: 9 | loss: 0.5960168
	speed: 0.1276s/iter; left time: 890.8805s
	iters: 500, epoch: 9 | loss: 0.6110380
	speed: 0.1286s/iter; left time: 884.6533s
	iters: 600, epoch: 9 | loss: 0.5847447
	speed: 0.1344s/iter; left time: 911.2084s
Epoch: 9 cost time: 87.78763699531555
Epoch: 9, Steps: 615 | Train Loss: 0.5862181 Vali Loss: 0.4604903 Test Loss: 0.5161615
Validation loss decreased (0.461703 --> 0.460490).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5327810
	speed: 0.1431s/iter; left time: 953.9031s
	iters: 200, epoch: 10 | loss: 0.5433621
	speed: 0.1426s/iter; left time: 936.2526s
	iters: 300, epoch: 10 | loss: 0.6033918
	speed: 0.1261s/iter; left time: 815.3665s
	iters: 400, epoch: 10 | loss: 0.6682463
	speed: 0.1255s/iter; left time: 798.6724s
	iters: 500, epoch: 10 | loss: 0.6319414
	speed: 0.1453s/iter; left time: 910.7048s
	iters: 600, epoch: 10 | loss: 0.5715405
	speed: 0.1584s/iter; left time: 976.8841s
Epoch: 10 cost time: 87.02495074272156
Epoch: 10, Steps: 615 | Train Loss: 0.5853675 Vali Loss: 0.4596026 Test Loss: 0.5154956
Validation loss decreased (0.460490 --> 0.459603).  Saving model ...
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.5844805
	speed: 0.1300s/iter; left time: 786.3874s
	iters: 200, epoch: 11 | loss: 0.5802779
	speed: 0.1226s/iter; left time: 729.3222s
	iters: 300, epoch: 11 | loss: 0.5898166
	speed: 0.1714s/iter; left time: 1002.7275s
	iters: 400, epoch: 11 | loss: 0.6348054
	speed: 0.1766s/iter; left time: 1015.5120s
	iters: 500, epoch: 11 | loss: 0.5586184
	speed: 0.1856s/iter; left time: 1048.8804s
	iters: 600, epoch: 11 | loss: 0.5185481
	speed: 0.1574s/iter; left time: 873.9788s
Epoch: 11 cost time: 96.95633792877197
Epoch: 11, Steps: 615 | Train Loss: 0.5846227 Vali Loss: 0.4597048 Test Loss: 0.5151623
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.5299472
	speed: 0.1385s/iter; left time: 753.0347s
	iters: 200, epoch: 12 | loss: 0.5588849
	speed: 0.1343s/iter; left time: 716.6224s
	iters: 300, epoch: 12 | loss: 0.5045877
	speed: 0.1349s/iter; left time: 706.0814s
	iters: 400, epoch: 12 | loss: 0.6122570
	speed: 0.1456s/iter; left time: 747.5831s
	iters: 500, epoch: 12 | loss: 0.5943864
	speed: 0.1357s/iter; left time: 683.1949s
	iters: 600, epoch: 12 | loss: 0.5983009
	speed: 0.1442s/iter; left time: 711.6742s
Epoch: 12 cost time: 84.9849112033844
Epoch: 12, Steps: 615 | Train Loss: 0.5843663 Vali Loss: 0.4594272 Test Loss: 0.5149587
Validation loss decreased (0.459603 --> 0.459427).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.6307938
	speed: 0.1895s/iter; left time: 913.6623s
	iters: 200, epoch: 13 | loss: 0.5772874
	speed: 0.1742s/iter; left time: 822.2018s
	iters: 300, epoch: 13 | loss: 0.5970666
	speed: 0.1820s/iter; left time: 841.0505s
	iters: 400, epoch: 13 | loss: 0.5661944
	speed: 0.1507s/iter; left time: 681.4026s
	iters: 500, epoch: 13 | loss: 0.6285923
	speed: 0.1314s/iter; left time: 580.7911s
	iters: 600, epoch: 13 | loss: 0.6020744
	speed: 0.1415s/iter; left time: 611.4600s
Epoch: 13 cost time: 99.08948016166687
Epoch: 13, Steps: 615 | Train Loss: 0.5842386 Vali Loss: 0.4589829 Test Loss: 0.5148272
Validation loss decreased (0.459427 --> 0.458983).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6484584
	speed: 0.1485s/iter; left time: 624.5492s
	iters: 200, epoch: 14 | loss: 0.5822915
	speed: 0.1588s/iter; left time: 652.1082s
	iters: 300, epoch: 14 | loss: 0.5417683
	speed: 0.1697s/iter; left time: 679.6229s
	iters: 400, epoch: 14 | loss: 0.5552521
	speed: 0.1528s/iter; left time: 596.8735s
	iters: 500, epoch: 14 | loss: 0.5917259
	speed: 0.1455s/iter; left time: 553.9414s
	iters: 600, epoch: 14 | loss: 0.6486681
	speed: 0.1664s/iter; left time: 616.6319s
Epoch: 14 cost time: 96.31569409370422
Epoch: 14, Steps: 615 | Train Loss: 0.5838281 Vali Loss: 0.4589972 Test Loss: 0.5143296
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 15 | loss: 0.6304310
	speed: 0.1310s/iter; left time: 470.4737s
	iters: 200, epoch: 15 | loss: 0.6761888
	speed: 0.1830s/iter; left time: 638.8168s
	iters: 300, epoch: 15 | loss: 0.5479686
	speed: 0.1725s/iter; left time: 584.7863s
	iters: 400, epoch: 15 | loss: 0.5773075
	speed: 0.1819s/iter; left time: 598.5027s
	iters: 500, epoch: 15 | loss: 0.5937380
	speed: 0.1482s/iter; left time: 472.8766s
	iters: 600, epoch: 15 | loss: 0.6099359
	speed: 0.1401s/iter; left time: 433.0408s
Epoch: 15 cost time: 97.53971886634827
Epoch: 15, Steps: 615 | Train Loss: 0.5835257 Vali Loss: 0.4593155 Test Loss: 0.5143262
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 16 | loss: 0.5890357
	speed: 0.1430s/iter; left time: 425.5805s
	iters: 200, epoch: 16 | loss: 0.6287416
	speed: 0.1422s/iter; left time: 409.0833s
	iters: 300, epoch: 16 | loss: 0.5609049
	speed: 0.1348s/iter; left time: 374.3297s
	iters: 400, epoch: 16 | loss: 0.5937373
	speed: 0.1542s/iter; left time: 412.7205s
	iters: 500, epoch: 16 | loss: 0.5531529
	speed: 0.1288s/iter; left time: 331.8829s
	iters: 600, epoch: 16 | loss: 0.5921282
	speed: 0.1385s/iter; left time: 342.8136s
Epoch: 16 cost time: 87.4770393371582
Epoch: 16, Steps: 615 | Train Loss: 0.5830380 Vali Loss: 0.4591037 Test Loss: 0.5139430
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7033
mse:0.5136032700538635, mae:0.5182788968086243
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 19657
val 7033
test 7033
	iters: 100, epoch: 1 | loss: 1.1302474
	speed: 0.1702s/iter; left time: 2076.7500s
	iters: 200, epoch: 1 | loss: 0.8521395
	speed: 0.1663s/iter; left time: 2012.2187s
	iters: 300, epoch: 1 | loss: 0.7869566
	speed: 0.1358s/iter; left time: 1630.0947s
	iters: 400, epoch: 1 | loss: 0.8000442
	speed: 0.1392s/iter; left time: 1656.6284s
	iters: 500, epoch: 1 | loss: 0.6682928
	speed: 0.1327s/iter; left time: 1566.2968s
	iters: 600, epoch: 1 | loss: 0.6941224
	speed: 0.1399s/iter; left time: 1636.3854s
Epoch: 1 cost time: 90.33613109588623
Epoch: 1, Steps: 615 | Train Loss: 0.9291659 Vali Loss: 0.5481050 Test Loss: 0.6111944
Validation loss decreased (inf --> 0.548105).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6639876
	speed: 0.1433s/iter; left time: 1660.6014s
	iters: 200, epoch: 2 | loss: 0.6817365
	speed: 0.1771s/iter; left time: 2034.4917s
	iters: 300, epoch: 2 | loss: 0.6922545
	speed: 0.1610s/iter; left time: 1832.8134s
	iters: 400, epoch: 2 | loss: 0.6775802
	speed: 0.1997s/iter; left time: 2254.0165s
	iters: 500, epoch: 2 | loss: 0.5812212
	speed: 0.2022s/iter; left time: 2261.4008s
	iters: 600, epoch: 2 | loss: 0.6318645
	speed: 0.1635s/iter; left time: 1812.4032s
Epoch: 2 cost time: 107.58064579963684
Epoch: 2, Steps: 615 | Train Loss: 0.6474992 Vali Loss: 0.4859091 Test Loss: 0.5423776
Validation loss decreased (0.548105 --> 0.485909).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.5889546
	speed: 0.1421s/iter; left time: 1558.9223s
	iters: 200, epoch: 3 | loss: 0.5871528
	speed: 0.1491s/iter; left time: 1620.4983s
	iters: 300, epoch: 3 | loss: 0.5751646
	speed: 0.1357s/iter; left time: 1462.1316s
	iters: 400, epoch: 3 | loss: 0.5608116
	speed: 0.1430s/iter; left time: 1526.1879s
	iters: 500, epoch: 3 | loss: 0.6096874
	speed: 0.1340s/iter; left time: 1416.5624s
	iters: 600, epoch: 3 | loss: 0.6538377
	speed: 0.1740s/iter; left time: 1821.5532s
Epoch: 3 cost time: 90.46800804138184
Epoch: 3, Steps: 615 | Train Loss: 0.6128009 Vali Loss: 0.4734484 Test Loss: 0.5306328
Validation loss decreased (0.485909 --> 0.473448).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6201653
	speed: 0.1234s/iter; left time: 1277.5372s
	iters: 200, epoch: 4 | loss: 0.6057941
	speed: 0.1194s/iter; left time: 1224.1352s
	iters: 300, epoch: 4 | loss: 0.5856561
	speed: 0.1431s/iter; left time: 1453.5397s
	iters: 400, epoch: 4 | loss: 0.6371561
	speed: 0.1705s/iter; left time: 1714.2786s
	iters: 500, epoch: 4 | loss: 0.6029874
	speed: 0.1387s/iter; left time: 1380.5521s
	iters: 600, epoch: 4 | loss: 0.6635475
	speed: 0.1514s/iter; left time: 1492.4245s
Epoch: 4 cost time: 86.33065223693848
Epoch: 4, Steps: 615 | Train Loss: 0.6022058 Vali Loss: 0.4662292 Test Loss: 0.5239934
Validation loss decreased (0.473448 --> 0.466229).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.6761081
	speed: 0.1749s/iter; left time: 1703.2233s
	iters: 200, epoch: 5 | loss: 0.6388865
	speed: 0.1823s/iter; left time: 1757.6953s
	iters: 300, epoch: 5 | loss: 0.6058248
	speed: 0.1874s/iter; left time: 1787.7837s
	iters: 400, epoch: 5 | loss: 0.7210608
	speed: 0.1178s/iter; left time: 1112.1985s
	iters: 500, epoch: 5 | loss: 0.5957963
	speed: 0.1351s/iter; left time: 1261.5089s
	iters: 600, epoch: 5 | loss: 0.5913525
	speed: 0.1259s/iter; left time: 1163.3232s
Epoch: 5 cost time: 94.17520213127136
Epoch: 5, Steps: 615 | Train Loss: 0.5946008 Vali Loss: 0.4636787 Test Loss: 0.5203483
Validation loss decreased (0.466229 --> 0.463679).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5791032
	speed: 0.1224s/iter; left time: 1117.2826s
	iters: 200, epoch: 6 | loss: 0.5680311
	speed: 0.1230s/iter; left time: 1110.4264s
	iters: 300, epoch: 6 | loss: 0.5927992
	speed: 0.1197s/iter; left time: 1068.6863s
	iters: 400, epoch: 6 | loss: 0.5710943
	speed: 0.1238s/iter; left time: 1092.4856s
	iters: 500, epoch: 6 | loss: 0.5682790
	speed: 0.1219s/iter; left time: 1063.5337s
	iters: 600, epoch: 6 | loss: 0.7075825
	speed: 0.1320s/iter; left time: 1138.5293s
Epoch: 6 cost time: 76.03565812110901
Epoch: 6, Steps: 615 | Train Loss: 0.5913752 Vali Loss: 0.4629373 Test Loss: 0.5193018
Validation loss decreased (0.463679 --> 0.462937).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.5302538
	speed: 0.1437s/iter; left time: 1223.3207s
	iters: 200, epoch: 7 | loss: 0.6547310
	speed: 0.1319s/iter; left time: 1109.2584s
	iters: 300, epoch: 7 | loss: 0.5871202
	speed: 0.1609s/iter; left time: 1336.9298s
	iters: 400, epoch: 7 | loss: 0.5115869
	speed: 0.1462s/iter; left time: 1200.3086s
	iters: 500, epoch: 7 | loss: 0.6093388
	speed: 0.1538s/iter; left time: 1247.8588s
	iters: 600, epoch: 7 | loss: 0.5424997
	speed: 0.1121s/iter; left time: 898.0378s
Epoch: 7 cost time: 86.29654002189636
Epoch: 7, Steps: 615 | Train Loss: 0.5882906 Vali Loss: 0.4597464 Test Loss: 0.5168687
Validation loss decreased (0.462937 --> 0.459746).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5640370
	speed: 0.1188s/iter; left time: 937.9801s
	iters: 200, epoch: 8 | loss: 0.5560528
	speed: 0.1224s/iter; left time: 954.0193s
	iters: 300, epoch: 8 | loss: 0.5729619
	speed: 0.1166s/iter; left time: 897.4386s
	iters: 400, epoch: 8 | loss: 0.6857398
	speed: 0.1251s/iter; left time: 950.5285s
	iters: 500, epoch: 8 | loss: 0.6467553
	speed: 0.1194s/iter; left time: 895.3902s
	iters: 600, epoch: 8 | loss: 0.6343820
	speed: 0.1276s/iter; left time: 943.4148s
Epoch: 8 cost time: 74.6600444316864
Epoch: 8, Steps: 615 | Train Loss: 0.5868771 Vali Loss: 0.4589338 Test Loss: 0.5159935
Validation loss decreased (0.459746 --> 0.458934).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.5328684
	speed: 0.1099s/iter; left time: 799.9777s
	iters: 200, epoch: 9 | loss: 0.5662719
	speed: 0.1289s/iter; left time: 925.6703s
	iters: 300, epoch: 9 | loss: 0.5735070
	speed: 0.1091s/iter; left time: 772.5064s
	iters: 400, epoch: 9 | loss: 0.5793803
	speed: 0.1118s/iter; left time: 780.4145s
	iters: 500, epoch: 9 | loss: 0.5584700
	speed: 0.1122s/iter; left time: 771.8842s
	iters: 600, epoch: 9 | loss: 0.5592561
	speed: 0.1157s/iter; left time: 784.7946s
Epoch: 9 cost time: 70.44269967079163
Epoch: 9, Steps: 615 | Train Loss: 0.5852168 Vali Loss: 0.4603309 Test Loss: 0.5149359
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 10 | loss: 0.5799669
	speed: 0.1183s/iter; left time: 788.7869s
	iters: 200, epoch: 10 | loss: 0.6143236
	speed: 0.1102s/iter; left time: 723.7497s
	iters: 300, epoch: 10 | loss: 0.6406530
	speed: 0.1144s/iter; left time: 739.5987s
	iters: 400, epoch: 10 | loss: 0.6070917
	speed: 0.1219s/iter; left time: 776.2339s
	iters: 500, epoch: 10 | loss: 0.5933521
	speed: 0.1151s/iter; left time: 721.3184s
	iters: 600, epoch: 10 | loss: 0.5683323
	speed: 0.1147s/iter; left time: 707.2901s
Epoch: 10 cost time: 71.13717007637024
Epoch: 10, Steps: 615 | Train Loss: 0.5845720 Vali Loss: 0.4596282 Test Loss: 0.5147661
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.6592042
	speed: 0.1113s/iter; left time: 673.5797s
	iters: 200, epoch: 11 | loss: 0.5329478
	speed: 0.1095s/iter; left time: 651.5400s
	iters: 300, epoch: 11 | loss: 0.6106916
	speed: 0.1080s/iter; left time: 631.7665s
	iters: 400, epoch: 11 | loss: 0.5900367
	speed: 0.1116s/iter; left time: 641.7490s
	iters: 500, epoch: 11 | loss: 0.5660722
	speed: 0.1132s/iter; left time: 639.9611s
	iters: 600, epoch: 11 | loss: 0.5151110
	speed: 0.1171s/iter; left time: 649.8776s
Epoch: 11 cost time: 68.69242024421692
Epoch: 11, Steps: 615 | Train Loss: 0.5838235 Vali Loss: 0.4586609 Test Loss: 0.5142884
Validation loss decreased (0.458934 --> 0.458661).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.6835711
	speed: 0.1192s/iter; left time: 648.2340s
	iters: 200, epoch: 12 | loss: 0.6253606
	speed: 0.1144s/iter; left time: 610.3235s
	iters: 300, epoch: 12 | loss: 0.6635911
	speed: 0.1147s/iter; left time: 600.3360s
	iters: 400, epoch: 12 | loss: 0.6158435
	speed: 0.1107s/iter; left time: 568.6328s
	iters: 500, epoch: 12 | loss: 0.6275381
	speed: 0.1116s/iter; left time: 561.9990s
	iters: 600, epoch: 12 | loss: 0.5805531
	speed: 0.1138s/iter; left time: 561.4770s
Epoch: 12 cost time: 70.40516710281372
Epoch: 12, Steps: 615 | Train Loss: 0.5834182 Vali Loss: 0.4587716 Test Loss: 0.5142496
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 13 | loss: 0.5751300
	speed: 0.1346s/iter; left time: 648.7879s
	iters: 200, epoch: 13 | loss: 0.5335192
	speed: 0.1016s/iter; left time: 479.4904s
	iters: 300, epoch: 13 | loss: 0.5496004
	speed: 0.1114s/iter; left time: 514.7443s
	iters: 400, epoch: 13 | loss: 0.6136254
	speed: 0.1154s/iter; left time: 521.9129s
	iters: 500, epoch: 13 | loss: 0.5878898
	speed: 0.1112s/iter; left time: 491.5545s
	iters: 600, epoch: 13 | loss: 0.5469974
	speed: 0.1146s/iter; left time: 495.3097s
Epoch: 13 cost time: 70.71452355384827
Epoch: 13, Steps: 615 | Train Loss: 0.5833036 Vali Loss: 0.4587449 Test Loss: 0.5141266
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 14 | loss: 0.6017109
	speed: 0.1335s/iter; left time: 561.3849s
	iters: 200, epoch: 14 | loss: 0.5351042
	speed: 0.1244s/iter; left time: 510.7347s
	iters: 300, epoch: 14 | loss: 0.5337469
	speed: 0.1133s/iter; left time: 453.8084s
	iters: 400, epoch: 14 | loss: 0.5080384
	speed: 0.1153s/iter; left time: 450.4844s
	iters: 500, epoch: 14 | loss: 0.5201282
	speed: 0.1125s/iter; left time: 428.1770s
	iters: 600, epoch: 14 | loss: 0.5874990
	speed: 0.1110s/iter; left time: 411.4764s
Epoch: 14 cost time: 72.63143229484558
Epoch: 14, Steps: 615 | Train Loss: 0.5830709 Vali Loss: 0.4586160 Test Loss: 0.5136722
Validation loss decreased (0.458661 --> 0.458616).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5929970
	speed: 0.1110s/iter; left time: 398.4953s
	iters: 200, epoch: 15 | loss: 0.6011020
	speed: 0.1108s/iter; left time: 386.7220s
	iters: 300, epoch: 15 | loss: 0.6213569
	speed: 0.1218s/iter; left time: 413.0806s
	iters: 400, epoch: 15 | loss: 0.6411325
	speed: 0.1078s/iter; left time: 354.6281s
	iters: 500, epoch: 15 | loss: 0.5539689
	speed: 0.1154s/iter; left time: 368.3368s
	iters: 600, epoch: 15 | loss: 0.5878230
	speed: 0.1122s/iter; left time: 346.6791s
Epoch: 15 cost time: 69.5061948299408
Epoch: 15, Steps: 615 | Train Loss: 0.5824901 Vali Loss: 0.4582089 Test Loss: 0.5141756
Validation loss decreased (0.458616 --> 0.458209).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5773948
	speed: 0.1276s/iter; left time: 379.8235s
	iters: 200, epoch: 16 | loss: 0.6293905
	speed: 0.1289s/iter; left time: 370.8377s
	iters: 300, epoch: 16 | loss: 0.5824411
	speed: 0.1236s/iter; left time: 343.1631s
	iters: 400, epoch: 16 | loss: 0.5986917
	speed: 0.1101s/iter; left time: 294.6090s
	iters: 500, epoch: 16 | loss: 0.5297645
	speed: 0.1099s/iter; left time: 283.0339s
	iters: 600, epoch: 16 | loss: 0.5342110
	speed: 0.1146s/iter; left time: 283.7560s
Epoch: 16 cost time: 73.078941822052
Epoch: 16, Steps: 615 | Train Loss: 0.5823041 Vali Loss: 0.4583658 Test Loss: 0.5131531
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 17 | loss: 0.5605912
	speed: 0.1254s/iter; left time: 295.9940s
	iters: 200, epoch: 17 | loss: 0.6249680
	speed: 0.1083s/iter; left time: 244.9101s
	iters: 300, epoch: 17 | loss: 0.6128205
	speed: 0.1244s/iter; left time: 268.9268s
	iters: 400, epoch: 17 | loss: 0.5317563
	speed: 0.1108s/iter; left time: 228.2952s
	iters: 500, epoch: 17 | loss: 0.5496607
	speed: 0.1303s/iter; left time: 255.5099s
	iters: 600, epoch: 17 | loss: 0.6654485
	speed: 0.1169s/iter; left time: 217.5569s
Epoch: 17 cost time: 73.27319121360779
Epoch: 17, Steps: 615 | Train Loss: 0.5820274 Vali Loss: 0.4579752 Test Loss: 0.5132072
Validation loss decreased (0.458209 --> 0.457975).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5683463
	speed: 0.1126s/iter; left time: 196.5585s
	iters: 200, epoch: 18 | loss: 0.5126199
	speed: 0.1144s/iter; left time: 188.3549s
	iters: 300, epoch: 18 | loss: 0.5942907
	speed: 0.1253s/iter; left time: 193.7402s
	iters: 400, epoch: 18 | loss: 0.5602318
	speed: 0.1516s/iter; left time: 219.1826s
	iters: 500, epoch: 18 | loss: 0.5538681
	speed: 0.1390s/iter; left time: 187.0297s
	iters: 600, epoch: 18 | loss: 0.4932699
	speed: 0.1164s/iter; left time: 144.9791s
Epoch: 18 cost time: 77.48783707618713
Epoch: 18, Steps: 615 | Train Loss: 0.5816930 Vali Loss: 0.4574334 Test Loss: 0.5129229
Validation loss decreased (0.457975 --> 0.457433).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.5557605
	speed: 0.1100s/iter; left time: 124.3896s
	iters: 200, epoch: 19 | loss: 0.5273202
	speed: 0.1141s/iter; left time: 117.6135s
	iters: 300, epoch: 19 | loss: 0.6046844
	speed: 0.1104s/iter; left time: 102.7830s
	iters: 400, epoch: 19 | loss: 0.5266060
	speed: 0.1485s/iter; left time: 123.3940s
	iters: 500, epoch: 19 | loss: 0.6159812
	speed: 0.1304s/iter; left time: 95.3265s
	iters: 600, epoch: 19 | loss: 0.5752646
	speed: 0.1251s/iter; left time: 78.9561s
Epoch: 19 cost time: 75.4232006072998
Epoch: 19, Steps: 615 | Train Loss: 0.5813134 Vali Loss: 0.4572283 Test Loss: 0.5130410
Validation loss decreased (0.457433 --> 0.457228).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5900135
	speed: 0.1204s/iter; left time: 62.1272s
	iters: 200, epoch: 20 | loss: 0.6123659
	speed: 0.1138s/iter; left time: 47.3274s
	iters: 300, epoch: 20 | loss: 0.6659658
	speed: 0.1292s/iter; left time: 40.8248s
	iters: 400, epoch: 20 | loss: 0.5650565
	speed: 0.1371s/iter; left time: 29.6241s
	iters: 500, epoch: 20 | loss: 0.5442869
	speed: 0.1377s/iter; left time: 15.9709s
	iters: 600, epoch: 20 | loss: 0.6767219
	speed: 0.1162s/iter; left time: 1.8589s
Epoch: 20 cost time: 77.13634777069092
Epoch: 20, Steps: 615 | Train Loss: 0.5810339 Vali Loss: 0.4566925 Test Loss: 0.5128298
Validation loss decreased (0.457228 --> 0.456692).  Saving model ...
>>>>>>>testing : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7033
mse:0.5116230845451355, mae:0.5177924633026123
Use GPU: cuda:1
>>>>>>>start training : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 19657
val 7033
test 7033
	iters: 100, epoch: 1 | loss: 1.1244007
	speed: 0.1124s/iter; left time: 1371.2514s
	iters: 200, epoch: 1 | loss: 1.0193616
	speed: 0.1219s/iter; left time: 1475.1808s
	iters: 300, epoch: 1 | loss: 0.8439010
	speed: 0.1231s/iter; left time: 1477.0488s
	iters: 400, epoch: 1 | loss: 0.7986797
	speed: 0.1153s/iter; left time: 1372.0498s
	iters: 500, epoch: 1 | loss: 0.7381412
	speed: 0.1147s/iter; left time: 1353.2995s
	iters: 600, epoch: 1 | loss: 0.7626401
	speed: 0.1310s/iter; left time: 1533.1753s
Epoch: 1 cost time: 73.55923581123352
Epoch: 1, Steps: 615 | Train Loss: 0.9399807 Vali Loss: 0.5562335 Test Loss: 0.6216491
Validation loss decreased (inf --> 0.556234).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7075912
	speed: 0.1372s/iter; left time: 1589.4847s
	iters: 200, epoch: 2 | loss: 0.6307629
	speed: 0.1211s/iter; left time: 1391.1214s
	iters: 300, epoch: 2 | loss: 0.6987213
	speed: 0.1367s/iter; left time: 1555.9482s
	iters: 400, epoch: 2 | loss: 0.6025029
	speed: 0.1497s/iter; left time: 1689.6718s
	iters: 500, epoch: 2 | loss: 0.6613466
	speed: 0.1479s/iter; left time: 1654.0482s
	iters: 600, epoch: 2 | loss: 0.6672407
	speed: 0.1448s/iter; left time: 1605.0470s
Epoch: 2 cost time: 86.07096791267395
Epoch: 2, Steps: 615 | Train Loss: 0.6502407 Vali Loss: 0.4872570 Test Loss: 0.5463650
Validation loss decreased (0.556234 --> 0.487257).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.5782129
	speed: 0.1182s/iter; left time: 1297.2618s
	iters: 200, epoch: 3 | loss: 0.7033269
	speed: 0.1225s/iter; left time: 1331.4899s
	iters: 300, epoch: 3 | loss: 0.5951939
	speed: 0.1191s/iter; left time: 1282.8374s
	iters: 400, epoch: 3 | loss: 0.5270888
	speed: 0.1480s/iter; left time: 1579.4911s
	iters: 500, epoch: 3 | loss: 0.5718659
	speed: 0.1480s/iter; left time: 1564.1860s
	iters: 600, epoch: 3 | loss: 0.7092162
	speed: 0.1211s/iter; left time: 1268.1180s
Epoch: 3 cost time: 80.00268387794495
Epoch: 3, Steps: 615 | Train Loss: 0.6125652 Vali Loss: 0.4728201 Test Loss: 0.5307025
Validation loss decreased (0.487257 --> 0.472820).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6145759
	speed: 0.1147s/iter; left time: 1188.0034s
	iters: 200, epoch: 4 | loss: 0.5952209
	speed: 0.1181s/iter; left time: 1211.5215s
	iters: 300, epoch: 4 | loss: 0.5667147
	speed: 0.1257s/iter; left time: 1277.0436s
	iters: 400, epoch: 4 | loss: 0.5899577
	speed: 0.1167s/iter; left time: 1173.7915s
	iters: 500, epoch: 4 | loss: 0.5703893
	speed: 0.1161s/iter; left time: 1156.2063s
	iters: 600, epoch: 4 | loss: 0.6269956
	speed: 0.1275s/iter; left time: 1256.6107s
Epoch: 4 cost time: 73.68090319633484
Epoch: 4, Steps: 615 | Train Loss: 0.6019186 Vali Loss: 0.4687245 Test Loss: 0.5259668
Validation loss decreased (0.472820 --> 0.468725).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.5720460
	speed: 0.1184s/iter; left time: 1153.4400s
	iters: 200, epoch: 5 | loss: 0.5767294
	speed: 0.1204s/iter; left time: 1160.7792s
	iters: 300, epoch: 5 | loss: 0.5628913
	speed: 0.1416s/iter; left time: 1351.0218s
	iters: 400, epoch: 5 | loss: 0.5754707
	speed: 0.1265s/iter; left time: 1193.8614s
	iters: 500, epoch: 5 | loss: 0.6159213
	speed: 0.1355s/iter; left time: 1265.9515s
	iters: 600, epoch: 5 | loss: 0.5433373
	speed: 0.1643s/iter; left time: 1518.5117s
Epoch: 5 cost time: 82.43520045280457
Epoch: 5, Steps: 615 | Train Loss: 0.5938059 Vali Loss: 0.4646079 Test Loss: 0.5237785
Validation loss decreased (0.468725 --> 0.464608).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5611936
	speed: 0.1146s/iter; left time: 1046.1102s
	iters: 200, epoch: 6 | loss: 0.5554659
	speed: 0.1325s/iter; left time: 1195.7453s
	iters: 300, epoch: 6 | loss: 0.5720991
	speed: 0.1313s/iter; left time: 1172.3051s
	iters: 400, epoch: 6 | loss: 0.5168081
	speed: 0.1372s/iter; left time: 1210.8481s
	iters: 500, epoch: 6 | loss: 0.5682362
	speed: 0.1325s/iter; left time: 1156.0260s
	iters: 600, epoch: 6 | loss: 0.6174393
	speed: 0.1438s/iter; left time: 1240.8133s
Epoch: 6 cost time: 81.35745978355408
Epoch: 6, Steps: 615 | Train Loss: 0.5906191 Vali Loss: 0.4625382 Test Loss: 0.5195733
Validation loss decreased (0.464608 --> 0.462538).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.5362518
	speed: 0.1562s/iter; left time: 1329.4826s
	iters: 200, epoch: 7 | loss: 0.6218565
	speed: 0.1733s/iter; left time: 1457.2407s
	iters: 300, epoch: 7 | loss: 0.6207017
	speed: 0.1521s/iter; left time: 1264.1846s
	iters: 400, epoch: 7 | loss: 0.5527058
	speed: 0.1379s/iter; left time: 1132.4213s
	iters: 500, epoch: 7 | loss: 0.6127123
	speed: 0.1153s/iter; left time: 935.1044s
	iters: 600, epoch: 7 | loss: 0.5902601
	speed: 0.1224s/iter; left time: 980.4461s
Epoch: 7 cost time: 87.41679382324219
Epoch: 7, Steps: 615 | Train Loss: 0.5872403 Vali Loss: 0.4603608 Test Loss: 0.5184776
Validation loss decreased (0.462538 --> 0.460361).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.5878859
	speed: 0.1843s/iter; left time: 1454.8451s
	iters: 200, epoch: 8 | loss: 0.5290599
	speed: 0.1423s/iter; left time: 1109.7603s
	iters: 300, epoch: 8 | loss: 0.5508419
	speed: 0.1507s/iter; left time: 1159.9789s
	iters: 400, epoch: 8 | loss: 0.6287164
	speed: 0.1270s/iter; left time: 964.4892s
	iters: 500, epoch: 8 | loss: 0.5809504
	speed: 0.1252s/iter; left time: 938.8221s
	iters: 600, epoch: 8 | loss: 0.5992712
	speed: 0.1213s/iter; left time: 897.4777s
Epoch: 8 cost time: 88.27232670783997
Epoch: 8, Steps: 615 | Train Loss: 0.5856350 Vali Loss: 0.4615111 Test Loss: 0.5169961
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.4591942
	speed: 0.1218s/iter; left time: 886.6841s
	iters: 200, epoch: 9 | loss: 0.5518903
	speed: 0.1170s/iter; left time: 840.4540s
	iters: 300, epoch: 9 | loss: 0.6144074
	speed: 0.1406s/iter; left time: 995.3655s
	iters: 400, epoch: 9 | loss: 0.5428427
	speed: 0.1318s/iter; left time: 920.3863s
	iters: 500, epoch: 9 | loss: 0.5644857
	speed: 0.1189s/iter; left time: 818.2015s
	iters: 600, epoch: 9 | loss: 0.6357867
	speed: 0.1274s/iter; left time: 864.1333s
Epoch: 9 cost time: 77.9718885421753
Epoch: 9, Steps: 615 | Train Loss: 0.5844958 Vali Loss: 0.4598311 Test Loss: 0.5168687
Validation loss decreased (0.460361 --> 0.459831).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5853924
	speed: 0.1386s/iter; left time: 923.7545s
	iters: 200, epoch: 10 | loss: 0.5843524
	speed: 0.1270s/iter; left time: 833.9684s
	iters: 300, epoch: 10 | loss: 0.5665874
	speed: 0.1527s/iter; left time: 987.2607s
	iters: 400, epoch: 10 | loss: 0.6494807
	speed: 0.1708s/iter; left time: 1087.1822s
	iters: 500, epoch: 10 | loss: 0.5930477
	speed: 0.1790s/iter; left time: 1121.5737s
	iters: 600, epoch: 10 | loss: 0.5937011
	speed: 0.1775s/iter; left time: 1094.6750s
Epoch: 10 cost time: 96.29854774475098
Epoch: 10, Steps: 615 | Train Loss: 0.5835411 Vali Loss: 0.4591139 Test Loss: 0.5159108
Validation loss decreased (0.459831 --> 0.459114).  Saving model ...
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.5863471
	speed: 0.1297s/iter; left time: 784.9052s
	iters: 200, epoch: 11 | loss: 0.5863442
	speed: 0.1628s/iter; left time: 968.5462s
	iters: 300, epoch: 11 | loss: 0.6682191
	speed: 0.1645s/iter; left time: 962.4271s
	iters: 400, epoch: 11 | loss: 0.6089271
	speed: 0.1199s/iter; left time: 689.3367s
	iters: 500, epoch: 11 | loss: 0.6295031
	speed: 0.1275s/iter; left time: 720.4821s
	iters: 600, epoch: 11 | loss: 0.6040052
	speed: 0.1293s/iter; left time: 717.8432s
Epoch: 11 cost time: 85.28535294532776
Epoch: 11, Steps: 615 | Train Loss: 0.5829053 Vali Loss: 0.4598836 Test Loss: 0.5153748
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 12 | loss: 0.5812807
	speed: 0.1253s/iter; left time: 681.1394s
	iters: 200, epoch: 12 | loss: 0.5664161
	speed: 0.1541s/iter; left time: 822.2266s
	iters: 300, epoch: 12 | loss: 0.6115331
	speed: 0.1384s/iter; left time: 724.5088s
	iters: 400, epoch: 12 | loss: 0.6267884
	speed: 0.1296s/iter; left time: 665.6227s
	iters: 500, epoch: 12 | loss: 0.6127035
	speed: 0.1402s/iter; left time: 706.2460s
	iters: 600, epoch: 12 | loss: 0.5680473
	speed: 0.1362s/iter; left time: 672.0506s
Epoch: 12 cost time: 84.33566284179688
Epoch: 12, Steps: 615 | Train Loss: 0.5825477 Vali Loss: 0.4590188 Test Loss: 0.5153510
Validation loss decreased (0.459114 --> 0.459019).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5668665
	speed: 0.1192s/iter; left time: 574.6906s
	iters: 200, epoch: 13 | loss: 0.6330553
	speed: 0.1284s/iter; left time: 606.2761s
	iters: 300, epoch: 13 | loss: 0.6127133
	speed: 0.1377s/iter; left time: 636.4016s
	iters: 400, epoch: 13 | loss: 0.6201640
	speed: 0.1428s/iter; left time: 645.8038s
	iters: 500, epoch: 13 | loss: 0.5314533
	speed: 0.1277s/iter; left time: 564.4970s
	iters: 600, epoch: 13 | loss: 0.5989516
	speed: 0.1630s/iter; left time: 704.3360s
Epoch: 13 cost time: 83.92427921295166
Epoch: 13, Steps: 615 | Train Loss: 0.5821203 Vali Loss: 0.4584231 Test Loss: 0.5151401
Validation loss decreased (0.459019 --> 0.458423).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.6006974
	speed: 0.1603s/iter; left time: 674.0972s
	iters: 200, epoch: 14 | loss: 0.5462546
	speed: 0.1299s/iter; left time: 533.3551s
	iters: 300, epoch: 14 | loss: 0.5957074
	speed: 0.1434s/iter; left time: 574.5325s
	iters: 400, epoch: 14 | loss: 0.5453666
	speed: 0.1337s/iter; left time: 522.0970s
	iters: 500, epoch: 14 | loss: 0.5654950
	speed: 0.1391s/iter; left time: 529.3173s
	iters: 600, epoch: 14 | loss: 0.6463182
	speed: 0.1207s/iter; left time: 447.2299s
Epoch: 14 cost time: 84.41817784309387
Epoch: 14, Steps: 615 | Train Loss: 0.5819269 Vali Loss: 0.4589921 Test Loss: 0.5151496
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 15 | loss: 0.6304354
	speed: 0.1524s/iter; left time: 547.2185s
	iters: 200, epoch: 15 | loss: 0.6373496
	speed: 0.1605s/iter; left time: 560.1595s
	iters: 300, epoch: 15 | loss: 0.6063618
	speed: 0.1772s/iter; left time: 600.8539s
	iters: 400, epoch: 15 | loss: 0.5620148
	speed: 0.1702s/iter; left time: 560.0467s
	iters: 500, epoch: 15 | loss: 0.5424912
	speed: 0.1592s/iter; left time: 507.9541s
	iters: 600, epoch: 15 | loss: 0.5727395
	speed: 0.1430s/iter; left time: 441.9019s
Epoch: 15 cost time: 98.71967053413391
Epoch: 15, Steps: 615 | Train Loss: 0.5814396 Vali Loss: 0.4579477 Test Loss: 0.5148039
Validation loss decreased (0.458423 --> 0.457948).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.5617909
	speed: 0.1446s/iter; left time: 430.4270s
	iters: 200, epoch: 16 | loss: 0.5485947
	speed: 0.1624s/iter; left time: 467.1127s
	iters: 300, epoch: 16 | loss: 0.5565380
	speed: 0.1664s/iter; left time: 461.8164s
	iters: 400, epoch: 16 | loss: 0.5578129
	speed: 0.1585s/iter; left time: 424.0562s
	iters: 500, epoch: 16 | loss: 0.6182694
	speed: 0.1767s/iter; left time: 455.1074s
	iters: 600, epoch: 16 | loss: 0.5754917
	speed: 0.1850s/iter; left time: 458.0947s
Epoch: 16 cost time: 101.34505105018616
Epoch: 16, Steps: 615 | Train Loss: 0.5814188 Vali Loss: 0.4586014 Test Loss: 0.5148619
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 17 | loss: 0.6048471
	speed: 0.1735s/iter; left time: 409.6287s
	iters: 200, epoch: 17 | loss: 0.5537028
	speed: 0.1518s/iter; left time: 343.2454s
	iters: 300, epoch: 17 | loss: 0.5543808
	speed: 0.1907s/iter; left time: 412.1383s
	iters: 400, epoch: 17 | loss: 0.5280401
	speed: 0.1659s/iter; left time: 341.8705s
	iters: 500, epoch: 17 | loss: 0.5910879
	speed: 0.1671s/iter; left time: 327.7001s
	iters: 600, epoch: 17 | loss: 0.5419164
	speed: 0.1592s/iter; left time: 296.2305s
Epoch: 17 cost time: 102.64005517959595
Epoch: 17, Steps: 615 | Train Loss: 0.5810691 Vali Loss: 0.4582719 Test Loss: 0.5146464
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 18 | loss: 0.5886147
	speed: 0.1389s/iter; left time: 242.5795s
	iters: 200, epoch: 18 | loss: 0.5319188
	speed: 0.1481s/iter; left time: 243.7940s
	iters: 300, epoch: 18 | loss: 0.5799994
	speed: 0.1517s/iter; left time: 234.5075s
	iters: 400, epoch: 18 | loss: 0.6425908
	speed: 0.1450s/iter; left time: 209.6699s
	iters: 500, epoch: 18 | loss: 0.6010316
	speed: 0.1703s/iter; left time: 229.1900s
	iters: 600, epoch: 18 | loss: 0.6389510
	speed: 0.1661s/iter; left time: 206.9835s
Epoch: 18 cost time: 95.20763731002808
Epoch: 18, Steps: 615 | Train Loss: 0.5807159 Vali Loss: 0.4585256 Test Loss: 0.5141486
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_WTH_il336_ol168_sl24,36,48,56_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 7033
mse:0.5135981440544128, mae:0.5188794732093811
