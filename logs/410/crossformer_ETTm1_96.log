Args in experiment:
Namespace(data='ETTm1', root_path='./datasets/', data_path='ETTm1.csv', data_split=[34560, 11520, 11520], checkpoints='./checkpoints/', in_len=672, out_len=96, seg_lens='12,16,24,48,96', data_dim=7, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.2, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.0001, lradj='type1', itr=5, save_pred=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3')
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33793
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5170457
	speed: 0.2208s/iter; left time: 4645.7074s
	iters: 200, epoch: 1 | loss: 0.4161460
	speed: 0.1911s/iter; left time: 4002.2963s
	iters: 300, epoch: 1 | loss: 0.3438585
	speed: 0.1896s/iter; left time: 3951.5097s
	iters: 400, epoch: 1 | loss: 0.3661437
	speed: 0.2119s/iter; left time: 4394.4632s
	iters: 500, epoch: 1 | loss: 0.3071572
	speed: 0.2635s/iter; left time: 5439.3284s
	iters: 600, epoch: 1 | loss: 0.3248326
	speed: 0.2856s/iter; left time: 5865.9156s
	iters: 700, epoch: 1 | loss: 0.3046762
	speed: 0.2933s/iter; left time: 5994.3496s
	iters: 800, epoch: 1 | loss: 0.3422002
	speed: 0.2857s/iter; left time: 5811.7580s
	iters: 900, epoch: 1 | loss: 0.3569225
	speed: 0.2439s/iter; left time: 4937.6682s
	iters: 1000, epoch: 1 | loss: 0.2881006
	speed: 0.1786s/iter; left time: 3596.8513s
Epoch: 1 cost time: 246.58450770378113
Epoch: 1, Steps: 1057 | Train Loss: 0.4481984 Vali Loss: 0.4760314 Test Loss: 0.3585716
Validation loss decreased (inf --> 0.476031).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2844697
	speed: 0.2788s/iter; left time: 5570.9728s
	iters: 200, epoch: 2 | loss: 0.2813079
	speed: 0.2337s/iter; left time: 4646.1874s
	iters: 300, epoch: 2 | loss: 0.2711805
	speed: 0.2267s/iter; left time: 4485.0394s
	iters: 400, epoch: 2 | loss: 0.3418601
	speed: 0.2079s/iter; left time: 4092.2835s
	iters: 500, epoch: 2 | loss: 0.2594359
	speed: 0.1945s/iter; left time: 3808.8701s
	iters: 600, epoch: 2 | loss: 0.2638271
	speed: 0.1579s/iter; left time: 3075.7981s
	iters: 700, epoch: 2 | loss: 0.3115194
	speed: 0.2168s/iter; left time: 4203.3894s
	iters: 800, epoch: 2 | loss: 0.3084639
	speed: 0.2482s/iter; left time: 4785.8088s
	iters: 900, epoch: 2 | loss: 0.2658659
	speed: 0.2253s/iter; left time: 4322.7934s
	iters: 1000, epoch: 2 | loss: 0.2811553
	speed: 0.2360s/iter; left time: 4503.1124s
Epoch: 2 cost time: 237.01981902122498
Epoch: 2, Steps: 1057 | Train Loss: 0.2753613 Vali Loss: 0.4866061 Test Loss: 0.3552980
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2243042
	speed: 0.2534s/iter; left time: 4796.9844s
	iters: 200, epoch: 3 | loss: 0.2608252
	speed: 0.2164s/iter; left time: 4073.8807s
	iters: 300, epoch: 3 | loss: 0.2155349
	speed: 0.2119s/iter; left time: 3968.8091s
	iters: 400, epoch: 3 | loss: 0.2462058
	speed: 0.2185s/iter; left time: 4070.3137s
	iters: 500, epoch: 3 | loss: 0.2495682
	speed: 0.1804s/iter; left time: 3342.3327s
	iters: 600, epoch: 3 | loss: 0.2538410
	speed: 0.1728s/iter; left time: 3184.3371s
	iters: 700, epoch: 3 | loss: 0.2998758
	speed: 0.1674s/iter; left time: 3067.7961s
	iters: 800, epoch: 3 | loss: 0.2345317
	speed: 0.1872s/iter; left time: 3412.7620s
	iters: 900, epoch: 3 | loss: 0.2074542
	speed: 0.2571s/iter; left time: 4660.8046s
	iters: 1000, epoch: 3 | loss: 0.2406302
	speed: 0.2639s/iter; left time: 4758.0130s
Epoch: 3 cost time: 227.42340302467346
Epoch: 3, Steps: 1057 | Train Loss: 0.2376448 Vali Loss: 0.4589898 Test Loss: 0.3357191
Validation loss decreased (0.476031 --> 0.458990).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2200089
	speed: 0.2027s/iter; left time: 3621.9061s
	iters: 200, epoch: 4 | loss: 0.2445210
	speed: 0.2136s/iter; left time: 3796.1072s
	iters: 300, epoch: 4 | loss: 0.2437518
	speed: 0.2167s/iter; left time: 3829.5544s
	iters: 400, epoch: 4 | loss: 0.2357496
	speed: 0.2452s/iter; left time: 4307.2985s
	iters: 500, epoch: 4 | loss: 0.2540222
	speed: 0.2587s/iter; left time: 4520.3071s
	iters: 600, epoch: 4 | loss: 0.2735619
	speed: 0.2651s/iter; left time: 4604.9115s
	iters: 700, epoch: 4 | loss: 0.2463658
	speed: 0.2392s/iter; left time: 4130.8508s
	iters: 800, epoch: 4 | loss: 0.2047793
	speed: 0.2296s/iter; left time: 3941.8205s
	iters: 900, epoch: 4 | loss: 0.1957239
	speed: 0.2159s/iter; left time: 3685.6616s
	iters: 1000, epoch: 4 | loss: 0.2022889
	speed: 0.2086s/iter; left time: 3540.3887s
Epoch: 4 cost time: 241.90663027763367
Epoch: 4, Steps: 1057 | Train Loss: 0.2273765 Vali Loss: 0.4718030 Test Loss: 0.3489022
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2050680
	speed: 0.2569s/iter; left time: 4319.0742s
	iters: 200, epoch: 5 | loss: 0.1743608
	speed: 0.3020s/iter; left time: 5046.7269s
	iters: 300, epoch: 5 | loss: 0.2254262
	speed: 0.3085s/iter; left time: 5125.2247s
	iters: 400, epoch: 5 | loss: 0.2148626
	speed: 0.2510s/iter; left time: 4145.5249s
	iters: 500, epoch: 5 | loss: 0.2015069
	speed: 0.2263s/iter; left time: 3714.0106s
	iters: 600, epoch: 5 | loss: 0.2028690
	speed: 0.2086s/iter; left time: 3402.5680s
	iters: 700, epoch: 5 | loss: 0.2170827
	speed: 0.1857s/iter; left time: 3011.3574s
	iters: 800, epoch: 5 | loss: 0.1912214
	speed: 0.1822s/iter; left time: 2935.7427s
	iters: 900, epoch: 5 | loss: 0.1687972
	speed: 0.1997s/iter; left time: 3197.8659s
	iters: 1000, epoch: 5 | loss: 0.1738789
	speed: 0.2524s/iter; left time: 4015.7361s
Epoch: 5 cost time: 253.56671857833862
Epoch: 5, Steps: 1057 | Train Loss: 0.2088856 Vali Loss: 0.4535788 Test Loss: 0.3273351
Validation loss decreased (0.458990 --> 0.453579).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2291990
	speed: 0.1896s/iter; left time: 2987.4302s
	iters: 200, epoch: 6 | loss: 0.1751526
	speed: 0.2024s/iter; left time: 3169.4942s
	iters: 300, epoch: 6 | loss: 0.1811332
	speed: 0.2383s/iter; left time: 3706.4047s
	iters: 400, epoch: 6 | loss: 0.2309005
	speed: 0.2239s/iter; left time: 3460.8203s
	iters: 500, epoch: 6 | loss: 0.2345948
	speed: 0.2467s/iter; left time: 3788.3907s
	iters: 600, epoch: 6 | loss: 0.2154710
	speed: 0.2748s/iter; left time: 4192.4067s
	iters: 700, epoch: 6 | loss: 0.1925432
	speed: 0.2484s/iter; left time: 3764.8407s
	iters: 800, epoch: 6 | loss: 0.2391964
	speed: 0.2144s/iter; left time: 3227.8355s
	iters: 900, epoch: 6 | loss: 0.2306972
	speed: 0.2170s/iter; left time: 3246.0005s
	iters: 1000, epoch: 6 | loss: 0.1911901
	speed: 0.2167s/iter; left time: 3219.6306s
Epoch: 6 cost time: 240.2636685371399
Epoch: 6, Steps: 1057 | Train Loss: 0.2023336 Vali Loss: 0.4867607 Test Loss: 0.3490171
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.2213776
	speed: 0.1900s/iter; left time: 2793.0629s
	iters: 200, epoch: 7 | loss: 0.1900492
	speed: 0.1957s/iter; left time: 2857.2232s
	iters: 300, epoch: 7 | loss: 0.2054523
	speed: 0.2307s/iter; left time: 3345.2236s
	iters: 400, epoch: 7 | loss: 0.1876257
	speed: 0.2753s/iter; left time: 3963.5637s
	iters: 500, epoch: 7 | loss: 0.2259781
	speed: 0.2938s/iter; left time: 4201.1941s
	iters: 600, epoch: 7 | loss: 0.1990069
	speed: 0.2828s/iter; left time: 4015.3714s
	iters: 700, epoch: 7 | loss: 0.1706693
	speed: 0.2396s/iter; left time: 3378.6081s
	iters: 800, epoch: 7 | loss: 0.1800188
	speed: 0.2085s/iter; left time: 2918.7641s
	iters: 900, epoch: 7 | loss: 0.1910418
	speed: 0.1808s/iter; left time: 2512.8756s
	iters: 1000, epoch: 7 | loss: 0.1980117
	speed: 0.1864s/iter; left time: 2571.9594s
Epoch: 7 cost time: 238.49267673492432
Epoch: 7, Steps: 1057 | Train Loss: 0.1914466 Vali Loss: 0.4913722 Test Loss: 0.3440547
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 8 | loss: 0.1999374
	speed: 0.2225s/iter; left time: 3035.2770s
	iters: 200, epoch: 8 | loss: 0.1922510
	speed: 0.2150s/iter; left time: 2910.9462s
	iters: 300, epoch: 8 | loss: 0.1620377
	speed: 0.2199s/iter; left time: 2955.6961s
	iters: 400, epoch: 8 | loss: 0.2269483
	speed: 0.2061s/iter; left time: 2749.5763s
	iters: 500, epoch: 8 | loss: 0.1920181
	speed: 0.2341s/iter; left time: 3099.5255s
	iters: 600, epoch: 8 | loss: 0.1869457
	speed: 0.2262s/iter; left time: 2973.2826s
	iters: 700, epoch: 8 | loss: 0.2046583
	speed: 0.2227s/iter; left time: 2904.0355s
	iters: 800, epoch: 8 | loss: 0.1901337
	speed: 0.2190s/iter; left time: 2833.6947s
	iters: 900, epoch: 8 | loss: 0.1766489
	speed: 0.2212s/iter; left time: 2840.5044s
	iters: 1000, epoch: 8 | loss: 0.1916515
	speed: 0.2086s/iter; left time: 2658.5975s
Epoch: 8 cost time: 231.7907886505127
Epoch: 8, Steps: 1057 | Train Loss: 0.1876199 Vali Loss: 0.5111527 Test Loss: 0.3559539
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3274747133255005, mae:0.3742547929286957
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33793
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5879287
	speed: 0.1771s/iter; left time: 3726.4709s
	iters: 200, epoch: 1 | loss: 0.4462109
	speed: 0.2053s/iter; left time: 4298.2030s
	iters: 300, epoch: 1 | loss: 0.4316565
	speed: 0.2316s/iter; left time: 4826.4855s
	iters: 400, epoch: 1 | loss: 0.4233612
	speed: 0.2355s/iter; left time: 4884.6287s
	iters: 500, epoch: 1 | loss: 0.3967993
	speed: 0.2676s/iter; left time: 5523.7719s
	iters: 600, epoch: 1 | loss: 0.4013189
	speed: 0.2729s/iter; left time: 5606.2118s
	iters: 700, epoch: 1 | loss: 0.3609061
	speed: 0.2581s/iter; left time: 5274.8851s
	iters: 800, epoch: 1 | loss: 0.2996652
	speed: 0.2179s/iter; left time: 4431.5861s
	iters: 900, epoch: 1 | loss: 0.3503312
	speed: 0.2122s/iter; left time: 4296.0901s
	iters: 1000, epoch: 1 | loss: 0.3558714
	speed: 0.1924s/iter; left time: 3874.5177s
Epoch: 1 cost time: 237.45151948928833
Epoch: 1, Steps: 1057 | Train Loss: 0.4503371 Vali Loss: 0.4634558 Test Loss: 0.3733590
Validation loss decreased (inf --> 0.463456).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3086738
	speed: 0.1841s/iter; left time: 3678.6561s
	iters: 200, epoch: 2 | loss: 0.2950088
	speed: 0.2124s/iter; left time: 4223.4982s
	iters: 300, epoch: 2 | loss: 0.2898791
	speed: 0.2147s/iter; left time: 4247.4259s
	iters: 400, epoch: 2 | loss: 0.3191888
	speed: 0.2220s/iter; left time: 4369.2146s
	iters: 500, epoch: 2 | loss: 0.3203325
	speed: 0.2636s/iter; left time: 5162.2953s
	iters: 600, epoch: 2 | loss: 0.2632158
	speed: 0.2639s/iter; left time: 5141.2859s
	iters: 700, epoch: 2 | loss: 0.2721855
	speed: 0.2474s/iter; left time: 4796.1082s
	iters: 800, epoch: 2 | loss: 0.2738915
	speed: 0.2341s/iter; left time: 4514.6173s
	iters: 900, epoch: 2 | loss: 0.2846223
	speed: 0.2225s/iter; left time: 4268.2059s
	iters: 1000, epoch: 2 | loss: 0.2206020
	speed: 0.1899s/iter; left time: 3623.2328s
Epoch: 2 cost time: 235.44326448440552
Epoch: 2, Steps: 1057 | Train Loss: 0.2787160 Vali Loss: 0.4733826 Test Loss: 0.3960923
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2650063
	speed: 0.2629s/iter; left time: 4975.9130s
	iters: 200, epoch: 3 | loss: 0.2693616
	speed: 0.2121s/iter; left time: 3993.3068s
	iters: 300, epoch: 3 | loss: 0.2547213
	speed: 0.1953s/iter; left time: 3657.5981s
	iters: 400, epoch: 3 | loss: 0.2431531
	speed: 0.1739s/iter; left time: 3239.1847s
	iters: 500, epoch: 3 | loss: 0.2609912
	speed: 0.1960s/iter; left time: 3631.0531s
	iters: 600, epoch: 3 | loss: 0.2689025
	speed: 0.2307s/iter; left time: 4250.5895s
	iters: 700, epoch: 3 | loss: 0.2017566
	speed: 0.2376s/iter; left time: 4355.3708s
	iters: 800, epoch: 3 | loss: 0.2196829
	speed: 0.2364s/iter; left time: 4308.7126s
	iters: 900, epoch: 3 | loss: 0.2256165
	speed: 0.2579s/iter; left time: 4674.3404s
	iters: 1000, epoch: 3 | loss: 0.2568068
	speed: 0.2325s/iter; left time: 4192.1627s
Epoch: 3 cost time: 235.51723837852478
Epoch: 3, Steps: 1057 | Train Loss: 0.2396472 Vali Loss: 0.4297292 Test Loss: 0.3123152
Validation loss decreased (0.463456 --> 0.429729).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2250347
	speed: 0.2407s/iter; left time: 4300.7728s
	iters: 200, epoch: 4 | loss: 0.1965149
	speed: 0.1955s/iter; left time: 3474.4147s
	iters: 300, epoch: 4 | loss: 0.2416768
	speed: 0.1792s/iter; left time: 3166.8137s
	iters: 400, epoch: 4 | loss: 0.2187308
	speed: 0.1777s/iter; left time: 3122.6891s
	iters: 500, epoch: 4 | loss: 0.2420438
	speed: 0.1772s/iter; left time: 3095.0841s
	iters: 600, epoch: 4 | loss: 0.2803747
	speed: 0.2150s/iter; left time: 3734.2579s
	iters: 700, epoch: 4 | loss: 0.2300368
	speed: 0.2644s/iter; left time: 4565.7306s
	iters: 800, epoch: 4 | loss: 0.2075427
	speed: 0.2686s/iter; left time: 4611.2070s
	iters: 900, epoch: 4 | loss: 0.2261534
	speed: 0.2799s/iter; left time: 4778.6757s
	iters: 1000, epoch: 4 | loss: 0.2052836
	speed: 0.2609s/iter; left time: 4427.9477s
Epoch: 4 cost time: 240.32412838935852
Epoch: 4, Steps: 1057 | Train Loss: 0.2268370 Vali Loss: 0.4592764 Test Loss: 0.3400402
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2145573
	speed: 0.2272s/iter; left time: 3820.4332s
	iters: 200, epoch: 5 | loss: 0.1737806
	speed: 0.2166s/iter; left time: 3620.0454s
	iters: 300, epoch: 5 | loss: 0.2413138
	speed: 0.2348s/iter; left time: 3900.7865s
	iters: 400, epoch: 5 | loss: 0.1889428
	speed: 0.2097s/iter; left time: 3462.2517s
	iters: 500, epoch: 5 | loss: 0.2062982
	speed: 0.2141s/iter; left time: 3514.7184s
	iters: 600, epoch: 5 | loss: 0.2221788
	speed: 0.2075s/iter; left time: 3385.6850s
	iters: 700, epoch: 5 | loss: 0.1830540
	speed: 0.2497s/iter; left time: 4047.8717s
	iters: 800, epoch: 5 | loss: 0.2184537
	speed: 0.2737s/iter; left time: 4409.9195s
	iters: 900, epoch: 5 | loss: 0.1822596
	speed: 0.2430s/iter; left time: 3890.7671s
	iters: 1000, epoch: 5 | loss: 0.2016106
	speed: 0.2275s/iter; left time: 3620.8202s
Epoch: 5 cost time: 242.71860718727112
Epoch: 5, Steps: 1057 | Train Loss: 0.2118302 Vali Loss: 0.4460973 Test Loss: 0.3309348
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2045723
	speed: 0.2664s/iter; left time: 4197.7492s
	iters: 200, epoch: 6 | loss: 0.2054868
	speed: 0.2631s/iter; left time: 4118.9967s
	iters: 300, epoch: 6 | loss: 0.2172367
	speed: 0.2734s/iter; left time: 4253.1823s
	iters: 400, epoch: 6 | loss: 0.1863444
	speed: 0.2590s/iter; left time: 4002.7400s
	iters: 500, epoch: 6 | loss: 0.2108068
	speed: 0.2073s/iter; left time: 3182.7102s
	iters: 600, epoch: 6 | loss: 0.2026029
	speed: 0.1713s/iter; left time: 2613.7261s
	iters: 700, epoch: 6 | loss: 0.2115529
	speed: 0.1817s/iter; left time: 2753.6927s
	iters: 800, epoch: 6 | loss: 0.2535498
	speed: 0.2206s/iter; left time: 3320.6588s
	iters: 900, epoch: 6 | loss: 0.2196641
	speed: 0.2382s/iter; left time: 3563.0546s
	iters: 1000, epoch: 6 | loss: 0.1916334
	speed: 0.2343s/iter; left time: 3481.1635s
Epoch: 6 cost time: 244.99681043624878
Epoch: 6, Steps: 1057 | Train Loss: 0.2059753 Vali Loss: 0.4683002 Test Loss: 0.3484846
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31269216537475586, mae:0.37383416295051575
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr2>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33793
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.6090372
	speed: 0.2303s/iter; left time: 4845.1543s
	iters: 200, epoch: 1 | loss: 0.5004431
	speed: 0.2271s/iter; left time: 4755.6896s
	iters: 300, epoch: 1 | loss: 0.3943620
	speed: 0.2078s/iter; left time: 4330.2079s
	iters: 400, epoch: 1 | loss: 0.3690898
	speed: 0.1716s/iter; left time: 3559.7237s
	iters: 500, epoch: 1 | loss: 0.3704969
	speed: 0.1744s/iter; left time: 3599.2342s
	iters: 600, epoch: 1 | loss: 0.3234987
	speed: 0.1907s/iter; left time: 3917.9075s
	iters: 700, epoch: 1 | loss: 0.3271497
	speed: 0.2344s/iter; left time: 4791.2687s
	iters: 800, epoch: 1 | loss: 0.2861618
	speed: 0.2862s/iter; left time: 5822.4268s
	iters: 900, epoch: 1 | loss: 0.3207413
	speed: 0.2552s/iter; left time: 5165.2045s
	iters: 1000, epoch: 1 | loss: 0.2725514
	speed: 0.2567s/iter; left time: 5169.9095s
Epoch: 1 cost time: 239.20953249931335
Epoch: 1, Steps: 1057 | Train Loss: 0.4534834 Vali Loss: 0.5089773 Test Loss: 0.4329324
Validation loss decreased (inf --> 0.508977).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3302374
	speed: 0.2214s/iter; left time: 4423.6560s
	iters: 200, epoch: 2 | loss: 0.3025325
	speed: 0.2302s/iter; left time: 4576.7898s
	iters: 300, epoch: 2 | loss: 0.2779117
	speed: 0.2549s/iter; left time: 5042.1645s
	iters: 400, epoch: 2 | loss: 0.2823851
	speed: 0.2597s/iter; left time: 5111.8809s
	iters: 500, epoch: 2 | loss: 0.2729597
	speed: 0.2255s/iter; left time: 4415.5441s
	iters: 600, epoch: 2 | loss: 0.2980996
	speed: 0.2109s/iter; left time: 4108.8066s
	iters: 700, epoch: 2 | loss: 0.2417791
	speed: 0.2150s/iter; left time: 4168.3474s
	iters: 800, epoch: 2 | loss: 0.2498939
	speed: 0.2145s/iter; left time: 4137.3183s
	iters: 900, epoch: 2 | loss: 0.2914294
	speed: 0.2299s/iter; left time: 4411.1128s
	iters: 1000, epoch: 2 | loss: 0.2424124
	speed: 0.2183s/iter; left time: 4165.8829s
Epoch: 2 cost time: 241.12823700904846
Epoch: 2, Steps: 1057 | Train Loss: 0.2770789 Vali Loss: 0.4609414 Test Loss: 0.3495306
Validation loss decreased (0.508977 --> 0.460941).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2079547
	speed: 0.2585s/iter; left time: 4891.8261s
	iters: 200, epoch: 3 | loss: 0.3090037
	speed: 0.2779s/iter; left time: 5232.0546s
	iters: 300, epoch: 3 | loss: 0.2208021
	speed: 0.2674s/iter; left time: 5007.7230s
	iters: 400, epoch: 3 | loss: 0.2223402
	speed: 0.2687s/iter; left time: 5004.3934s
	iters: 500, epoch: 3 | loss: 0.2681905
	speed: 0.2346s/iter; left time: 4346.0433s
	iters: 600, epoch: 3 | loss: 0.2126943
	speed: 0.2048s/iter; left time: 3773.0796s
	iters: 700, epoch: 3 | loss: 0.2177588
	speed: 0.1755s/iter; left time: 3215.7609s
	iters: 800, epoch: 3 | loss: 0.2338088
	speed: 0.1754s/iter; left time: 3196.5556s
	iters: 900, epoch: 3 | loss: 0.2472595
	speed: 0.1779s/iter; left time: 3224.2019s
	iters: 1000, epoch: 3 | loss: 0.2140379
	speed: 0.2153s/iter; left time: 3881.8147s
Epoch: 3 cost time: 238.39224362373352
Epoch: 3, Steps: 1057 | Train Loss: 0.2372741 Vali Loss: 0.4586499 Test Loss: 0.3256845
Validation loss decreased (0.460941 --> 0.458650).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2716452
	speed: 0.2079s/iter; left time: 3715.9500s
	iters: 200, epoch: 4 | loss: 0.2054795
	speed: 0.2655s/iter; left time: 4717.1945s
	iters: 300, epoch: 4 | loss: 0.2036629
	speed: 0.2663s/iter; left time: 4705.3774s
	iters: 400, epoch: 4 | loss: 0.2486431
	speed: 0.2341s/iter; left time: 4113.5679s
	iters: 500, epoch: 4 | loss: 0.2338786
	speed: 0.2197s/iter; left time: 3838.9273s
	iters: 600, epoch: 4 | loss: 0.2482197
	speed: 0.2216s/iter; left time: 3848.6878s
	iters: 700, epoch: 4 | loss: 0.2158731
	speed: 0.1972s/iter; left time: 3406.2124s
	iters: 800, epoch: 4 | loss: 0.2110787
	speed: 0.1774s/iter; left time: 3045.6818s
	iters: 900, epoch: 4 | loss: 0.1849868
	speed: 0.1763s/iter; left time: 3008.6944s
	iters: 1000, epoch: 4 | loss: 0.2133995
	speed: 0.1896s/iter; left time: 3217.0207s
Epoch: 4 cost time: 228.8855402469635
Epoch: 4, Steps: 1057 | Train Loss: 0.2276264 Vali Loss: 0.4972542 Test Loss: 0.3742812
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2363387
	speed: 0.1719s/iter; left time: 2890.3315s
	iters: 200, epoch: 5 | loss: 0.2020037
	speed: 0.1724s/iter; left time: 2881.4593s
	iters: 300, epoch: 5 | loss: 0.2273419
	speed: 0.1812s/iter; left time: 3010.8302s
	iters: 400, epoch: 5 | loss: 0.2238333
	speed: 0.2228s/iter; left time: 3679.1782s
	iters: 500, epoch: 5 | loss: 0.1895080
	speed: 0.2285s/iter; left time: 3750.9931s
	iters: 600, epoch: 5 | loss: 0.2266023
	speed: 0.2236s/iter; left time: 3647.8249s
	iters: 700, epoch: 5 | loss: 0.1931210
	speed: 0.2192s/iter; left time: 3553.9799s
	iters: 800, epoch: 5 | loss: 0.2017305
	speed: 0.2601s/iter; left time: 4191.1162s
	iters: 900, epoch: 5 | loss: 0.2385168
	speed: 0.2191s/iter; left time: 3509.1425s
	iters: 1000, epoch: 5 | loss: 0.2209837
	speed: 0.2107s/iter; left time: 3353.0188s
Epoch: 5 cost time: 222.53170609474182
Epoch: 5, Steps: 1057 | Train Loss: 0.2084929 Vali Loss: 0.5159480 Test Loss: 0.3879662
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.2593313
	speed: 0.1821s/iter; left time: 2869.3842s
	iters: 200, epoch: 6 | loss: 0.2012009
	speed: 0.1795s/iter; left time: 2809.8208s
	iters: 300, epoch: 6 | loss: 0.1756162
	speed: 0.1643s/iter; left time: 2555.2997s
	iters: 400, epoch: 6 | loss: 0.1843345
	speed: 0.1926s/iter; left time: 2976.5661s
	iters: 500, epoch: 6 | loss: 0.1908603
	speed: 0.2819s/iter; left time: 4328.5888s
	iters: 600, epoch: 6 | loss: 0.2357549
	speed: 0.2773s/iter; left time: 4230.9679s
	iters: 700, epoch: 6 | loss: 0.1750612
	speed: 0.2689s/iter; left time: 4075.5487s
	iters: 800, epoch: 6 | loss: 0.2088777
	speed: 0.2648s/iter; left time: 3986.9310s
	iters: 900, epoch: 6 | loss: 0.1996364
	speed: 0.2534s/iter; left time: 3790.1366s
	iters: 1000, epoch: 6 | loss: 0.1965229
	speed: 0.1757s/iter; left time: 2610.0163s
Epoch: 6 cost time: 234.33647537231445
Epoch: 6, Steps: 1057 | Train Loss: 0.2014820 Vali Loss: 0.5175503 Test Loss: 0.3629173
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr2<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.32621845602989197, mae:0.3781694769859314
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr3>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33793
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5774356
	speed: 0.2030s/iter; left time: 4270.6447s
	iters: 200, epoch: 1 | loss: 0.5555097
	speed: 0.2305s/iter; left time: 4826.6388s
	iters: 300, epoch: 1 | loss: 0.4040817
	speed: 0.2760s/iter; left time: 5752.1166s
	iters: 400, epoch: 1 | loss: 0.3686323
	speed: 0.2237s/iter; left time: 4640.7441s
	iters: 500, epoch: 1 | loss: 0.3112476
	speed: 0.2188s/iter; left time: 4515.7468s
	iters: 600, epoch: 1 | loss: 0.3475497
	speed: 0.2242s/iter; left time: 4604.8344s
	iters: 700, epoch: 1 | loss: 0.3539166
	speed: 0.2271s/iter; left time: 4641.5752s
	iters: 800, epoch: 1 | loss: 0.2991456
	speed: 0.1876s/iter; left time: 3815.3226s
	iters: 900, epoch: 1 | loss: 0.2913423
	speed: 0.1825s/iter; left time: 3694.5500s
	iters: 1000, epoch: 1 | loss: 0.3034728
	speed: 0.1970s/iter; left time: 3967.1709s
Epoch: 1 cost time: 228.6888358592987
Epoch: 1, Steps: 1057 | Train Loss: 0.4514627 Vali Loss: 0.4594690 Test Loss: 0.3487461
Validation loss decreased (inf --> 0.459469).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3045515
	speed: 0.1924s/iter; left time: 3845.3519s
	iters: 200, epoch: 2 | loss: 0.3383197
	speed: 0.1799s/iter; left time: 3578.0038s
	iters: 300, epoch: 2 | loss: 0.2905444
	speed: 0.1829s/iter; left time: 3617.8438s
	iters: 400, epoch: 2 | loss: 0.2833988
	speed: 0.1798s/iter; left time: 3539.1407s
	iters: 500, epoch: 2 | loss: 0.2607967
	speed: 0.2161s/iter; left time: 4232.2050s
	iters: 600, epoch: 2 | loss: 0.2990917
	speed: 0.2212s/iter; left time: 4308.9474s
	iters: 700, epoch: 2 | loss: 0.2416351
	speed: 0.2701s/iter; left time: 5235.1556s
	iters: 800, epoch: 2 | loss: 0.2771419
	speed: 0.2854s/iter; left time: 5503.6918s
	iters: 900, epoch: 2 | loss: 0.2795041
	speed: 0.2734s/iter; left time: 5244.5050s
	iters: 1000, epoch: 2 | loss: 0.3025209
	speed: 0.2338s/iter; left time: 4461.5665s
Epoch: 2 cost time: 235.46730422973633
Epoch: 2, Steps: 1057 | Train Loss: 0.2792691 Vali Loss: 0.5208689 Test Loss: 0.3827922
EarlyStopping counter: 1 out of 3
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2489374
	speed: 0.2172s/iter; left time: 4110.6200s
	iters: 200, epoch: 3 | loss: 0.2384340
	speed: 0.2048s/iter; left time: 3856.5049s
	iters: 300, epoch: 3 | loss: 0.2463568
	speed: 0.2075s/iter; left time: 3885.7537s
	iters: 400, epoch: 3 | loss: 0.2619753
	speed: 0.2140s/iter; left time: 3986.3047s
	iters: 500, epoch: 3 | loss: 0.2236764
	speed: 0.2058s/iter; left time: 3812.7651s
	iters: 600, epoch: 3 | loss: 0.2661646
	speed: 0.2577s/iter; left time: 4749.1749s
	iters: 700, epoch: 3 | loss: 0.2221717
	speed: 0.2682s/iter; left time: 4916.1230s
	iters: 800, epoch: 3 | loss: 0.2340750
	speed: 0.2514s/iter; left time: 4581.7094s
	iters: 900, epoch: 3 | loss: 0.2548986
	speed: 0.2355s/iter; left time: 4269.3718s
	iters: 1000, epoch: 3 | loss: 0.2436355
	speed: 0.2252s/iter; left time: 4060.2950s
Epoch: 3 cost time: 240.72605895996094
Epoch: 3, Steps: 1057 | Train Loss: 0.2376783 Vali Loss: 0.4611083 Test Loss: 0.3426258
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 4 | loss: 0.2253258
	speed: 0.2662s/iter; left time: 4756.4530s
	iters: 200, epoch: 4 | loss: 0.2777253
	speed: 0.2765s/iter; left time: 4912.6296s
	iters: 300, epoch: 4 | loss: 0.2135054
	speed: 0.2744s/iter; left time: 4848.6787s
	iters: 400, epoch: 4 | loss: 0.2616990
	speed: 0.1947s/iter; left time: 3421.5909s
	iters: 500, epoch: 4 | loss: 0.2410931
	speed: 0.1792s/iter; left time: 3129.9906s
	iters: 600, epoch: 4 | loss: 0.1997428
	speed: 0.1772s/iter; left time: 3078.0253s
	iters: 700, epoch: 4 | loss: 0.2114795
	speed: 0.2064s/iter; left time: 3565.0062s
	iters: 800, epoch: 4 | loss: 0.2357387
	speed: 0.2339s/iter; left time: 4016.0141s
	iters: 900, epoch: 4 | loss: 0.2214342
	speed: 0.2333s/iter; left time: 3982.4224s
	iters: 1000, epoch: 4 | loss: 0.2389954
	speed: 0.2277s/iter; left time: 3864.6691s
Epoch: 4 cost time: 242.73912596702576
Epoch: 4, Steps: 1057 | Train Loss: 0.2250175 Vali Loss: 0.4981119 Test Loss: 0.3427200
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr3<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.34902727603912354, mae:0.4074591398239136
Use GPU: cuda:0
>>>>>>>start training : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr4>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33793
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.5966522
	speed: 0.1993s/iter; left time: 4193.5537s
	iters: 200, epoch: 1 | loss: 0.4736124
	speed: 0.1753s/iter; left time: 3670.0287s
	iters: 300, epoch: 1 | loss: 0.5391842
	speed: 0.1787s/iter; left time: 3724.5792s
	iters: 400, epoch: 1 | loss: 0.3757014
	speed: 0.1869s/iter; left time: 3876.6552s
	iters: 500, epoch: 1 | loss: 0.3372903
	speed: 0.2582s/iter; left time: 5330.4097s
	iters: 600, epoch: 1 | loss: 0.3647233
	speed: 0.2711s/iter; left time: 5569.5484s
	iters: 700, epoch: 1 | loss: 0.3027270
	speed: 0.2713s/iter; left time: 5545.5823s
	iters: 800, epoch: 1 | loss: 0.3364876
	speed: 0.2662s/iter; left time: 5414.0961s
	iters: 900, epoch: 1 | loss: 0.2605036
	speed: 0.2538s/iter; left time: 5137.9296s
	iters: 1000, epoch: 1 | loss: 0.2922163
	speed: 0.2082s/iter; left time: 4193.1394s
Epoch: 1 cost time: 236.47535729408264
Epoch: 1, Steps: 1057 | Train Loss: 0.4489751 Vali Loss: 0.4647939 Test Loss: 0.3412660
Validation loss decreased (inf --> 0.464794).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2944397
	speed: 0.2614s/iter; left time: 5223.5002s
	iters: 200, epoch: 2 | loss: 0.2904712
	speed: 0.2719s/iter; left time: 5406.0845s
	iters: 300, epoch: 2 | loss: 0.2459856
	speed: 0.2153s/iter; left time: 4260.0338s
	iters: 400, epoch: 2 | loss: 0.2683006
	speed: 0.2058s/iter; left time: 4050.1375s
	iters: 500, epoch: 2 | loss: 0.2411196
	speed: 0.2089s/iter; left time: 4090.1854s
	iters: 600, epoch: 2 | loss: 0.2383875
	speed: 0.1878s/iter; left time: 3658.5148s
	iters: 700, epoch: 2 | loss: 0.2341083
	speed: 0.2204s/iter; left time: 4272.9359s
	iters: 800, epoch: 2 | loss: 0.2876548
	speed: 0.2277s/iter; left time: 4390.6931s
	iters: 900, epoch: 2 | loss: 0.2761985
	speed: 0.2270s/iter; left time: 4354.8520s
	iters: 1000, epoch: 2 | loss: 0.2553386
	speed: 0.2265s/iter; left time: 4322.6267s
Epoch: 2 cost time: 238.1871681213379
Epoch: 2, Steps: 1057 | Train Loss: 0.2807541 Vali Loss: 0.4448165 Test Loss: 0.3311527
Validation loss decreased (0.464794 --> 0.444817).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.2747351
	speed: 0.2676s/iter; left time: 5064.9453s
	iters: 200, epoch: 3 | loss: 0.2494851
	speed: 0.2214s/iter; left time: 4167.6859s
	iters: 300, epoch: 3 | loss: 0.2526412
	speed: 0.2265s/iter; left time: 4241.2244s
	iters: 400, epoch: 3 | loss: 0.2101855
	speed: 0.2010s/iter; left time: 3744.5329s
	iters: 500, epoch: 3 | loss: 0.2059194
	speed: 0.1840s/iter; left time: 3408.6855s
	iters: 600, epoch: 3 | loss: 0.2110286
	speed: 0.1767s/iter; left time: 3255.8070s
	iters: 700, epoch: 3 | loss: 0.2511711
	speed: 0.1807s/iter; left time: 3312.5190s
	iters: 800, epoch: 3 | loss: 0.2237772
	speed: 0.1963s/iter; left time: 3578.7241s
	iters: 900, epoch: 3 | loss: 0.2261547
	speed: 0.2770s/iter; left time: 5021.8498s
	iters: 1000, epoch: 3 | loss: 0.2348992
	speed: 0.2688s/iter; left time: 4845.3930s
Epoch: 3 cost time: 235.6063621044159
Epoch: 3, Steps: 1057 | Train Loss: 0.2379462 Vali Loss: 0.4855754 Test Loss: 0.3551837
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.2310355
	speed: 0.2146s/iter; left time: 3835.6165s
	iters: 200, epoch: 4 | loss: 0.2405590
	speed: 0.2199s/iter; left time: 3907.9322s
	iters: 300, epoch: 4 | loss: 0.2490403
	speed: 0.2300s/iter; left time: 4063.8014s
	iters: 400, epoch: 4 | loss: 0.1905952
	speed: 0.2222s/iter; left time: 3903.6688s
	iters: 500, epoch: 4 | loss: 0.2725465
	speed: 0.2709s/iter; left time: 4733.1432s
	iters: 600, epoch: 4 | loss: 0.1928259
	speed: 0.2430s/iter; left time: 4220.5752s
	iters: 700, epoch: 4 | loss: 0.2057741
	speed: 0.2020s/iter; left time: 3488.2206s
	iters: 800, epoch: 4 | loss: 0.2257729
	speed: 0.2106s/iter; left time: 3616.0704s
	iters: 900, epoch: 4 | loss: 0.2043567
	speed: 0.2141s/iter; left time: 3655.3320s
	iters: 1000, epoch: 4 | loss: 0.2031136
	speed: 0.2515s/iter; left time: 4268.6211s
Epoch: 4 cost time: 241.14601278305054
Epoch: 4, Steps: 1057 | Train Loss: 0.2267386 Vali Loss: 0.5011502 Test Loss: 0.3530204
EarlyStopping counter: 2 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2096641
	speed: 0.1957s/iter; left time: 3289.5732s
	iters: 200, epoch: 5 | loss: 0.1791403
	speed: 0.2089s/iter; left time: 3491.7442s
	iters: 300, epoch: 5 | loss: 0.1858635
	speed: 0.2385s/iter; left time: 3961.9531s
	iters: 400, epoch: 5 | loss: 0.2005365
	speed: 0.2680s/iter; left time: 4424.8343s
	iters: 500, epoch: 5 | loss: 0.2070107
	speed: 0.2646s/iter; left time: 4343.5970s
	iters: 600, epoch: 5 | loss: 0.2014332
	speed: 0.2603s/iter; left time: 4245.7906s
	iters: 700, epoch: 5 | loss: 0.1951341
	speed: 0.2198s/iter; left time: 3563.3587s
	iters: 800, epoch: 5 | loss: 0.2106642
	speed: 0.2125s/iter; left time: 3424.7666s
	iters: 900, epoch: 5 | loss: 0.2130282
	speed: 0.1793s/iter; left time: 2871.6527s
	iters: 1000, epoch: 5 | loss: 0.1964618
	speed: 0.1777s/iter; left time: 2827.2945s
Epoch: 5 cost time: 232.6096956729889
Epoch: 5, Steps: 1057 | Train Loss: 0.2070520 Vali Loss: 0.6016866 Test Loss: 0.3992293
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Crossformer_ETTm1_il672_ol96_sl12,16,24,48,96_dm256_nh4_el3_itr4<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3315889835357666, mae:0.38854339718818665
