Args in experiment:
Namespace(model='patchtst', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=480, seg_lens='64', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.2, baseline='True', fc_dropout=0.05, head_dropout=0.0, patch_len=12, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=3, learning_rate=1e-05, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : patchtst_m1999m_il360_ol480_sl64_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7224
val 674
test 1825
	iters: 100, epoch: 1 | loss: 0.8135882
	speed: 0.1372s/iter; left time: 3087.2521s
	iters: 200, epoch: 1 | loss: 0.9016883
	speed: 0.0915s/iter; left time: 2049.7427s
Epoch: 1 cost time: 25.856171131134033
Epoch: 1, Steps: 226 | Train Loss: 0.8192637 Vali Loss: 0.4011341 Test Loss: 0.6311517
Validation loss decreased (inf --> 0.401134).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5936434
	speed: 0.1679s/iter; left time: 3740.5675s
	iters: 200, epoch: 2 | loss: 0.7199643
	speed: 0.1001s/iter; left time: 2219.6218s
Epoch: 2 cost time: 29.29780149459839
Epoch: 2, Steps: 226 | Train Loss: 0.7352499 Vali Loss: 0.3831549 Test Loss: 0.6160219
Validation loss decreased (0.401134 --> 0.383155).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.7647639
	speed: 0.0940s/iter; left time: 2073.4012s
	iters: 200, epoch: 3 | loss: 0.7051990
	speed: 0.0642s/iter; left time: 1409.3554s
Epoch: 3 cost time: 17.308824062347412
Epoch: 3, Steps: 226 | Train Loss: 0.7188093 Vali Loss: 0.3837415 Test Loss: 0.6111816
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.7779268
	speed: 0.0996s/iter; left time: 2174.2650s
	iters: 200, epoch: 4 | loss: 0.7793552
	speed: 0.0993s/iter; left time: 2156.2135s
Epoch: 4 cost time: 22.278381824493408
Epoch: 4, Steps: 226 | Train Loss: 0.7130842 Vali Loss: 0.3815023 Test Loss: 0.6092895
Validation loss decreased (0.383155 --> 0.381502).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.6508172
	speed: 0.1070s/iter; left time: 2311.6747s
	iters: 200, epoch: 5 | loss: 0.5841957
	speed: 0.1377s/iter; left time: 2960.0275s
Epoch: 5 cost time: 28.109718322753906
Epoch: 5, Steps: 226 | Train Loss: 0.7074990 Vali Loss: 0.3825812 Test Loss: 0.6058213
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.6002644
	speed: 0.1103s/iter; left time: 2356.9470s
	iters: 200, epoch: 6 | loss: 0.6424691
	speed: 0.0935s/iter; left time: 1989.8827s
Epoch: 6 cost time: 22.813660860061646
Epoch: 6, Steps: 226 | Train Loss: 0.7050585 Vali Loss: 0.3776339 Test Loss: 0.6033660
Validation loss decreased (0.381502 --> 0.377634).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.5847818
	speed: 0.0932s/iter; left time: 1971.4986s
	iters: 200, epoch: 7 | loss: 0.6094505
	speed: 0.0881s/iter; left time: 1855.0714s
Epoch: 7 cost time: 20.194276809692383
Epoch: 7, Steps: 226 | Train Loss: 0.7025309 Vali Loss: 0.3784068 Test Loss: 0.6023255
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.7210616
	speed: 0.1637s/iter; left time: 3423.9676s
	iters: 200, epoch: 8 | loss: 0.6198848
	speed: 0.1757s/iter; left time: 3657.0916s
Epoch: 8 cost time: 38.286569118499756
Epoch: 8, Steps: 226 | Train Loss: 0.7009025 Vali Loss: 0.3832405 Test Loss: 0.6007377
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.6214911
	speed: 0.0994s/iter; left time: 2057.6078s
	iters: 200, epoch: 9 | loss: 0.6374934
	speed: 0.1027s/iter; left time: 2115.3692s
Epoch: 9 cost time: 22.518566131591797
Epoch: 9, Steps: 226 | Train Loss: 0.6991694 Vali Loss: 0.3857324 Test Loss: 0.5999344
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : patchtst_m1999m_il360_ol480_sl64_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1825
mse:0.6025367975234985, mae:0.49444466829299927
