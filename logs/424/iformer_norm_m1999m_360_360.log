Args in experiment:
Namespace(model='iformer', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=360, seg_lens='12,8,6,4,3', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.4, baseline=False, fc_dropout=0.05, head_dropout=0.0, patch_len=12, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=3, learning_rate=1e-05, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : iformer_m1999m_il360_ol360_sl12,8,6,4,3_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7344
val 794
test 1945
	iters: 100, epoch: 1 | loss: 0.7354571
	speed: 0.7421s/iter; left time: 16994.0867s
	iters: 200, epoch: 1 | loss: 0.7888371
	speed: 0.7335s/iter; left time: 16724.9031s
Epoch: 1 cost time: 173.93120861053467
Epoch: 1, Steps: 230 | Train Loss: 0.7062155 Vali Loss: 0.3675926 Test Loss: 0.5450343
Validation loss decreased (inf --> 0.367593).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9534710
	speed: 0.7007s/iter; left time: 15884.9447s
	iters: 200, epoch: 2 | loss: 0.7294953
	speed: 0.7403s/iter; left time: 16708.5645s
Epoch: 2 cost time: 167.23964023590088
Epoch: 2, Steps: 230 | Train Loss: 0.6818335 Vali Loss: 0.3620067 Test Loss: 0.5389989
Validation loss decreased (0.367593 --> 0.362007).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.7369704
	speed: 0.7597s/iter; left time: 17048.4149s
	iters: 200, epoch: 3 | loss: 0.6512385
	speed: 0.7381s/iter; left time: 16489.5887s
Epoch: 3 cost time: 169.83895444869995
Epoch: 3, Steps: 230 | Train Loss: 0.6616439 Vali Loss: 0.3703854 Test Loss: 0.5301555
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 4 | loss: 0.6775310
	speed: 0.7010s/iter; left time: 15569.9342s
	iters: 200, epoch: 4 | loss: 0.6363373
	speed: 0.7524s/iter; left time: 16635.9598s
Epoch: 4 cost time: 168.62705612182617
Epoch: 4, Steps: 230 | Train Loss: 0.6577907 Vali Loss: 0.3579715 Test Loss: 0.5299319
Validation loss decreased (0.362007 --> 0.357972).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.6471047
	speed: 0.7574s/iter; left time: 16649.2159s
	iters: 200, epoch: 5 | loss: 0.6350206
	speed: 0.7424s/iter; left time: 16244.9798s
Epoch: 5 cost time: 174.04252886772156
Epoch: 5, Steps: 230 | Train Loss: 0.6505984 Vali Loss: 0.3595392 Test Loss: 0.5229840
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 6 | loss: 0.6360026
	speed: 0.7786s/iter; left time: 16935.4050s
	iters: 200, epoch: 6 | loss: 0.5852388
	speed: 0.7697s/iter; left time: 16665.4997s
Epoch: 6 cost time: 178.48410177230835
Epoch: 6, Steps: 230 | Train Loss: 0.6480517 Vali Loss: 0.3600729 Test Loss: 0.5232192
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.7231460
	speed: 0.7482s/iter; left time: 16102.9997s
	iters: 200, epoch: 7 | loss: 0.7192405
	speed: 0.7430s/iter; left time: 15916.2674s
Epoch: 7 cost time: 172.4210979938507
Epoch: 7, Steps: 230 | Train Loss: 0.6443449 Vali Loss: 0.3573155 Test Loss: 0.5207373
Validation loss decreased (0.357972 --> 0.357315).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4576195
	speed: 0.7489s/iter; left time: 15944.6269s
	iters: 200, epoch: 8 | loss: 0.7149947
	speed: 0.7570s/iter; left time: 16041.4268s
Epoch: 8 cost time: 173.3637502193451
Epoch: 8, Steps: 230 | Train Loss: 0.6431549 Vali Loss: 0.3551574 Test Loss: 0.5189337
Validation loss decreased (0.357315 --> 0.355157).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.6185349
	speed: 0.7316s/iter; left time: 15407.8925s
	iters: 200, epoch: 9 | loss: 0.7084574
	speed: 0.7606s/iter; left time: 15942.5546s
Epoch: 9 cost time: 172.1562614440918
Epoch: 9, Steps: 230 | Train Loss: 0.6414811 Vali Loss: 0.3529143 Test Loss: 0.5196025
Validation loss decreased (0.355157 --> 0.352914).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.6412908
	speed: 0.7498s/iter; left time: 15618.8876s
	iters: 200, epoch: 10 | loss: 0.5398456
	speed: 0.8027s/iter; left time: 16641.5971s
Epoch: 10 cost time: 180.69458079338074
Epoch: 10, Steps: 230 | Train Loss: 0.6409182 Vali Loss: 0.3559540 Test Loss: 0.5191860
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.6291178
	speed: 0.7940s/iter; left time: 16357.9732s
	iters: 200, epoch: 11 | loss: 0.5831228
	speed: 0.7671s/iter; left time: 15725.3614s
Epoch: 11 cost time: 182.65672373771667
Epoch: 11, Steps: 230 | Train Loss: 0.6398190 Vali Loss: 0.3572829 Test Loss: 0.5184126
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 12 | loss: 0.7145534
	speed: 0.8148s/iter; left time: 16597.8636s
	iters: 200, epoch: 12 | loss: 0.5337282
	speed: 0.8414s/iter; left time: 17055.6011s
Epoch: 12 cost time: 187.56137347221375
Epoch: 12, Steps: 230 | Train Loss: 0.6397563 Vali Loss: 0.3526973 Test Loss: 0.5187247
Validation loss decreased (0.352914 --> 0.352697).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.5935265
	speed: 0.8860s/iter; left time: 17845.2021s
	iters: 200, epoch: 13 | loss: 0.5073074
	speed: 0.8565s/iter; left time: 17165.5532s
Epoch: 13 cost time: 200.2689094543457
Epoch: 13, Steps: 230 | Train Loss: 0.6392862 Vali Loss: 0.3532842 Test Loss: 0.5184843
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 14 | loss: 0.5803593
	speed: 0.8292s/iter; left time: 16509.9824s
	iters: 200, epoch: 14 | loss: 0.5693128
	speed: 0.8519s/iter; left time: 16876.6610s
Epoch: 14 cost time: 194.6416528224945
Epoch: 14, Steps: 230 | Train Loss: 0.6394498 Vali Loss: 0.3542870 Test Loss: 0.5182489
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 15 | loss: 0.5539706
	speed: 0.8779s/iter; left time: 17277.7754s
	iters: 200, epoch: 15 | loss: 0.4805906
	speed: 0.8639s/iter; left time: 16916.9110s
Epoch: 15 cost time: 198.99893999099731
Epoch: 15, Steps: 230 | Train Loss: 0.6385632 Vali Loss: 0.3565561 Test Loss: 0.5184484
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : iformer_m1999m_il360_ol360_sl12,8,6,4,3_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1945
mse:0.5184128284454346, mae:0.40082815289497375
