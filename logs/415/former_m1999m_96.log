Args in experiment:
Namespace(model='former', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=672, out_len=96, seg_lens='12,24,36,48', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : former_m1999m_il672_ol96_sl12,24,36,48_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7296
val 1058
test 2209
	iters: 100, epoch: 1 | loss: 1.2365975
	speed: 0.2714s/iter; left time: 1210.6854s
	iters: 200, epoch: 1 | loss: 0.8329111
	speed: 0.2522s/iter; left time: 1100.0182s
Epoch: 1 cost time: 59.727497816085815
Epoch: 1, Steps: 228 | Train Loss: 2.0790546 Vali Loss: 0.5294038 Test Loss: 1.5682590
Validation loss decreased (inf --> 0.529404).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8051158
	speed: 0.2974s/iter; left time: 1258.8839s
	iters: 200, epoch: 2 | loss: 0.7658819
	speed: 0.2635s/iter; left time: 1088.8875s
Epoch: 2 cost time: 63.59071683883667
Epoch: 2, Steps: 228 | Train Loss: 0.8249082 Vali Loss: 0.4589489 Test Loss: 1.1698785
Validation loss decreased (0.529404 --> 0.458949).  Saving model ...
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.8276062
	speed: 0.3300s/iter; left time: 1321.6443s
	iters: 200, epoch: 3 | loss: 0.6931513
	speed: 0.2658s/iter; left time: 1037.8598s
Epoch: 3 cost time: 66.58070063591003
Epoch: 3, Steps: 228 | Train Loss: 0.6881814 Vali Loss: 0.3791309 Test Loss: 1.1180576
Validation loss decreased (0.458949 --> 0.379131).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6929248
	speed: 0.3086s/iter; left time: 1165.7046s
	iters: 200, epoch: 4 | loss: 0.6799952
	speed: 0.2662s/iter; left time: 978.7361s
Epoch: 4 cost time: 64.13089728355408
Epoch: 4, Steps: 228 | Train Loss: 0.6547345 Vali Loss: 0.3887095 Test Loss: 1.1312734
EarlyStopping counter: 1 out of 3
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.4881674
	speed: 0.2888s/iter; left time: 1024.8363s
	iters: 200, epoch: 5 | loss: 0.4852270
	speed: 0.2676s/iter; left time: 922.9803s
Epoch: 5 cost time: 62.43095660209656
Epoch: 5, Steps: 228 | Train Loss: 0.6045111 Vali Loss: 0.3920748 Test Loss: 1.1044219
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 6 | loss: 0.6238826
	speed: 0.2479s/iter; left time: 823.2150s
	iters: 200, epoch: 6 | loss: 0.5750788
	speed: 0.2808s/iter; left time: 904.4127s
Epoch: 6 cost time: 60.02184581756592
Epoch: 6, Steps: 228 | Train Loss: 0.5918836 Vali Loss: 0.3855929 Test Loss: 1.0640609
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : former_m1999m_il672_ol96_sl12,24,36,48_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2209
mse:1.0840476751327515, mae:0.8500267267227173
