Args in experiment:
Namespace(model='lstm', data='m_1999', root_path='./datasets/', data_path='m_1999.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=300, out_len=360, seg_lens='30', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.2, baseline=False, num_workers=0, batch_size=32, train_epochs=20, patience=3, learning_rate=0.001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1,2,3')
Use GPU: cuda:1
>>>>>>>start training : lstm_m_1999_il300_ol360_sl30_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 41140
val 5613
test 11583
	iters: 100, epoch: 1 | loss: 0.6751482
	speed: 0.1443s/iter; left time: 3696.1239s
	iters: 200, epoch: 1 | loss: 0.5850146
	speed: 0.1290s/iter; left time: 3292.8862s
	iters: 300, epoch: 1 | loss: 0.5605285
	speed: 0.1387s/iter; left time: 3524.8523s
	iters: 400, epoch: 1 | loss: 0.6476194
	speed: 0.1342s/iter; left time: 3396.8405s
	iters: 500, epoch: 1 | loss: 0.4951139
	speed: 0.1287s/iter; left time: 3245.8718s
	iters: 600, epoch: 1 | loss: 0.5015850
	speed: 0.1289s/iter; left time: 3238.5859s
	iters: 700, epoch: 1 | loss: 0.4623442
	speed: 0.1314s/iter; left time: 3288.8853s
	iters: 800, epoch: 1 | loss: 0.4430347
	speed: 0.1329s/iter; left time: 3312.1078s
	iters: 900, epoch: 1 | loss: 0.4453059
	speed: 0.1461s/iter; left time: 3626.6417s
	iters: 1000, epoch: 1 | loss: 0.4509166
	speed: 0.1450s/iter; left time: 3584.8809s
	iters: 1100, epoch: 1 | loss: 0.3698144
	speed: 0.1287s/iter; left time: 3168.9112s
	iters: 1200, epoch: 1 | loss: 0.4594411
	speed: 0.1374s/iter; left time: 3368.5643s
Epoch: 1 cost time: 174.48053669929504
Epoch: 1, Steps: 1286 | Train Loss: 0.5193946 Vali Loss: 0.4196002 Test Loss: 0.4130603
Validation loss decreased (inf --> 0.419600).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3899848
	speed: 0.1363s/iter; left time: 3315.8694s
	iters: 200, epoch: 2 | loss: 0.4969245
	speed: 0.1341s/iter; left time: 3250.5664s
	iters: 300, epoch: 2 | loss: 0.4632156
	speed: 0.1399s/iter; left time: 3376.4088s
	iters: 400, epoch: 2 | loss: 0.3733954
	speed: 0.1396s/iter; left time: 3355.8747s
	iters: 500, epoch: 2 | loss: 0.3216867
	speed: 0.1191s/iter; left time: 2851.5861s
	iters: 600, epoch: 2 | loss: 0.3169213
	speed: 0.1545s/iter; left time: 3683.6234s
	iters: 700, epoch: 2 | loss: 0.4276778
	speed: 0.1457s/iter; left time: 3459.0438s
	iters: 800, epoch: 2 | loss: 0.3780972
	speed: 0.1495s/iter; left time: 3533.9034s
	iters: 900, epoch: 2 | loss: 0.3691152
	speed: 0.1510s/iter; left time: 3553.2895s
	iters: 1000, epoch: 2 | loss: 0.4929541
	speed: 0.1444s/iter; left time: 3384.0004s
	iters: 1100, epoch: 2 | loss: 0.3144814
	speed: 0.1466s/iter; left time: 3420.2489s
	iters: 1200, epoch: 2 | loss: 0.3327256
	speed: 0.1358s/iter; left time: 3155.5159s
Epoch: 2 cost time: 180.71174216270447
Epoch: 2, Steps: 1286 | Train Loss: 0.3814096 Vali Loss: 0.5078391 Test Loss: 0.5034033
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.3677959
	speed: 0.1410s/iter; left time: 3250.3764s
	iters: 200, epoch: 3 | loss: 0.3678565
	speed: 0.1465s/iter; left time: 3361.4559s
	iters: 300, epoch: 3 | loss: 0.4285217
	speed: 0.1545s/iter; left time: 3529.4556s
	iters: 400, epoch: 3 | loss: 0.3962467
	speed: 0.1277s/iter; left time: 2905.6069s
	iters: 500, epoch: 3 | loss: 0.3456188
	speed: 0.1574s/iter; left time: 3564.3188s
	iters: 600, epoch: 3 | loss: 0.3328857
	speed: 0.1445s/iter; left time: 3258.3879s
	iters: 700, epoch: 3 | loss: 0.3334670
	speed: 0.1582s/iter; left time: 3551.9650s
	iters: 800, epoch: 3 | loss: 0.3111970
	speed: 0.1471s/iter; left time: 3287.4066s
	iters: 900, epoch: 3 | loss: 0.3671292
	speed: 0.1559s/iter; left time: 3468.8982s
	iters: 1000, epoch: 3 | loss: 0.3561291
	speed: 0.1518s/iter; left time: 3363.2844s
	iters: 1100, epoch: 3 | loss: 0.3529595
	speed: 0.1483s/iter; left time: 3270.8354s
	iters: 1200, epoch: 3 | loss: 0.3430033
	speed: 0.1452s/iter; left time: 3187.7946s
Epoch: 3 cost time: 192.0554699897766
Epoch: 3, Steps: 1286 | Train Loss: 0.3630130 Vali Loss: 0.3315243 Test Loss: 0.3416992
Validation loss decreased (0.419600 --> 0.331524).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3480050
	speed: 0.1436s/iter; left time: 3124.9421s
	iters: 200, epoch: 4 | loss: 0.3174187
	speed: 0.1344s/iter; left time: 2912.4241s
	iters: 300, epoch: 4 | loss: 0.2804874
	speed: 0.1455s/iter; left time: 3138.0148s
	iters: 400, epoch: 4 | loss: 0.3239623
	speed: 0.1398s/iter; left time: 3001.0432s
	iters: 500, epoch: 4 | loss: 0.3210441
	speed: 0.1337s/iter; left time: 2856.9672s
	iters: 600, epoch: 4 | loss: 0.3042730
	speed: 0.1403s/iter; left time: 2983.6859s
	iters: 700, epoch: 4 | loss: 0.3997788
	speed: 0.1369s/iter; left time: 2896.7465s
	iters: 800, epoch: 4 | loss: 0.3339238
	speed: 0.1575s/iter; left time: 3317.0985s
	iters: 900, epoch: 4 | loss: 0.3673786
	speed: 0.1415s/iter; left time: 2967.2658s
	iters: 1000, epoch: 4 | loss: 0.3061212
	speed: 0.1631s/iter; left time: 3403.0039s
	iters: 1100, epoch: 4 | loss: 0.3514310
	speed: 0.1497s/iter; left time: 3107.3806s
	iters: 1200, epoch: 4 | loss: 0.2948222
	speed: 0.1478s/iter; left time: 3053.4987s
Epoch: 4 cost time: 186.32460069656372
Epoch: 4, Steps: 1286 | Train Loss: 0.3293934 Vali Loss: 0.3507955 Test Loss: 0.3601526
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 5 | loss: 0.2941213
	speed: 0.1487s/iter; left time: 3045.5369s
	iters: 200, epoch: 5 | loss: 0.3722642
	speed: 0.1573s/iter; left time: 3204.6250s
	iters: 300, epoch: 5 | loss: 0.2699051
	speed: 0.1222s/iter; left time: 2477.2392s
	iters: 400, epoch: 5 | loss: 0.3376090
	speed: 0.1510s/iter; left time: 3047.0644s
	iters: 500, epoch: 5 | loss: 0.3006767
	speed: 0.1327s/iter; left time: 2664.4824s
	iters: 600, epoch: 5 | loss: 0.3248664
	speed: 0.1193s/iter; left time: 2383.7258s
	iters: 700, epoch: 5 | loss: 0.2733296
	speed: 0.1492s/iter; left time: 2965.5079s
	iters: 800, epoch: 5 | loss: 0.2931902
	speed: 0.1095s/iter; left time: 2165.5327s
	iters: 900, epoch: 5 | loss: 0.3065424
	speed: 0.1378s/iter; left time: 2712.2305s
	iters: 1000, epoch: 5 | loss: 0.2915873
	speed: 0.1441s/iter; left time: 2821.1534s
	iters: 1100, epoch: 5 | loss: 0.2832184
	speed: 0.1284s/iter; left time: 2500.3469s
	iters: 1200, epoch: 5 | loss: 0.2666517
	speed: 0.1495s/iter; left time: 2897.2965s
Epoch: 5 cost time: 177.28119087219238
Epoch: 5, Steps: 1286 | Train Loss: 0.3130824 Vali Loss: 0.3113322 Test Loss: 0.3239736
Validation loss decreased (0.331524 --> 0.311332).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.3060983
	speed: 0.1428s/iter; left time: 2741.2695s
	iters: 200, epoch: 6 | loss: 0.2697166
	speed: 0.1521s/iter; left time: 2903.1077s
	iters: 300, epoch: 6 | loss: 0.2797426
	speed: 0.1291s/iter; left time: 2451.3188s
	iters: 400, epoch: 6 | loss: 0.3450379
	speed: 0.1443s/iter; left time: 2725.0468s
	iters: 500, epoch: 6 | loss: 0.2992603
	speed: 0.1428s/iter; left time: 2682.4189s
	iters: 600, epoch: 6 | loss: 0.3360612
	speed: 0.1387s/iter; left time: 2591.6789s
	iters: 700, epoch: 6 | loss: 0.3378006
	speed: 0.1251s/iter; left time: 2325.2633s
	iters: 800, epoch: 6 | loss: 0.2974085
	speed: 0.1338s/iter; left time: 2473.4340s
	iters: 900, epoch: 6 | loss: 0.3313760
	speed: 0.1405s/iter; left time: 2584.3826s
	iters: 1000, epoch: 6 | loss: 0.3411928
	speed: 0.1275s/iter; left time: 2331.7934s
	iters: 1100, epoch: 6 | loss: 0.3129101
	speed: 0.1260s/iter; left time: 2291.3153s
	iters: 1200, epoch: 6 | loss: 0.2798078
	speed: 0.1399s/iter; left time: 2530.3720s
Epoch: 6 cost time: 174.55168437957764
Epoch: 6, Steps: 1286 | Train Loss: 0.3042598 Vali Loss: 0.3082787 Test Loss: 0.3244390
Validation loss decreased (0.311332 --> 0.308279).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 7 | loss: 0.2577494
	speed: 0.1539s/iter; left time: 2756.0576s
	iters: 200, epoch: 7 | loss: 0.3055127
	speed: 0.1460s/iter; left time: 2600.3368s
	iters: 300, epoch: 7 | loss: 0.2820683
	speed: 0.1400s/iter; left time: 2478.8869s
	iters: 400, epoch: 7 | loss: 0.3101979
	speed: 0.1639s/iter; left time: 2885.5330s
	iters: 500, epoch: 7 | loss: 0.3221356
	speed: 0.1199s/iter; left time: 2098.8485s
	iters: 600, epoch: 7 | loss: 0.2605544
	speed: 0.1497s/iter; left time: 2605.1358s
	iters: 700, epoch: 7 | loss: 0.3096811
	speed: 0.1179s/iter; left time: 2039.6832s
	iters: 800, epoch: 7 | loss: 0.3165676
	speed: 0.1507s/iter; left time: 2593.5401s
	iters: 900, epoch: 7 | loss: 0.2878495
	speed: 0.1359s/iter; left time: 2324.0058s
	iters: 1000, epoch: 7 | loss: 0.3338802
	speed: 0.1258s/iter; left time: 2139.0054s
	iters: 1100, epoch: 7 | loss: 0.2955813
	speed: 0.1288s/iter; left time: 2177.6487s
	iters: 1200, epoch: 7 | loss: 0.2888740
	speed: 0.1299s/iter; left time: 2183.7993s
Epoch: 7 cost time: 176.3258240222931
Epoch: 7, Steps: 1286 | Train Loss: 0.2958404 Vali Loss: 0.3170545 Test Loss: 0.3280592
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 8 | loss: 0.3666210
	speed: 0.1278s/iter; left time: 2124.3098s
	iters: 200, epoch: 8 | loss: 0.3079499
	speed: 0.1302s/iter; left time: 2150.8871s
	iters: 300, epoch: 8 | loss: 0.2848647
	speed: 0.1286s/iter; left time: 2111.3702s
	iters: 400, epoch: 8 | loss: 0.3510784
	speed: 0.1407s/iter; left time: 2295.7094s
	iters: 500, epoch: 8 | loss: 0.3125288
	speed: 0.1417s/iter; left time: 2297.5635s
	iters: 600, epoch: 8 | loss: 0.3141370
	speed: 0.1339s/iter; left time: 2158.3551s
	iters: 700, epoch: 8 | loss: 0.3463783
	speed: 0.1198s/iter; left time: 1919.3856s
	iters: 800, epoch: 8 | loss: 0.2335251
	speed: 0.1311s/iter; left time: 2086.6719s
	iters: 900, epoch: 8 | loss: 0.2860763
	speed: 0.1244s/iter; left time: 1967.8103s
	iters: 1000, epoch: 8 | loss: 0.2778886
	speed: 0.1444s/iter; left time: 2269.3772s
	iters: 1100, epoch: 8 | loss: 0.2350180
	speed: 0.1304s/iter; left time: 2036.3343s
	iters: 1200, epoch: 8 | loss: 0.3050549
	speed: 0.1242s/iter; left time: 1926.9031s
Epoch: 8 cost time: 169.83826851844788
Epoch: 8, Steps: 1286 | Train Loss: 0.2921467 Vali Loss: 0.3126464 Test Loss: 0.3277063
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 9 | loss: 0.2971914
	speed: 0.1525s/iter; left time: 2338.1991s
	iters: 200, epoch: 9 | loss: 0.2638895
	speed: 0.1648s/iter; left time: 2510.5302s
	iters: 300, epoch: 9 | loss: 0.2949361
	speed: 0.1451s/iter; left time: 2196.0248s
	iters: 400, epoch: 9 | loss: 0.2983519
	speed: 0.1419s/iter; left time: 2133.5026s
	iters: 500, epoch: 9 | loss: 0.2778103
	speed: 0.1680s/iter; left time: 2508.0076s
	iters: 600, epoch: 9 | loss: 0.3264134
	speed: 0.1438s/iter; left time: 2133.5827s
	iters: 700, epoch: 9 | loss: 0.2896362
	speed: 0.1478s/iter; left time: 2177.6892s
	iters: 800, epoch: 9 | loss: 0.3250865
	speed: 0.1551s/iter; left time: 2270.2927s
	iters: 900, epoch: 9 | loss: 0.2708428
	speed: 0.1463s/iter; left time: 2126.6663s
	iters: 1000, epoch: 9 | loss: 0.3114901
	speed: 0.1468s/iter; left time: 2118.5267s
	iters: 1100, epoch: 9 | loss: 0.3094696
	speed: 0.1555s/iter; left time: 2228.0692s
	iters: 1200, epoch: 9 | loss: 0.2585852
	speed: 0.1476s/iter; left time: 2100.8185s
Epoch: 9 cost time: 193.38014125823975
Epoch: 9, Steps: 1286 | Train Loss: 0.2862634 Vali Loss: 0.3165942 Test Loss: 0.3323089
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : lstm_m_1999_il300_ol360_sl30_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11583
mse:0.3245176374912262, mae:0.3025704026222229
