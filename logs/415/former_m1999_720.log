Args in experiment:
Namespace(model='former', data='m_1999', root_path='./datasets/', data_path='m_1999.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=300, out_len=720, seg_lens='30,60,90,120,180,360,720', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=3, dropout=0.2, baseline=False, num_workers=0, batch_size=128, train_epochs=20, patience=3, learning_rate=1e-05, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1,2,3')
Use GPU: cuda:0
>>>>>>>start training : former_m_1999_il300_ol720_sl30,60,90,120,180,360,720_dm256_nh4_el3_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 40780
val 5253
test 11223
	iters: 100, epoch: 1 | loss: 1.8061908
	speed: 0.1677s/iter; left time: 1053.3039s
	iters: 200, epoch: 1 | loss: 1.4018010
	speed: 0.1680s/iter; left time: 1038.5773s
	iters: 300, epoch: 1 | loss: 1.2021538
	speed: 0.1718s/iter; left time: 1044.8830s
Epoch: 1 cost time: 54.681583404541016
Epoch: 1, Steps: 319 | Train Loss: 1.7588194 Vali Loss: 1.1201527 Test Loss: 1.0393533
Validation loss decreased (inf --> 1.120153).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0223354
	speed: 0.1718s/iter; left time: 1024.0419s
	iters: 200, epoch: 2 | loss: 0.9250160
	speed: 0.1577s/iter; left time: 924.6673s
	iters: 300, epoch: 2 | loss: 0.8924034
	speed: 0.1722s/iter; left time: 992.0903s
Epoch: 2 cost time: 53.406566858291626
Epoch: 2, Steps: 319 | Train Loss: 1.0073151 Vali Loss: 0.9011030 Test Loss: 0.8249977
Validation loss decreased (1.120153 --> 0.901103).  Saving model ...
Updating learning rate to 5e-06
	iters: 100, epoch: 3 | loss: 0.9026046
	speed: 0.1659s/iter; left time: 936.0413s
	iters: 200, epoch: 3 | loss: 0.9099170
	speed: 0.1697s/iter; left time: 940.7223s
	iters: 300, epoch: 3 | loss: 0.8597191
	speed: 0.1711s/iter; left time: 931.3106s
Epoch: 3 cost time: 54.30735993385315
Epoch: 3, Steps: 319 | Train Loss: 0.9134515 Vali Loss: 0.8801771 Test Loss: 0.7856839
Validation loss decreased (0.901103 --> 0.880177).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8997536
	speed: 0.1821s/iter; left time: 969.3047s
	iters: 200, epoch: 4 | loss: 0.8625816
	speed: 0.1789s/iter; left time: 934.7482s
	iters: 300, epoch: 4 | loss: 0.8222517
	speed: 0.1641s/iter; left time: 841.0973s
Epoch: 4 cost time: 55.746178150177
Epoch: 4, Steps: 319 | Train Loss: 0.8686165 Vali Loss: 0.8081701 Test Loss: 0.7344770
Validation loss decreased (0.880177 --> 0.808170).  Saving model ...
Updating learning rate to 2.5e-06
	iters: 100, epoch: 5 | loss: 0.8431577
	speed: 0.1801s/iter; left time: 901.4501s
	iters: 200, epoch: 5 | loss: 0.8039699
	speed: 0.1619s/iter; left time: 793.9520s
	iters: 300, epoch: 5 | loss: 0.7169698
	speed: 0.1795s/iter; left time: 862.3185s
Epoch: 5 cost time: 55.30911731719971
Epoch: 5, Steps: 319 | Train Loss: 0.8026432 Vali Loss: 0.7239885 Test Loss: 0.6791774
Validation loss decreased (0.808170 --> 0.723989).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7105781
	speed: 0.1655s/iter; left time: 775.3405s
	iters: 200, epoch: 6 | loss: 0.7963837
	speed: 0.1617s/iter; left time: 741.6432s
	iters: 300, epoch: 6 | loss: 0.6869991
	speed: 0.1708s/iter; left time: 766.2504s
Epoch: 6 cost time: 52.88608694076538
Epoch: 6, Steps: 319 | Train Loss: 0.7562165 Vali Loss: 0.6869549 Test Loss: 0.6570913
Validation loss decreased (0.723989 --> 0.686955).  Saving model ...
Updating learning rate to 1.25e-06
	iters: 100, epoch: 7 | loss: 0.7487704
	speed: 0.1631s/iter; left time: 712.1022s
	iters: 200, epoch: 7 | loss: 0.7803451
	speed: 0.1704s/iter; left time: 727.0561s
	iters: 300, epoch: 7 | loss: 0.7346843
	speed: 0.1625s/iter; left time: 677.1379s
Epoch: 7 cost time: 52.60798764228821
Epoch: 7, Steps: 319 | Train Loss: 0.7385541 Vali Loss: 0.6859417 Test Loss: 0.6509996
Validation loss decreased (0.686955 --> 0.685942).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7143603
	speed: 0.1582s/iter; left time: 640.4151s
	iters: 200, epoch: 8 | loss: 0.7470720
	speed: 0.1739s/iter; left time: 686.4307s
	iters: 300, epoch: 8 | loss: 0.7366459
	speed: 0.1634s/iter; left time: 628.8585s
Epoch: 8 cost time: 52.551459074020386
Epoch: 8, Steps: 319 | Train Loss: 0.7308291 Vali Loss: 0.6773285 Test Loss: 0.6444080
Validation loss decreased (0.685942 --> 0.677328).  Saving model ...
Updating learning rate to 6.25e-07
	iters: 100, epoch: 9 | loss: 0.7759526
	speed: 0.1578s/iter; left time: 588.4813s
	iters: 200, epoch: 9 | loss: 0.7143276
	speed: 0.1611s/iter; left time: 584.5451s
	iters: 300, epoch: 9 | loss: 0.7379642
	speed: 0.1643s/iter; left time: 579.6504s
Epoch: 9 cost time: 51.757155895233154
Epoch: 9, Steps: 319 | Train Loss: 0.7252945 Vali Loss: 0.6665197 Test Loss: 0.6420785
Validation loss decreased (0.677328 --> 0.666520).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7534316
	speed: 0.1630s/iter; left time: 555.9566s
	iters: 200, epoch: 10 | loss: 0.7526850
	speed: 0.1561s/iter; left time: 516.5434s
	iters: 300, epoch: 10 | loss: 0.7184716
	speed: 0.1604s/iter; left time: 514.9252s
Epoch: 10 cost time: 50.84636855125427
Epoch: 10, Steps: 319 | Train Loss: 0.7222579 Vali Loss: 0.6684139 Test Loss: 0.6396593
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-07
	iters: 100, epoch: 11 | loss: 0.7101573
	speed: 0.1614s/iter; left time: 498.7941s
	iters: 200, epoch: 11 | loss: 0.7144906
	speed: 0.1595s/iter; left time: 476.9391s
	iters: 300, epoch: 11 | loss: 0.6862056
	speed: 0.1454s/iter; left time: 420.4586s
Epoch: 11 cost time: 50.33141493797302
Epoch: 11, Steps: 319 | Train Loss: 0.7198860 Vali Loss: 0.6646685 Test Loss: 0.6382505
Validation loss decreased (0.666520 --> 0.664669).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7050358
	speed: 0.1591s/iter; left time: 440.9364s
	iters: 200, epoch: 12 | loss: 0.7020874
	speed: 0.1694s/iter; left time: 452.6224s
	iters: 300, epoch: 12 | loss: 0.6940603
	speed: 0.1622s/iter; left time: 417.2761s
Epoch: 12 cost time: 51.81666159629822
Epoch: 12, Steps: 319 | Train Loss: 0.7182296 Vali Loss: 0.6591323 Test Loss: 0.6372364
Validation loss decreased (0.664669 --> 0.659132).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7250030
	speed: 0.1605s/iter; left time: 393.6163s
	iters: 200, epoch: 13 | loss: 0.6893216
	speed: 0.1614s/iter; left time: 379.8511s
	iters: 300, epoch: 13 | loss: 0.7177826
	speed: 0.1673s/iter; left time: 376.8885s
Epoch: 13 cost time: 52.04215145111084
Epoch: 13, Steps: 319 | Train Loss: 0.7166115 Vali Loss: 0.6652009 Test Loss: 0.6358633
EarlyStopping counter: 1 out of 3
	iters: 100, epoch: 14 | loss: 0.7722792
	speed: 0.1669s/iter; left time: 356.2497s
	iters: 200, epoch: 14 | loss: 0.7003545
	speed: 0.1553s/iter; left time: 315.8504s
	iters: 300, epoch: 14 | loss: 0.7225684
	speed: 0.1621s/iter; left time: 313.4496s
Epoch: 14 cost time: 51.59662127494812
Epoch: 14, Steps: 319 | Train Loss: 0.7151241 Vali Loss: 0.6637388 Test Loss: 0.6348179
EarlyStopping counter: 2 out of 3
	iters: 100, epoch: 15 | loss: 0.7083793
	speed: 0.1525s/iter; left time: 276.8141s
	iters: 200, epoch: 15 | loss: 0.7251713
	speed: 0.1456s/iter; left time: 249.6983s
	iters: 300, epoch: 15 | loss: 0.7289854
	speed: 0.1490s/iter; left time: 240.5802s
Epoch: 15 cost time: 47.349400997161865
Epoch: 15, Steps: 319 | Train Loss: 0.7134647 Vali Loss: 0.6607657 Test Loss: 0.6334253
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : former_m_1999_il300_ol720_sl30,60,90,120,180,360,720_dm256_nh4_el3_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11223
mse:0.6374692916870117, mae:0.49020710587501526
