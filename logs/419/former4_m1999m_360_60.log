Args in experiment:
Namespace(model='former', data='m1999m', root_path='./datasets/', data_path='m1999m.csv', data_split=[0.7, 0.1, 0.2], checkpoints='./checkpoints/', in_len=360, out_len=60, seg_lens='6,10,15,20,30,60', data_dim=5, d_model=256, d_ff=512, n_heads=4, a_layers=4, dropout=0.4, baseline=False, fc_dropout=0.05, head_dropout=0.0, patch_len=12, stride=8, padding_patch='end', revin=1, affine=0, subtract_last=0, decomposition=0, kernel_size=25, individual=0, freq='m', embed_type=0, enc_in=7, dec_in=7, c_out=7, e_layers=2, d_layers=1, moving_avg=25, factor=1, distil=True, embed='timeF', activation='gelu', output_attention=False, do_predict=False, num_workers=0, batch_size=32, train_epochs=100, patience=5, learning_rate=0.0001, lradj='type1', itr=1, save_pred=False, use_gpu=True, gpu=1, use_multi_gpu=False, devices='0,1')
Use GPU: cuda:1
>>>>>>>start training : former_m1999m_il360_ol60_sl6,10,15,20,30,60_dm256_nh4_el4_itr0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7644
val 1094
test 2245
	iters: 100, epoch: 1 | loss: 0.4572510
	speed: 0.3406s/iter; left time: 8106.9961s
	iters: 200, epoch: 1 | loss: 0.3821841
	speed: 0.2575s/iter; left time: 6102.7172s
Epoch: 1 cost time: 71.7653169631958
Epoch: 1, Steps: 239 | Train Loss: 0.4786001 Vali Loss: 0.3297581 Test Loss: 0.8096835
Validation loss decreased (inf --> 0.329758).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4466375
	speed: 0.2768s/iter; left time: 6520.9617s
	iters: 200, epoch: 2 | loss: 0.4525574
	speed: 0.2668s/iter; left time: 6259.1173s
Epoch: 2 cost time: 64.72497940063477
Epoch: 2, Steps: 239 | Train Loss: 0.4287523 Vali Loss: 0.3325667 Test Loss: 0.8258628
EarlyStopping counter: 1 out of 5
Updating learning rate to 5e-05
	iters: 100, epoch: 3 | loss: 0.4332031
	speed: 0.2594s/iter; left time: 6049.4568s
	iters: 200, epoch: 3 | loss: 0.4636557
	speed: 0.2725s/iter; left time: 6327.5386s
Epoch: 3 cost time: 63.4966938495636
Epoch: 3, Steps: 239 | Train Loss: 0.3916680 Vali Loss: 0.3065276 Test Loss: 0.8141911
Validation loss decreased (0.329758 --> 0.306528).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3485588
	speed: 0.2738s/iter; left time: 6320.4452s
	iters: 200, epoch: 4 | loss: 0.3366854
	speed: 0.2856s/iter; left time: 6564.7065s
Epoch: 4 cost time: 67.27292513847351
Epoch: 4, Steps: 239 | Train Loss: 0.3759558 Vali Loss: 0.3148849 Test Loss: 0.7144245
EarlyStopping counter: 1 out of 5
Updating learning rate to 2.5e-05
	iters: 100, epoch: 5 | loss: 0.2719369
	speed: 0.2905s/iter; left time: 6637.5066s
	iters: 200, epoch: 5 | loss: 0.4019552
	speed: 0.2598s/iter; left time: 5909.9061s
Epoch: 5 cost time: 65.61082148551941
Epoch: 5, Steps: 239 | Train Loss: 0.3531914 Vali Loss: 0.3065109 Test Loss: 0.8311382
Validation loss decreased (0.306528 --> 0.306511).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4103587
	speed: 0.2578s/iter; left time: 5827.9921s
	iters: 200, epoch: 6 | loss: 0.3318096
	speed: 0.2769s/iter; left time: 6231.3046s
Epoch: 6 cost time: 63.83496427536011
Epoch: 6, Steps: 239 | Train Loss: 0.3476728 Vali Loss: 0.3319020 Test Loss: 0.8463752
EarlyStopping counter: 1 out of 5
Updating learning rate to 1.25e-05
	iters: 100, epoch: 7 | loss: 0.3488454
	speed: 0.2869s/iter; left time: 6416.9722s
	iters: 200, epoch: 7 | loss: 0.4146652
	speed: 0.2915s/iter; left time: 6491.5216s
Epoch: 7 cost time: 68.762686252594
Epoch: 7, Steps: 239 | Train Loss: 0.3349278 Vali Loss: 0.3014347 Test Loss: 0.7770419
Validation loss decreased (0.306511 --> 0.301435).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3173280
	speed: 0.2767s/iter; left time: 6122.2793s
	iters: 200, epoch: 8 | loss: 0.3031539
	speed: 0.2840s/iter; left time: 6255.4629s
Epoch: 8 cost time: 67.2112512588501
Epoch: 8, Steps: 239 | Train Loss: 0.3316041 Vali Loss: 0.3130581 Test Loss: 0.8337651
EarlyStopping counter: 1 out of 5
Updating learning rate to 6.25e-06
	iters: 100, epoch: 9 | loss: 0.3463541
	speed: 0.2967s/iter; left time: 6494.5200s
	iters: 200, epoch: 9 | loss: 0.3584959
	speed: 0.2904s/iter; left time: 6327.7812s
Epoch: 9 cost time: 69.81991958618164
Epoch: 9, Steps: 239 | Train Loss: 0.3249867 Vali Loss: 0.3086743 Test Loss: 0.7857434
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 10 | loss: 0.2804770
	speed: 0.2857s/iter; left time: 6185.5565s
	iters: 200, epoch: 10 | loss: 0.3393798
	speed: 0.2882s/iter; left time: 6210.9993s
Epoch: 10 cost time: 67.97409844398499
Epoch: 10, Steps: 239 | Train Loss: 0.3228184 Vali Loss: 0.3174254 Test Loss: 0.8127531
EarlyStopping counter: 3 out of 5
Updating learning rate to 3.125e-06
	iters: 100, epoch: 11 | loss: 0.3047692
	speed: 0.2802s/iter; left time: 5998.5905s
	iters: 200, epoch: 11 | loss: 0.3115005
	speed: 0.2759s/iter; left time: 5880.6689s
Epoch: 11 cost time: 66.5626859664917
Epoch: 11, Steps: 239 | Train Loss: 0.3191975 Vali Loss: 0.3092646 Test Loss: 0.8098137
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 12 | loss: 0.3708773
	speed: 0.2863s/iter; left time: 6061.3887s
	iters: 200, epoch: 12 | loss: 0.3851120
	speed: 0.2753s/iter; left time: 5801.5875s
Epoch: 12 cost time: 67.38273024559021
Epoch: 12, Steps: 239 | Train Loss: 0.3188155 Vali Loss: 0.3051281 Test Loss: 0.8078745
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : former_m1999m_il360_ol60_sl6,10,15,20,30,60_dm256_nh4_el4_itr0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2245
mse:0.738814115524292, mae:0.6752635836601257
